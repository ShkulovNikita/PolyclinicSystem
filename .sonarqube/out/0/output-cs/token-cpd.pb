‡
AD:\git\PolyclinicSystem\PolyclinicSystem\Classes\Administrator.cs
	namespace 	
PolyclinicSystem
 
. 
Classes "
{ 
public 

class 
Administrator 
{ 
[ 	

PrimaryKey	 
, 
AutoIncrement "
]" #
public		 
int		 
AdminID		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
[ 	
NotNull	 
, 
	MaxLength 
( 
$num 
) 
]  
public 
string 
Phone 
{ 
get !
;! "
set# &
;& '
}( )
[ 	

ForeignKey	 
( 
typeof 
( 
User 
)  
)  !
]! "
public 
int 
UserId 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
	ManyToOne	 
] 
public 
User 
User 
{ 
get 
; 
set  #
;# $
}% &
public 
void 
Edit 
( 
string 
phone  %
)% &
{ 	
Phone 
= 
phone 
; 
} 	
} 
} ©
:D:\git\PolyclinicSystem\PolyclinicSystem\Classes\Doctor.cs
	namespace 	
PolyclinicSystem
 
. 
Classes "
{ 
public 

class 
Doctor 
{ 
[		 	

PrimaryKey			 
,		 
AutoIncrement		 "
]		" #
public

 
int

 
DoctorID

 
{

 
get

 !
;

! "
set

# &
;

& '
}

( )
[ 	

ForeignKey	 
( 
typeof 
( 
	Specialty $
)$ %
)% &
]& '
public 
int 
SpecialtyID 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	

ForeignKey	 
( 
typeof 
( 
User 
)  
)  !
]! "
public 
int 
UserID 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
	ManyToOne	 
] 
public 
User 
User 
{ 
get 
; 
set  #
;# $
}% &
[ 	
	ManyToOne	 
] 
public 
	Specialty 
	Specialty "
{# $
get% (
;( )
set* -
;- .
}/ 0
[ 	
	OneToMany	 
( 
CascadeOperations $
=% &
CascadeOperation' 7
.7 8
All8 ;
); <
]< =
public 
List 
< 
DoctorVisit 
>  
DoctorVisits! -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 	
	OneToMany	 
( 
CascadeOperations $
=% &
CascadeOperation' 7
.7 8
All8 ;
); <
]< =
public 
List 
< 
Feedback 
> 
	Feedbacks '
{( )
get* -
;- .
set/ 2
;2 3
}4 5
} 
} É
?D:\git\PolyclinicSystem\PolyclinicSystem\Classes\DoctorVisit.cs
	namespace 	
PolyclinicSystem
 
. 
Classes "
{ 
public 

class 
DoctorVisit 
{ 
[ 	

PrimaryKey	 
, 
AutoIncrement "
]" #
public		 
int		 
VisitID		 
{		 
get		  
;		  !
set		" %
;		% &
}		' (
public 
string 
Type 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 
Date 
{ 
get  
;  !
set" %
;% &
}' (
public 
string 

Complaints  
{! "
get# &
;& '
set( +
;+ ,
}- .
public 
string 
	Diagnosis 
{  !
get" %
;% &
set' *
;* +
}, -
public 
string 
	Treatment 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
NotNull	 
] 
public 
string 
Status 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	

ForeignKey	 
( 
typeof 
( 
Doctor !
)! "
)" #
]# $
public 
int 
DoctorID 
{ 
get !
;! "
set# &
;& '
}( )
[ 	

ForeignKey	 
( 
typeof 
( 
PatientCard &
)& '
)' (
]( )
public 
int 
PatientCardID  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	
	ManyToOne	 
] 
public 
Doctor 
Doctor 
{ 
get "
;" #
set$ '
;' (
}) *
[!! 	
	ManyToOne!!	 
]!! 
public"" 
PatientCard"" 
PatientCard"" &
{""' (
get"") ,
;"", -
set"". 1
;""1 2
}""3 4
public%% 
void%% 
Move%% 
(%% 
string%% 
newDate%%  '
)%%' (
{&& 	
Date'' 
='' 
newDate'' 
;'' 
Status(( 
=(( 
$str((  
;((  !
})) 	
public,, 
void,, 
Cancel,, 
(,, 
),, 
{-- 	
Status.. 
=.. 
$str.. 
;.. 
Date// 
=// 
null// 
;// 
}00 	
public33 
void33 
Complete33 
(33 
)33 
{44 	
Status55 
=55 
$str55 
;55  
}66 	
public99 
void99 
	WriteInfo99 
(99 
string99 $
type99% )
,99) *
string99+ 1

complaints992 <
,99< =
string99> D
	diagnosis99E N
,99N O
string99P V
	treatment99W `
)99` a
{:: 	
Type;; 
=;; 
type;; 
;;; 

Complaints<< 
=<< 

complaints<< #
;<<# $
	Diagnosis== 
=== 
	diagnosis== !
;==! "
	Treatment>> 
=>> 
	treatment>> !
;>>! "
}?? 	
}@@ 
}AA å
<D:\git\PolyclinicSystem\PolyclinicSystem\Classes\Feedback.cs
	namespace 	
PolyclinicSystem
 
. 
Classes "
{ 
public 

class 
Feedback 
{ 
[ 	

PrimaryKey	 
, 
AutoIncrement "
]" #
public		 
int		 
ID		 
{		 
get		 
;		 
set		  
;		  !
}		" #
[ 	
NotNull	 
] 
public 
int 
Rating 
{ 
get 
;  
set! $
;$ %
}& '
[ 	
NotNull	 
] 
public 
string 
Date 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
NotNull	 
] 
public 
string 
Text 
{ 
get  
;  !
set" %
;% &
}' (
[ 	

ForeignKey	 
( 
typeof 
( 
Patient "
)" #
)# $
]$ %
public 
int 
	PatientID 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	

ForeignKey	 
( 
typeof 
( 
Doctor !
)! "
)" #
]# $
public 
int 
DoctorID 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
	ManyToOne	 
] 
public 
Patient 
Patient 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
	ManyToOne	 
] 
public 
Doctor 
Doctor 
{ 
get "
;" #
set$ '
;' (
}) *
} 
}   “
;D:\git\PolyclinicSystem\PolyclinicSystem\Classes\Patient.cs
	namespace 	
PolyclinicSystem
 
. 
Classes "
{ 
public 

class 
Patient 
{ 
[		 	

PrimaryKey			 
,		 
AutoIncrement		 "
]		" #
public

 
int

 
	PatientID

 
{

 
get

 "
;

" #
set

$ '
;

' (
}

) *
[ 	
NotNull	 
, 
	MaxLength 
( 
$num 
) 
] 
public 
string 
Gender 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
NotNull	 
, 
	MaxLength 
( 
$num 
) 
]  
public 
string 
OMS 
{ 
get 
;  
set! $
;$ %
}& '
public 
string 
JobPlace 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
NotNull	 
] 
public 
string 
Address 
{ 
get  #
;# $
set% (
;( )
}* +
[ 	
NotNull	 
] 
public 
string 
	BirthDate 
{  !
get" %
;% &
set' *
;* +
}, -
[ 	
NotNull	 
, 
	MaxLength 
( 
$num 
) 
]  
public 
string 
Phone 
{ 
get !
;! "
set# &
;& '
}( )
[ 	

ForeignKey	 
( 
typeof 
( 
User 
)  
)  !
]! "
public 
int 
UserID 
{ 
get 
;  
set! $
;$ %
}& '
[   	
	ManyToOne  	 
]   
public!! 
User!! 
User!! 
{!! 
get!! 
;!! 
set!!  #
;!!# $
}!!% &
[## 	
	OneToMany##	 
(## 
CascadeOperations## $
=##% &
CascadeOperation##' 7
.##7 8
All##8 ;
)##; <
]##< =
public$$ 
List$$ 
<$$ 
PatientCard$$ 
>$$  
PatientCards$$! -
{$$. /
get$$0 3
;$$3 4
set$$5 8
;$$8 9
}$$: ;
[&& 	
	OneToMany&&	 
(&& 
CascadeOperations&& $
=&&% &
CascadeOperation&&' 7
.&&7 8
All&&8 ;
)&&; <
]&&< =
public'' 
List'' 
<'' 
Feedback'' 
>'' 
	Feedbacks'' '
{''( )
get''* -
;''- .
set''/ 2
;''2 3
}''4 5
public)) 
void)) 
Edit)) 
()) 
string)) 
oms))  #
,))# $
string))% +
jobplace)), 4
,))4 5
string))6 <
address))= D
,))D E
string))F L
phone))M R
)))R S
{** 	
OMS++ 
=++ 
oms++ 
;++ 
JobPlace,, 
=,, 
jobplace,, 
;,,  
Address-- 
=-- 
address-- 
;-- 
Phone.. 
=.. 
phone.. 
;.. 
}// 	
}00 
}11 •
?D:\git\PolyclinicSystem\PolyclinicSystem\Classes\PatientCard.cs
	namespace 	
PolyclinicSystem
 
. 
Classes "
{ 
public 

class 
PatientCard 
{ 
[		 	

PrimaryKey			 
,		 
AutoIncrement		 "
]		" #
public

 
int

 
CardID

 
{

 
get

 
;

  
set

! $
;

$ %
}

& '
[ 	
Unique	 
, 
NotNull 
] 
public 
string 

CardNumber  
{! "
get# &
;& '
set( +
;+ ,
}- .
[ 	

ForeignKey	 
( 
typeof 
( 
Patient "
)" #
)# $
]$ %
public 
int 
	PatientID 
{ 
get "
;" #
set$ '
;' (
}) *
[ 	
	ManyToOne	 
] 
public 
Patient 
Patient 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
	OneToMany	 
( 
CascadeOperations $
=% &
CascadeOperation' 7
.7 8
All8 ;
); <
]< =
public 
List 
< 
DoctorVisit 
>  
DoctorVisits! -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
} 
} ÷
=D:\git\PolyclinicSystem\PolyclinicSystem\Classes\Specialty.cs
	namespace 	
PolyclinicSystem
 
. 
Classes "
{ 
public 

class 
	Specialty 
{ 
[		 	

PrimaryKey			 
,		 
AutoIncrement		 "
]		" #
public

 
int

 
ID

 
{

 
get

 
;

 
set

  
;

  !
}

" #
[ 	
NotNull	 
, 
Unique 
] 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
	OneToMany	 
( 
CascadeOperations $
=% &
CascadeOperation' 7
.7 8
All8 ;
); <
]< =
public 
List 
< 
Doctor 
> 
Doctors #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} 
} Ÿ
8D:\git\PolyclinicSystem\PolyclinicSystem\Classes\User.cs
	namespace 	
PolyclinicSystem
 
. 
Classes "
{ 
public 

class 
User 
{ 
[		 	

PrimaryKey			 
,		 
AutoIncrement		 "
]		" #
public

 
int

 
ID

 
{

 
get

 
;

 
set

  
;

  !
}

" #
[ 	
Unique	 
] 
public 
string 
Login 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
NotNull	 
] 
public 
string 
Name 
{ 
get  
;  !
set" %
;% &
}' (
[ 	
NotNull	 
] 
public 
string 
Email 
{ 
get !
;! "
set# &
;& '
}( )
[ 	
NotNull	 
] 
public 
string 
Password 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 	
	OneToMany	 
( 
CascadeOperations $
=% &
CascadeOperation' 7
.7 8
All8 ;
); <
]< =
public 
List 
< 
Administrator !
>! "
Administrators# 1
{2 3
get4 7
;7 8
set9 <
;< =
}> ?
[ 	
	OneToMany	 
( 
CascadeOperations $
=% &
CascadeOperation' 7
.7 8
All8 ;
); <
]< =
public 
List 
< 
Patient 
> 
Patients %
{& '
get( +
;+ ,
set- 0
;0 1
}2 3
[ 	
	OneToMany	 
( 
CascadeOperations $
=% &
CascadeOperation' 7
.7 8
All8 ;
); <
]< =
public 
List 
< 
Doctor 
> 
Doctors #
{$ %
get& )
;) *
set+ .
;. /
}0 1
public!! 
void!! 
Edit!! 
(!! 
string!! 
name!!  $
,!!$ %
string!!& ,
email!!- 2
,!!2 3
string!!4 :
password!!; C
,!!C D
string!!E K
login!!L Q
)!!Q R
{"" 	
Name## 
=## 
name## 
;## 
Email$$ 
=$$ 
email$$ 
;$$ 
Login%% 
=%% 
login%% 
;%% 
Password&& 
=&& 
password&& 
;&&  
}'' 	
public)) 
void)) 
ChangePassword)) "
())" #
string))# )
newPassword))* 5
)))5 6
{** 	
Password++ 
=++ 
newPassword++ "
;++" #
},, 	
}-- 
}.. Û
OD:\git\PolyclinicSystem\PolyclinicSystem\Forms\FeedbackForms\AddFeedbackForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
FeedbackForms! .
{ 
public 

partial 
class 
AddFeedbackForm (
:) *
Form+ /
{ 
private		 
Doctor		 
Doctor		 
;		 
private

 
Patient

 
Patient

 
;

  
public 
AddFeedbackForm 
( 
Doctor %
doctor& ,
,, -
Patient. 5
patient6 =
)= >
{ 	
InitializeComponent 
(  
)  !
;! "
Doctor 
= 
doctor 
; 
Patient 
= 
patient 
; 
} 	
private 
void 
confirmButton_Click (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{ 	
int 
value 
= 
$num 
; 
if 
( 
radioButton1 
. 
Checked $
)$ %
value 
= 
$num 
; 
else 
if 
( 
radioButton2 !
.! "
Checked" )
)) *
value 
= 
$num 
; 
else 
if 
( 
radioButton3 !
.! "
Checked" )
)) *
value 
= 
$num 
; 
else 
if 
( 
radioButton4 !
.! "
Checked" )
)) *
value 
= 
$num 
; 
else 
if 
( 
radioButton5 !
.! "
Checked" )
)) *
value   
=   
$num   
;   
if"" 
("" 
value"" 
=="" 
$num"" 
)"" 
ErrorHandler## 
.## 
	ShowError## &
(##& '
$str##' :
)##: ;
;##; <
else$$ 
{%% 
string&& 
text&& 
=&& 
textBox&& %
.&&% &
Text&&& *
;&&* +
try'' 
{(( 
bool)) 
result)) 
=))  !
FeedbackHandler))" 1
.))1 2
AddFeedback))2 =
())= >
Doctor))> D
,))D E
Patient))F M
,))M N
value))O T
,))T U
text))V Z
)))Z [
;))[ \
if** 
(** 
result** 
)** 
{++ 
MessagesHandler,, '
.,,' (
ShowMessage,,( 3
(,,3 4
$str,,4 L
),,L M
;,,M N
Close-- 
(-- 
)-- 
;--  
}.. 
}// 
catch00 
(00 
	Exception00  
ex00! #
)00# $
{11 
Logger22 
.22 
WriteLog22 #
(22# $
ex22$ &
)22& '
;22' (
Close33 
(33 
)33 
;33 
}44 
}55 
}66 	
}77 
}88 ·
LD:\git\PolyclinicSystem\PolyclinicSystem\Forms\FeedbackForms\FeedbackForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
FeedbackForms! .
{ 
public 

partial 
class 
FeedbackForm %
:& '
Form( ,
{ 
private		 
Feedback		 
Feedback		 !
;		! "
public 
FeedbackForm 
( 
Feedback $
feedback% -
)- .
{ 	
InitializeComponent 
(  
)  !
;! "
Feedback 
= 
feedback 
;  
} 	
private 
void 
FeedbackForm_Load &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
try 
{ 
ratingLabel 
. 
Text  
=! "
$str# -
+. /
Feedback0 8
.8 9
Rating9 ?
.? @
ToString@ H
(H I
)I J
;J K
infoTextBox 
. 
Text  
=! "
Feedback# +
.+ ,
Text, 0
;0 1
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' R
)R S
;S T
Close 
( 
) 
; 
} 
} 	
} 
}   Æ4
PD:\git\PolyclinicSystem\PolyclinicSystem\Forms\FeedbackForms\FeedbackListForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
FeedbackForms! .
{ 
public 

partial 
class 
FeedbackListForm )
:* +
Form, 0
{		 
private

 
	DataTable

 
dt

 
=

 
new

 "
	DataTable

# ,
(

, -
)

- .
;

. /
private 
Doctor 
Doctor 
; 
public 
FeedbackListForm 
(  
Doctor  &
doctor' -
)- .
{ 	
InitializeComponent 
(  
)  !
;! "
Doctor 
= 
doctor 
; 
} 	
private 
void !
FeedbackListForm_Load *
(* +
object+ 1
sender2 8
,8 9
	EventArgs: C
eD E
)E F
{ 	
try 
{ 
dt 
= 
FeedbackHandler $
.$ %
GetDataTable% 1
(1 2
)2 3
;3 4
if 
( 
( 
dt 
!= 
null 
)  
&&! #
($ %
dt% '
.' (
Columns( /
./ 0
Count0 5
>6 7
$num8 9
)9 :
): ;
{ 
feedbackDataGrid $
.$ %

DataSource% /
=0 1
dt2 4
;4 5
feedbackDataGrid $
.$ %
Columns% ,
[, -
$num- .
]. /
./ 0
AutoSizeMode0 <
== >*
DataGridViewAutoSizeColumnMode? ]
.] ^
DisplayedCells^ l
;l m
feedbackDataGrid $
.$ %
Columns% ,
[, -
$num- .
]. /
./ 0
AutoSizeMode0 <
== >*
DataGridViewAutoSizeColumnMode? ]
.] ^
DisplayedCells^ l
;l m
feedbackDataGrid   $
.  $ %
Columns  % ,
[  , -
$num  - .
]  . /
.  / 0
AutoSizeMode  0 <
=  = >*
DataGridViewAutoSizeColumnMode  ? ]
.  ] ^
DisplayedCells  ^ l
;  l m
feedbackDataGrid!! $
.!!$ %
Columns!!% ,
[!!, -
$num!!- .
]!!. /
.!!/ 0
AutoSizeMode!!0 <
=!!= >*
DataGridViewAutoSizeColumnMode!!? ]
.!!] ^
Fill!!^ b
;!!b c
feedbackDataGrid## $
.##$ %
Columns##% ,
[##, -
$num##- .
]##. /
.##/ 0
Visible##0 7
=##8 9
false##: ?
;##? @
feedbackDataGrid%% $
.%%$ %

DataSource%%% /
=%%0 1
FeedbackHandler%%2 A
.%%A B
FillData%%B J
(%%J K
Doctor%%K Q
,%%Q R
dt%%S U
)%%U V
;%%V W
}&& 
else'' 
throw(( 
new(( 
	Exception(( '
(((' (
$str((( F
)((F G
;((G H
})) 
catch** 
(** 
	Exception** 
ex** 
)**  
{++ 
Logger,, 
.,, 
WriteLog,, 
(,,  
ex,,  "
),," #
;,,# $
ErrorHandler-- 
.-- 
	ShowError-- &
(--& '
ex--' )
.--) *
Message--* 1
)--1 2
;--2 3
Close.. 
(.. 
).. 
;.. 
}// 
}00 	
private33 
void33 
ShowFeedbackForm33 %
(33% &
DataGridViewRow33& 5
row336 9
)339 :
{44 	
if55 
(55 
row55 
.55 
Cells55 
[55 
$num55 
]55 
.55 
Value55 "
!=55# %
null55& *
)55* +
{66 
int77 
ID77 
=77 
Convert77  
.77  !
ToInt3277! (
(77( )
row77) ,
.77, -
Cells77- 2
[772 3
$num773 4
]774 5
.775 6
Value776 ;
.77; <
ToString77< D
(77D E
)77E F
)77F G
;77G H
Feedback:: 
feedback:: !
=::" #
DataHandler::$ /
.::/ 0
GetFeedback::0 ;
(::; <
ID::< >
)::> ?
;::? @
FeedbackForm== 
feedbackForm== )
===* +
new==, /
FeedbackForm==0 <
(==< =
feedback=== E
)==E F
;==F G
feedbackForm>> 
.>> 
Show>> !
(>>! "
)>>" #
;>># $
}?? 
else@@ 
MessagesHandlerAA 
.AA  
ShowMessageAA  +
(AA+ ,
$strAA, =
)AA= >
;AA> ?
}BB 	
privateDD 
voidDD $
showFeedbackButton_ClickDD -
(DD- .
objectDD. 4
senderDD5 ;
,DD; <
	EventArgsDD= F
eDDG H
)DDH I
{EE 	
ifFF 
(FF 
feedbackDataGridFF  
.FF  !
SelectedRowsFF! -
.FF- .
CountFF. 3
>FF4 5
$numFF6 7
)FF7 8
{GG 
DataGridViewRowHH 
rowHH  #
=HH$ %
feedbackDataGridHH& 6
.HH6 7
SelectedRowsHH7 C
[HHC D
$numHHD E
]HHE F
;HHF G
ShowFeedbackFormII  
(II  !
rowII! $
)II$ %
;II% &
}JJ 
elseKK 
ifKK 
(KK 
feedbackDataGridKK %
.KK% &
SelectedCellsKK& 3
.KK3 4
CountKK4 9
>KK: ;
$numKK< =
)KK= >
{LL 
DataGridViewRowMM 
rowMM  #
=MM$ %
feedbackDataGridMM& 6
.MM6 7
SelectedCellsMM7 D
[MMD E
$numMME F
]MMF G
.MMG H
	OwningRowMMH Q
;MMQ R
ShowFeedbackFormNN  
(NN  !
rowNN! $
)NN$ %
;NN% &
}OO 
elsePP 
MessagesHandlerQQ 
.QQ  
ShowMessageQQ  +
(QQ+ ,
$strQQ, =
)QQ= >
;QQ> ?
}RR 	
}SS 
}TT û 
DD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\AddDoctorForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
AddDoctorForm &
:' (
Form) -
{		 
public

 
AddDoctorForm

 
(

 
)

 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
AddDoctorForm_Load '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
try 
{ 
List 
< 
	Specialty 
> 
specialties  +
;+ ,
specialties 
= 
DataHandler )
.) *
GetSpecialties* 8
(8 9
)9 :
;: ;
foreach 
( 
	Specialty "
	specialty# ,
in- /
specialties0 ;
); <
specialtyComboBox %
.% &
Items& +
.+ ,
Add, /
(/ 0
	specialty0 9
.9 :
Name: >
)> ?
;? @
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' 9
)9 :
;: ;
Close 
( 
) 
; 
} 
} 	
private"" 
void"" 
confirmButton_Click"" (
(""( )
object"") /
sender""0 6
,""6 7
	EventArgs""8 A
e""B C
)""C D
{## 	
if%% 
(%% 
specialtyComboBox%% !
.%%! "
SelectedItem%%" .
==%%/ 1
null%%2 6
)%%6 7
ErrorHandler&& 
.&& 
	ShowError&& &
(&&& '
$str&&' A
)&&A B
;&&B C
else'' 
{(( 
string)) 
	specialty))  
=))! "
specialtyComboBox))# 4
.))4 5
SelectedItem))5 A
.))A B
ToString))B J
())J K
)))K L
;))L M
string** 
login** 
=** 
loginTextBox** +
.**+ ,
Text**, 0
;**0 1
string++ 
password++ 
=++  !
passwordTextBox++" 1
.++1 2
Text++2 6
;++6 7
string,, 
name,, 
=,, 
nameTextBox,, )
.,,) *
Text,,* .
;,,. /
string-- 
email-- 
=-- 
emailTextBox-- +
.--+ ,
Text--, 0
;--0 1
try// 
{00 
bool11 
result11 
=11  !
ProfilesHandler11" 1
.111 2
	AddDoctor112 ;
(11; <
login11< A
,11A B
name11C G
,11G H
email11I N
,11N O
password11P X
,11X Y
	specialty11Z c
)11c d
;11d e
if22 
(22 
result22 
)22 
{33 
MessagesHandler44 '
.44' (
ShowMessage44( 3
(443 4
$str444 I
)44I J
;44J K
Close55 
(55 
)55 
;55  
}66 
}77 
catch88 
(88 
	Exception88 
ex88  "
)88" #
{99 
Logger:: 
.:: 
WriteLog:: #
(::# $
ex::$ &
)::& '
;::' (
ErrorHandler;;  
.;;  !
	ShowError;;! *
(;;* +
$str;;+ N
);;N O
;;;O P
Close<< 
(<< 
)<< 
;<< 
}== 
}>> 
}?? 	
}@@ 
}AA Æ9
FD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\DoctorsListForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
DoctorsListForm (
:) *
Form+ /
{		 
private

 
	DataTable

 
dt

 
=

 
new

 "
	DataTable

# ,
(

, -
)

- .
;

. /
public 
DoctorsListForm 
( 
)  
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void  
DoctorsListForm_Load )
() *
object* 0
sender1 7
,7 8
	EventArgs9 B
eC D
)D E
{ 	
try 
{ 
dt 
= 
DoctorsHandler #
.# $
GetDataTable$ 0
(0 1
)1 2
;2 3
if 
( 
( 
dt 
!= 
null 
)  
&&! #
($ %
dt% '
.' (
Columns( /
./ 0
Count0 5
>6 7
$num8 9
)9 :
): ;
{ 
doctorsDataGrid #
.# $

DataSource$ .
=/ 0
dt1 3
;3 4
doctorsDataGrid #
.# $
Columns$ +
[+ ,
$num, -
]- .
.. /
AutoSizeMode/ ;
=< =*
DataGridViewAutoSizeColumnMode> \
.\ ]
DisplayedCells] k
;k l
doctorsDataGrid #
.# $
Columns$ +
[+ ,
$num, -
]- .
.. /
AutoSizeMode/ ;
=< =*
DataGridViewAutoSizeColumnMode> \
.\ ]
DisplayedCells] k
;k l
doctorsDataGrid #
.# $
Columns$ +
[+ ,
$num, -
]- .
.. /
AutoSizeMode/ ;
=< =*
DataGridViewAutoSizeColumnMode> \
.\ ]
Fill] a
;a b
doctorsDataGrid   #
.  # $
Columns  $ +
[  + ,
$num  , -
]  - .
.  . /
Visible  / 6
=  7 8
false  9 >
;  > ?
doctorsDataGrid"" #
.""# $

DataSource""$ .
=""/ 0
DoctorsHandler""1 ?
.""? @
FillData""@ H
(""H I
dt""I K
)""K L
;""L M
}## 
else$$ 
throw%% 
new%% 
	Exception%% '
(%%' (
$str%%( F
)%%F G
;%%G H
}&& 
catch'' 
('' 
	Exception'' 
ex'' 
)''  
{(( 
Logger)) 
.)) 
WriteLog)) 
())  
ex))  "
)))" #
;))# $
ErrorHandler** 
.** 
	ShowError** &
(**& '
ex**' )
.**) *
Message*** 1
)**1 2
;**2 3
Close++ 
(++ 
)++ 
;++ 
},, 
}-- 	
private00 
void00 
searchButton_Click00 '
(00' (
object00( .
sender00/ 5
,005 6
	EventArgs007 @
e00A B
)00B C
{11 	
string22 
query22 
=22 
searchTextBox22 (
.22( )
Text22) -
;22- .
doctorsDataGrid44 
.44 

DataSource44 &
=44' (
DoctorsHandler44) 7
.447 8
Search448 >
(44> ?
query44? D
,44D E
dt44F H
)44H I
;44I J
}55 	
private88 
void88 
ShowDoctorForm88 #
(88# $
DataGridViewRow88$ 3
row884 7
)887 8
{99 	
if:: 
(:: 
row:: 
.:: 
Cells:: 
[:: 
$num:: 
]:: 
.:: 
Value:: "
!=::# %
null::& *
)::* +
{;; 
int<< 
ID<< 
=<< 
Convert<<  
.<<  !
ToInt32<<! (
(<<( )
row<<) ,
.<<, -
Cells<<- 2
[<<2 3
$num<<3 4
]<<4 5
.<<5 6
Value<<6 ;
.<<; <
ToString<<< D
(<<D E
)<<E F
)<<F G
;<<G H
Doctor?? 
doctor?? 
=?? 
DataHandler??  +
.??+ ,
	GetDoctor??, 5
(??5 6
ID??6 8
)??8 9
;??9 :
DoctorInfoFormBB 
doctorInfoFormBB -
=BB. /
newBB0 3
DoctorInfoFormBB4 B
(BBB C
doctorBBC I
)BBI J
;BBJ K
doctorInfoFormCC 
.CC 

FormClosedCC )
+=CC* ,%
DoctorInfoForm_FormClosedCC- F
;CCF G
doctorInfoFormDD 
.DD 
ShowDD #
(DD# $
)DD$ %
;DD% &
}EE 
elseFF 
MessagesHandlerGG 
.GG  
ShowMessageGG  +
(GG+ ,
$strGG, <
)GG< =
;GG= >
}HH 	
privateKK 
voidKK 
infoButton_ClickKK %
(KK% &
objectKK& ,
senderKK- 3
,KK3 4
	EventArgsKK5 >
eKK? @
)KK@ A
{LL 	
ifMM 
(MM 
doctorsDataGridMM 
.MM  
SelectedRowsMM  ,
.MM, -
CountMM- 2
>MM3 4
$numMM5 6
)MM6 7
{NN 
DataGridViewRowPP 
rowPP  #
=PP$ %
doctorsDataGridPP& 5
.PP5 6
SelectedRowsPP6 B
[PPB C
$numPPC D
]PPD E
;PPE F
ShowDoctorFormQQ 
(QQ 
rowQQ "
)QQ" #
;QQ# $
}RR 
elseSS 
ifSS 
(SS 
doctorsDataGridSS $
.SS$ %
SelectedCellsSS% 2
.SS2 3
CountSS3 8
>SS9 :
$numSS; <
)SS< =
{TT 
DataGridViewRowUU 
rowUU  #
=UU$ %
doctorsDataGridUU& 5
.UU5 6
SelectedCellsUU6 C
[UUC D
$numUUD E
]UUE F
.UUF G
	OwningRowUUG P
;UUP Q
ShowDoctorFormVV 
(VV 
rowVV "
)VV" #
;VV# $
}WW 
elseXX 
MessagesHandlerYY 
.YY  
ShowMessageYY  +
(YY+ ,
$strYY, D
)YYD E
;YYE F
}ZZ 	
private]] 
void]] %
DoctorInfoForm_FormClosed]] .
(]]. /
object]]/ 5
sender]]6 <
,]]< =
FormClosedEventArgs]]> Q
e]]R S
)]]S T
{^^ 	
doctorsDataGrid__ 
.__ 

DataSource__ &
=__' (
DoctorsHandler__) 7
.__7 8
FillData__8 @
(__@ A
dt__A C
)__C D
;__D E
}`` 	
}aa 
}bb €
CD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\EditUserForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
EditUserForm %
:& '
Form( ,
{ 
private		 
User		 
EditUser		 
;		 
public 
EditUserForm 
( 
User  
user! %
)% &
{ 	
InitializeComponent 
(  
)  !
;! "
EditUser 
= 
user 
; 
} 	
private 
void 
EditUserForm_Load &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
try 
{ 
loginTextBox 
. 
Text !
=" #
EditUser$ ,
., -
Login- 2
;2 3
emailTextBox 
. 
Text !
=" #
EditUser$ ,
., -
Email- 2
;2 3
nameTextBox 
. 
Text  
=! "
EditUser# +
.+ ,
Name, 0
;0 1
passwordTextBox 
.  
Text  $
=% &
EditUser' /
./ 0
Password0 8
;8 9
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' J
)J K
;K L
Close 
( 
) 
; 
} 
}   	
private## 
void## 
confirmButton_Click## (
(##( )
object##) /
sender##0 6
,##6 7
	EventArgs##8 A
e##B C
)##C D
{$$ 	
string&& 
login&& 
=&& 
loginTextBox&& '
.&&' (
Text&&( ,
;&&, -
string'' 
email'' 
='' 
emailTextBox'' '
.''' (
Text''( ,
;'', -
string(( 
name(( 
=(( 
nameTextBox(( %
.((% &
Text((& *
;((* +
string)) 
password)) 
=)) 
passwordTextBox)) -
.))- .
Text)). 2
;))2 3
try++ 
{,, 
bool-- 
result-- 
=-- 
ProfilesHandler-- -
.--- .
EditUser--. 6
(--6 7
EditUser--7 ?
,--? @
login--A F
,--F G
email--H M
,--M N
name--O S
,--S T
password--U ]
)--] ^
;--^ _
if.. 
(.. 
result.. 
).. 
{// 
MessagesHandler00 #
.00# $
ShowMessage00$ /
(00/ 0
$str000 M
)00M N
;00N O
Close11 
(11 
)11 
;11 
}22 
}33 
catch44 
(44 
	Exception44 
ex44 
)44  
{55 
Logger66 
.66 
WriteLog66 
(66  
ex66  "
)66" #
;66# $
ErrorHandler77 
.77 
	ShowError77 &
(77& '
$str77' G
)77G H
;77H I
Close88 
(88 
)88 
;88 
}99 
}:: 	
};; 
}<< ¹2
HD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\DoctorsHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
public		 

static		 
class		 
DoctorsHandler		 &
{

 
static 
public 
	DataTable 
GetDataTable  ,
(, -
)- .
{ 	
	DataTable 
dt 
= 
new 
	DataTable (
(( )
)) *
;* +
try 
{ 
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 2
,2 3
typeof4 :
(: ;
int; >
)> ?
)? @
)@ A
;A B
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. =
,= >
typeof? E
(E F
stringF L
)L M
)M N
)N O
;O P
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 3
,3 4
typeof5 ;
(; <
string< B
)B C
)C D
)D E
;E F
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
return 
null 
; 
} 
return 
dt 
; 
} 	
static   
public   
	DataTable   
FillData    (
(  ( )
	DataTable  ) 2
dt  3 5
)  5 6
{!! 	
dt"" 
."" 
Rows"" 
."" 
Clear"" 
("" 
)"" 
;"" 
try$$ 
{%% 
List&& 
<&& 
Doctor&& 
>&& 
doctors&& $
;&&$ %
doctors'' 
='' 
DataHandler'' %
.''% &

GetDoctors''& 0
(''0 1
)''1 2
;''2 3
foreach)) 
()) 
Doctor)) 
doctor)) %
in))& (
doctors))) 0
)))0 1
{** 
int++ 
id++ 
=++ 
doctor++ #
.++# $
DoctorID++$ ,
;++, -
string,, 
name,, 
=,,  !
doctor,," (
.,,( )
User,,) -
.,,- .
Name,,. 2
;,,2 3
string-- 
	specialty-- $
=--% &
doctor--' -
.--- .
	Specialty--. 7
.--7 8
Name--8 <
;--< =
dt// 
.// 
Rows// 
.// 
Add// 
(//  
id//  "
,//" #
	specialty//$ -
,//- .
name/// 3
)//3 4
;//4 5
}00 
return22 
dt22 
;22 
}33 
catch44 
(44 
	Exception44 
ex44 
)44  
{55 
Logger66 
.66 
WriteLog66 
(66  
ex66  "
)66" #
;66# $
return77 
null77 
;77 
}88 
}99 	
static<< 
public<< 
	DataTable<< 
Search<<  &
(<<& '
string<<' -
query<<. 3
,<<3 4
	DataTable<<5 >
dt<<? A
)<<A B
{== 	
if?? 
(?? 
(?? 
query?? 
==?? 
$str?? 
)?? 
||??  
(??! "
query??" '
==??( *
null??+ /
)??/ 0
)??0 1
return@@ 
FillData@@ 
(@@  
dt@@  "
)@@" #
;@@# $
stringCC 
[CC 
]CC 

queryPartsCC 
=CC  !
queryCC" '
.CC' (
SplitCC( -
(CC- .
$charCC. 1
)CC1 2
;CC2 3
foreachEE 
(EE 
stringEE 
qryEE 
inEE  "

queryPartsEE# -
)EE- .
{FF 
ifGG 
(GG 
	ValidatorGG 
.GG 
IsSpecialtyGG )
(GG) *
qryGG* -
)GG- .
)GG. /
dtHH 
=HH 

FilterDataHH #
(HH# $
dtHH$ &
,HH& '
$strHH( 7
,HH7 8
qryHH9 <
)HH< =
;HH= >
elseII 
dtII 
=II 

FilterDataII $
(II$ %
dtII% '
,II' (
$strII) .
,II. /
qryII0 3
)II3 4
;II4 5
}JJ 
returnLL 
dtLL 
;LL 
}MM 	
staticPP 
privatePP 
	DataTablePP  

FilterDataPP! +
(PP+ ,
	DataTablePP, 5
tablePP6 ;
,PP; <
stringPP= C
fieldPPD I
,PPI J
stringPPK Q
valuePPR W
)PPW X
{QQ 	
tryRR 
{SS 
tableTT 
=TT 
tableTT 
.TT 
AsEnumerableTT *
(TT* +
)TT+ ,
.UU 
WhereUU 
(UU 
rowUU 
=>UU 
rowUU !
.UU! "
FieldUU" '
<UU' (
stringUU( .
>UU. /
(UU/ 0
fieldUU0 5
)UU5 6
==UU7 9
valueUU: ?
)UU? @
.VV 
CopyToDataTableVV  
(VV  !
)VV! "
;VV" #
returnWW 
tableWW 
;WW 
}XX 
catchYY 
(YY 
	ExceptionYY 
exYY 
)YY  
{ZZ 
Logger[[ 
.[[ 
WriteLog[[ 
([[  
ex[[  "
)[[" #
;[[# $
	DataTable\\ 
dt\\ 
=\\ 
table\\ $
.\\$ %
Clone\\% *
(\\* +
)\\+ ,
;\\, -
return]] 
dt]] 
;]] 
}^^ 
}__ 	
}`` 
}aa ½4
ID:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\FeedbackHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
FeedbackHandler '
{		 
static 
public 
	DataTable 
GetDataTable  ,
(, -
)- .
{ 	
	DataTable 
dt 
= 
new 
	DataTable (
(( )
)) *
;* +
try 
{ 
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 2
,2 3
typeof4 :
(: ;
int; >
)> ?
)? @
)@ A
;A B
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 4
,4 5
typeof6 <
(< =
string= C
)C D
)D E
)E F
;F G
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. <
,< =
typeof> D
(D E
stringE K
)K L
)L M
)M N
;N O
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 9
,9 :
typeof; A
(A B
stringB H
)H I
)I J
)J K
;K L
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
return 
null 
; 
} 
return 
dt 
; 
} 	
static   
public   
	DataTable   
FillData    (
(  ( )
Doctor  ) /
doctor  0 6
,  6 7
	DataTable  8 A
dt  B D
)  D E
{!! 	
dt"" 
."" 
Rows"" 
."" 
Clear"" 
("" 
)"" 
;"" 
try$$ 
{%% 
List&& 
<&& 
Feedback&& 
>&& 
	feedbacks&& (
;&&( )
	feedbacks'' 
='' 
doctor'' "
.''" #
	Feedbacks''# ,
;'', -
foreach)) 
()) 
Feedback)) !
feedback))" *
in))+ -
	feedbacks)). 7
)))7 8
{** 
int++ 
id++ 
=++ 
feedback++ %
.++% &
ID++& (
;++( )
string,, 
date,, 
=,,  !
feedback,," *
.,,* +
Date,,+ /
;,,/ 0
string-- 
docName-- "
=--# $
DataHandler--% 0
.--0 1
	GetDoctor--1 :
(--: ;
feedback--; C
.--C D
DoctorID--D L
)--L M
.--M N
User--N R
.--R S
Name--S W
;--W X
string.. 
patName.. "
=..# $
DataHandler..% 0
...0 1

GetPatient..1 ;
(..; <
feedback..< D
...D E
	PatientID..E N
,..N O
true..P T
)..T U
...U V
User..V Z
...Z [
Name..[ _
;.._ `
dt00 
.00 
Rows00 
.00 
Add00 
(00  
id00  "
,00" #
date00$ (
,00( )
patName00* 1
,001 2
docName003 :
)00: ;
;00; <
}11 
}22 
catch33 
(33 
	Exception33 
ex33 
)33  
{44 
Logger55 
.55 
WriteLog55 
(55  
ex55  "
)55" #
;55# $
return66 
null66 
;66 
}77 
return99 
dt99 
;99 
}:: 	
static<< 
public<< 
bool<< 
AddFeedback<< &
(<<& '
Doctor<<' -
doctor<<. 4
,<<4 5
Patient<<6 =
patient<<> E
,<<E F
int<<G J
value<<K P
,<<P Q
string<<R X
text<<Y ]
)<<] ^
{== 	
bool>> 
result>> 
=>> 
false>> 
;>>  
if@@ 
(@@ 
IsEmpty@@ 
(@@ 
text@@ 
)@@ 
)@@ 
ErrorHandlerAA 
.AA 
	ShowErrorAA &
(AA& '
$strAA' ?
)AA? @
;AA@ A
elseBB 
{CC 
tryDD 
{EE 
stringFF 
dateFF 
=FF  !
DateTimeFF" *
.FF* +
TodayFF+ 0
.FF0 1
ToStringFF1 9
(FF9 :
$strFF: F
)FFF G
;FFG H
DataHandlerGG 
.GG  
AddFeedbackGG  +
(GG+ ,
doctorGG, 2
.GG2 3
UserGG3 7
.GG7 8
LoginGG8 =
,GG= >
patientGG? F
.GGF G
UserGGG K
.GGK L
LoginGGL Q
,GGQ R
valueGGS X
,GGX Y
dateGGZ ^
,GG^ _
textGG` d
)GGd e
;GGe f
}HH 
catchII 
(II 
	ExceptionII  
exII! #
)II# $
{JJ 
LoggerKK 
.KK 
WriteLogKK #
(KK# $
exKK$ &
)KK& '
;KK' (
ErrorHandlerLL  
.LL  !
	ShowErrorLL! *
(LL* +
$strLL+ G
)LLG H
;LLH I
}MM 
}NN 
returnPP 
resultPP 
;PP 
}QQ 	
staticSS 
privateSS 
boolSS 
IsEmptySS #
(SS# $
stringSS$ *
valueSS+ 0
)SS0 1
{TT 	
ifUU 
(UU 
(UU 
valueUU 
==UU 
nullUU 
)UU 
||UU  "
(UU# $
valueUU$ )
==UU* ,
$strUU- /
)UU/ 0
)UU0 1
returnVV 
trueVV 
;VV 
elseWW 
returnWW 
falseWW 
;WW 
}XX 	
}YY 
}ZZ Ý5
FD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\UsersHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
public		 

static		 
class		 
UsersHandler		 $
{

 
static 
public 
	DataTable 
GetDataTable  ,
(, -
)- .
{ 	
	DataTable 
dt 
= 
new 
	DataTable (
(( )
)) *
;* +
try 
{ 
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 2
,2 3
typeof4 :
(: ;
int; >
)> ?
)? @
)@ A
;A B
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 3
,3 4
typeof5 ;
(; <
string< B
)B C
)C D
)D E
;E F
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 3
,3 4
typeof5 ;
(; <
string< B
)B C
)C D
)D E
;E F
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
return 
null 
; 
} 
return 
dt 
; 
} 	
static   
public   
	DataTable   
FillData    (
(  ( )
	DataTable  ) 2
dt  3 5
)  5 6
{!! 	
dt"" 
."" 
Rows"" 
."" 
Clear"" 
("" 
)"" 
;"" 
try$$ 
{%% 
List&& 
<&& 
User&& 
>&& 
users&&  
;&&  !
users'' 
='' 
DataHandler'' #
.''# $
GetUsers''$ ,
('', -
)''- .
;''. /
foreach)) 
()) 
User)) 
user)) "
in))# %
users))& +
)))+ ,
{** 
int++ 
id++ 
=++ 
user++ !
.++! "
ID++" $
;++$ %
string,, 
name,, 
=,,  !
user,," &
.,,& '
Name,,' +
;,,+ ,
string-- 
type-- 
=--  !
$str--" $
;--$ %
if.. 
(.. 
user.. 
... 
Patients.. %
...% &
Count..& +
>.., -
$num... /
)../ 0
type// 
=// 
$str// (
;//( )
else00 
if00 
(00 
user00 !
.00! "
Doctors00" )
.00) *
Count00* /
>000 1
$num002 3
)003 4
type11 
=11 
$str11 '
;11' (
else22 
type22 
=22 
$str22  /
;22/ 0
dt44 
.44 
Rows44 
.44 
Add44 
(44  
id44  "
,44" #
type44$ (
,44( )
name44* .
)44. /
;44/ 0
}55 
return77 
dt77 
;77 
}88 
catch99 
(99 
	Exception99 
ex99 
)99  
{:: 
Logger;; 
.;; 
WriteLog;; 
(;;  
ex;;  "
);;" #
;;;# $
return<< 
null<< 
;<< 
}== 
}>> 	
staticAA 
publicAA 
	DataTableAA 
SearchAA  &
(AA& '
stringAA' -
queryAA. 3
,AA3 4
	DataTableAA5 >
dtAA? A
)AAA B
{BB 	
ifDD 
(DD 
(DD 
queryDD 
==DD 
$strDD 
)DD 
||DD  
(DD! "
queryDD" '
==DD( *
nullDD+ /
)DD/ 0
)DD0 1
returnEE 
FillDataEE 
(EE  
dtEE  "
)EE" #
;EE# $
stringHH 
[HH 
]HH 

queryPartsHH 
=HH  !
queryHH" '
.HH' (
SplitHH( -
(HH- .
$charHH. 1
)HH1 2
;HH2 3
foreachJJ 
(JJ 
stringJJ 
qryJJ 
inJJ !

queryPartsJJ" ,
)JJ, -
{KK 
ifLL 
(LL 
	ValidatorLL 
.LL 
IsTypeLL $
(LL$ %
qryLL% (
)LL( )
)LL) *
dtMM 
=MM 

FilterDataMM #
(MM# $
dtMM$ &
,MM& '
$strMM( -
,MM- .
qryMM/ 2
)MM2 3
;MM3 4
elseNN 
dtNN 
=NN 

FilterDataNN $
(NN$ %
dtNN% '
,NN' (
$strNN) .
,NN. /
qryNN0 3
)NN3 4
;NN4 5
}OO 
returnQQ 
dtQQ 
;QQ 
}RR 	
staticUU 
privateUU 
	DataTableUU  

FilterDataUU! +
(UU+ ,
	DataTableUU, 5
tableUU6 ;
,UU; <
stringUU= C
fieldUUD I
,UUI J
stringUUK Q
valueUUR W
)UUW X
{VV 	
tryWW 
{XX 
tableYY 
=YY 
tableYY 
.YY 
AsEnumerableYY *
(YY* +
)YY+ ,
.ZZ 
WhereZZ 
(ZZ 
rowZZ 
=>ZZ 
rowZZ !
.ZZ! "
FieldZZ" '
<ZZ' (
stringZZ( .
>ZZ. /
(ZZ/ 0
fieldZZ0 5
)ZZ5 6
==ZZ7 9
valueZZ: ?
)ZZ? @
.[[ 
CopyToDataTable[[  
([[  !
)[[! "
;[[" #
return\\ 
table\\ 
;\\ 
}]] 
catch^^ 
(^^ 
	Exception^^ 
ex^^ 
)^^  
{__ 
Logger`` 
.`` 
WriteLog`` 
(``  
ex``  "
)``" #
;``# $
	DataTableaa 
dtaa 
=aa 
tableaa $
.aa$ %
Cloneaa% *
(aa* +
)aa+ ,
;aa, -
returnbb 
dtbb 
;bb 
}cc 
}dd 	
}ee 
}ff ¨A
DD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\UsersListForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
UsersListForm &
:' (
Form) -
{		 
private

 
	DataTable

 
dt

 
=

 
new

 "
	DataTable

# ,
(

, -
)

- .
;

. /
public 
UsersListForm 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
UsersListForm_Load '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
try 
{ 
dt 
= 
UsersHandler !
.! "
GetDataTable" .
(. /
)/ 0
;0 1
if 
( 
( 
dt 
!= 
null 
)  
&&! #
($ %
dt% '
.' (
Columns( /
./ 0
Count0 5
>6 7
$num8 9
)9 :
): ;
{ 
usersDataGrid !
.! "

DataSource" ,
=- .
dt/ 1
;1 2
usersDataGrid !
.! "
Columns" )
[) *
$num* +
]+ ,
., -
AutoSizeMode- 9
=: ;*
DataGridViewAutoSizeColumnMode< Z
.Z [
DisplayedCells[ i
;i j
usersDataGrid !
.! "
Columns" )
[) *
$num* +
]+ ,
., -
AutoSizeMode- 9
=: ;*
DataGridViewAutoSizeColumnMode< Z
.Z [
DisplayedCells[ i
;i j
usersDataGrid !
.! "
Columns" )
[) *
$num* +
]+ ,
., -
AutoSizeMode- 9
=: ;*
DataGridViewAutoSizeColumnMode< Z
.Z [
Fill[ _
;_ `
usersDataGrid!! !
.!!! "
Columns!!" )
[!!) *
$num!!* +
]!!+ ,
.!!, -
Visible!!- 4
=!!5 6
false!!7 <
;!!< =
usersDataGrid## !
.##! "

DataSource##" ,
=##- .
UsersHandler##/ ;
.##; <
FillData##< D
(##D E
dt##E G
)##G H
;##H I
}$$ 
else%% 
throw&& 
new&& 
	Exception&& '
(&&' (
$str&&( F
)&&F G
;&&G H
}'' 
catch(( 
((( 
	Exception(( 
ex(( 
)((  
{)) 
Logger** 
.** 
WriteLog** 
(**  
ex**  "
)**" #
;**# $
ErrorHandler++ 
.++ 
	ShowError++ &
(++& '
ex++' )
.++) *
Message++* 1
)++1 2
;++2 3
Close,, 
(,, 
),, 
;,, 
}-- 
}.. 	
private11 
void11 
searchButton_Click11 '
(11' (
object11( .
sender11/ 5
,115 6
	EventArgs117 @
e11A B
)11B C
{22 	
string33 
query33 
=33 
searchTextBox33 (
.33( )
Text33) -
;33- .
usersDataGrid55 
.55 

DataSource55 $
=55% &
UsersHandler55' 3
.553 4
Search554 :
(55: ;
query55; @
,55@ A
dt55B D
)55D E
;55E F
}66 	
private99 
void99 
ShowUserForm99 !
(99! "
DataGridViewRow99" 1
row992 5
)995 6
{:: 	
if;; 
(;; 
row;; 
.;; 
Cells;; 
[;; 
$num;; 
];; 
.;; 
Value;; "
!=;;# %
null;;& *
);;* +
{<< 
int== 
ID== 
=== 
Convert==  
.==  !
ToInt32==! (
(==( )
row==) ,
.==, -
Cells==- 2
[==2 3
$num==3 4
]==4 5
.==5 6
Value==6 ;
.==; <
ToString==< D
(==D E
)==E F
)==F G
;==G H
User@@ 
user@@ 
=@@ 
DataHandler@@ '
.@@' (
GetUser@@( /
(@@/ 0
ID@@0 2
)@@2 3
;@@3 4
UserInfoFormCC 
userInfoFormCC )
=CC* +
newCC, /
UserInfoFormCC0 <
(CC< =
userCC= A
)CCA B
;CCB C
userInfoFormDD 
.DD 

FormClosedDD '
+=DD( *#
UserInfoForm_FormClosedDD+ B
;DDB C
userInfoFormEE 
.EE 
ShowEE !
(EE! "
)EE" #
;EE# $
}FF 
elseGG 
MessagesHandlerHH 
.HH  
ShowMessageHH  +
(HH+ ,
$strHH, D
)HHD E
;HHE F
}II 	
privateLL 
voidLL 
infoButton_ClickLL %
(LL% &
objectLL& ,
senderLL- 3
,LL3 4
	EventArgsLL5 >
eLL? @
)LL@ A
{MM 	
ifNN 
(NN 
usersDataGridNN 
.NN 
SelectedRowsNN *
.NN* +
CountNN+ 0
>NN1 2
$numNN3 4
)NN4 5
{OO 
DataGridViewRowQQ 
rowQQ  #
=QQ$ %
usersDataGridQQ& 3
.QQ3 4
SelectedRowsQQ4 @
[QQ@ A
$numQQA B
]QQB C
;QQC D
ShowUserFormRR 
(RR 
rowRR  
)RR  !
;RR! "
}SS 
elseTT 
ifTT 
(TT 
usersDataGridTT "
.TT" #
SelectedCellsTT# 0
.TT0 1
CountTT1 6
>TT7 8
$numTT9 :
)TT: ;
{UU 
DataGridViewRowVV 
rowVV  #
=VV$ %
usersDataGridVV& 3
.VV3 4
SelectedCellsVV4 A
[VVA B
$numVVB C
]VVC D
.VVD E
	OwningRowVVE N
;VVN O
ShowUserFormWW 
(WW 
rowWW  
)WW  !
;WW! "
}XX 
elseYY 
MessagesHandlerZZ 
.ZZ  
ShowMessageZZ  +
(ZZ+ ,
$strZZ, D
)ZZD E
;ZZE F
}[[ 	
private^^ 
void^^ #
UserInfoForm_FormClosed^^ ,
(^^, -
object^^- 3
sender^^4 :
,^^: ;
FormClosedEventArgs^^< O
e^^P Q
)^^Q R
{__ 	
usersDataGrid`` 
.`` 

DataSource`` $
=``% &
UsersHandler``' 3
.``3 4
FillData``4 <
(``< =
dt``= ?
)``? @
;``@ A
}aa 	
privatedd 
voiddd 
addUser_Clickdd "
(dd" #
objectdd# )
senderdd* 0
,dd0 1
	EventArgsdd2 ;
edd< =
)dd= >
{ee 	
AddDoctorFormff 
addDoctorFormff '
=ff( )
newff* -
AddDoctorFormff. ;
(ff; <
)ff< =
;ff= >
addDoctorFormgg 
.gg 

FormClosedgg $
+=gg% '$
AddDoctorForm_FormClosedgg( @
;gg@ A
addDoctorFormhh 
.hh 
Showhh 
(hh 
)hh  
;hh  !
}ii 	
privatell 
voidll $
AddDoctorForm_FormClosedll -
(ll- .
objectll. 4
senderll5 ;
,ll; <
FormClosedEventArgsll= P
ellQ R
)llR S
{mm 	
usersDataGridnn 
.nn 

DataSourcenn $
=nn% &
UsersHandlernn' 3
.nn3 4
FillDatann4 <
(nn< =
dtnn= ?
)nn? @
;nn@ A
}oo 	
}pp 
}qq ·-
ED:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\AddVisitForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
AddVisitForm %
:& '
Form( ,
{ 
private		 
Doctor		 
chosenDoctor		 #
;		# $
private

 
string

 

chosenDate

 !
;

! "
public 
AddVisitForm 
( 
Doctor "
doctor# )
)) *
{ 	
InitializeComponent 
(  
)  !
;! "
chosenDoctor 
= 
doctor !
;! "
} 	
private 
void 
AddVisitForm_Load &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
messagesLabel 
. 
Text 
=  
$str! #
;# $
visitDateTimePicker 
.  
MinDate  '
=( )
DateTime* 2
.2 3
Today3 8
;8 9
visitDateTimePicker 
.  
MaxDate  '
=( )
DateTime* 2
.2 3
Today3 8
.8 9
AddYears9 A
(A B
$numB C
)C D
;D E
addVisitButton 
. 
Enabled "
=# $
false% *
;* +
doctorTextBox 
. 
Text 
=  
chosenDoctor! -
.- .
User. 2
.2 3
Name3 7
;7 8
} 	
private"" 
void"" ,
 visitDateTimePicker_ValueChanged"" 5
(""5 6
object""6 <
sender""= C
,""C D
	EventArgs""E N
e""O P
)""P Q
{## 	
messagesLabel$$ 
.$$ 
Text$$ 
=$$  
$str$$! #
;$$# $
string'' 
	dayOfWeek'' 
='' 
visitDateTimePicker'' 2
.''2 3
Value''3 8
.''8 9
	DayOfWeek''9 B
.''B C
ToString''C K
(''K L
)''L M
;''M N
if(( 
((( 
((( 
	dayOfWeek(( 
==(( 
$str(( (
)((( )
||((* ,
(((- .
	dayOfWeek((. 7
==((8 :
$str((; C
)((C D
)((D E
messagesLabel)) 
.)) 
Text)) "
=))# $
$str))% <
;))< =
else** 
{++ 
	dayOfWeek,, 
=,, 
visitDateTimePicker,, /
.,,/ 0
Value,,0 5
.,,5 6
ToString,,6 >
(,,> ?
$str,,? K
),,K L
;,,L M
bool// 
	dayIsFree// 
=//  
VisitsHandler//! .
.//. /
CheckDoctorBusyness/// B
(//B C
chosenDoctor//C O
,//O P
	dayOfWeek//Q Z
)//Z [
;//[ \
if22 
(22 
	dayIsFree22 
)22 
{33 
addVisitButton44 "
.44" #
Enabled44# *
=44+ ,
true44- 1
;441 2

chosenDate55 
=55  
	dayOfWeek55! *
;55* +
}66 
else77 
messagesLabel88 !
.88! "
Text88" &
=88' (
$str88) ?
;88? @
}99 
}:: 	
private== 
void==  
addVisitButton_Click== )
(==) *
object==* 0
sender==1 7
,==7 8
	EventArgs==9 B
e==C D
)==D E
{>> 	
try?? 
{@@ 
ifAA 
(AA 
visitTypeComboBoxAA %
.AA% &
SelectedItemAA& 2
==AA3 5
nullAA6 :
)AA: ;
{BB 
messagesLabelCC !
.CC! "
TextCC" &
=CC' (
$strCC) ?
;CC? @
}DD 
elseEE 
{FF 
stringHH 
doctorLoginHH &
=HH' (
chosenDoctorHH) 5
.HH5 6
UserHH6 :
.HH: ;
LoginHH; @
;HH@ A
stringII 

cardNumberII %
=II& '
MainFormII( 0
.II0 1

CurPatientII1 ;
.II; <
PatientCardsII< H
[IIH I
$numIII J
]IIJ K
.IIK L

CardNumberIIL V
;IIV W
stringJJ 
typeJJ 
=JJ  !
visitTypeComboBoxJJ" 3
.JJ3 4
SelectedItemJJ4 @
.JJ@ A
ToStringJJA I
(JJI J
)JJJ K
;JJK L
DataHandlerKK 
.KK  
AddDoctorVisitKK  .
(KK. /
doctorLoginKK/ :
,KK: ;

cardNumberKK< F
,KKF G

chosenDateKKH R
,KKR S
typeKKT X
)KKX Y
;KKY Z
MessagesHandlerMM #
.MM# $
ShowMessageMM$ /
(MM/ 0
$strMM0 M
)MMM N
;MMN O
ClosePP 
(PP 
)PP 
;PP 
}QQ 
}RR 
catchSS 
(SS 
	ExceptionSS 
exSS 
)SS 
{TT 
LoggerUU 
.UU 
WriteLogUU 
(UU  
exUU  "
)UU" #
;UU# $
ErrorHandlerVV 
.VV 
	ShowErrorVV &
(VV& '
$strVV' B
)VVB C
;VVC D
CloseWW 
(WW 
)WW 
;WW 
}XX 
}YY 	
}ZZ 
}[[ å
ID:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\AddVisitInfoForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
AddVisitInfoForm )
:* +
Form, 0
{ 
private		 
DoctorVisit		 
Visit		 !
;		! "
public 
AddVisitInfoForm 
(  
DoctorVisit  +
visit, 1
)1 2
{ 	
InitializeComponent 
(  
)  !
;! "
Visit 
= 
visit 
; 
} 	
private 
void !
AddVisitInfoForm_Load *
(* +
object+ 1
sender2 8
,8 9
	EventArgs: C
eD E
)E F
{ 	
complaintsTextBox 
. 
Text "
=# $
Visit% *
.* +

Complaints+ 5
;5 6
diagnosisTextBox 
. 
Text !
=" #
Visit$ )
.) *
	Diagnosis* 3
;3 4
treatmentTextBox 
. 
Text !
=" #
Visit$ )
.) *
	Treatment* 3
;3 4
} 	
private 
void 
confirmButton_Click (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{ 	
try 
{ 
Visit 
. 

Complaints  
=! "
complaintsTextBox# 4
.4 5
Text5 9
;9 :
Visit   
.   
	Diagnosis   
=    !
diagnosisTextBox  " 2
.  2 3
Text  3 7
;  7 8
Visit!! 
.!! 
	Treatment!! 
=!!  !
treatmentTextBox!!" 2
.!!2 3
Text!!3 7
;!!7 8
DataHandler$$ 
.$$ 
UpdateInDatabase$$ ,
($$, -
Visit$$- 2
)$$2 3
;$$3 4
MessagesHandler&& 
.&&  
ShowMessage&&  +
(&&+ ,
$str&&, B
)&&B C
;&&C D
Close'' 
('' 
)'' 
;'' 
}(( 
catch)) 
()) 
	Exception)) 
ex)) 
)))  
{** 
Logger++ 
.++ 
WriteLog++ 
(++  
ex++  "
)++" #
;++# $
ErrorHandler,, 
.,, 
	ShowError,, &
(,,& '
$str,,' P
),,P Q
;,,Q R
Close-- 
(-- 
)-- 
;-- 
}.. 
}// 	
}00 
}11 Ð'
GD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\ChooseDateForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
ChooseDateForm '
:( )
Form* .
{ 
private		 
Doctor		 
Doctor		 
;		 
private

 
string

 
Date

 
;

 
private 
DoctorVisit 
Visit !
;! "
public 
ChooseDateForm 
( 
Doctor $
doctor% +
,+ ,
DoctorVisit- 8
visit9 >
)> ?
{ 	
InitializeComponent 
(  
)  !
;! "
Doctor 
= 
doctor 
; 
Visit 
= 
visit 
; 
} 	
private 
void  
addVisitButton_Click )
() *
object* 0
sender1 7
,7 8
	EventArgs9 B
eC D
)D E
{ 	
try 
{ 
Visit 
. 
Move 
( 
Date 
)  
;  !
DataHandler 
. 
UpdateInDatabase ,
(, -
Visit- 2
)2 3
;3 4
MessagesHandler 
.  
ShowMessage  +
(+ ,
$str, =
)= >
;> ?
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler   
.   
	ShowError   &
(  & '
$str  ' C
)  C D
;  D E
}!! 
Close"" 
("" 
)"" 
;"" 
}## 	
private%% 
void%% 
ChooseDateForm_Load%% (
(%%( )
object%%) /
sender%%0 6
,%%6 7
	EventArgs%%8 A
e%%B C
)%%C D
{&& 	
messagesLabel'' 
.'' 
Text'' 
=''  
$str''! #
;''# $
chooseDateButton** 
.** 
Enabled** $
=**% &
false**' ,
;**, -
visitDateTimePicker-- 
.--  
MinDate--  '
=--( )
DateTime--* 2
.--2 3
Today--3 8
;--8 9
visitDateTimePicker.. 
...  
MaxDate..  '
=..( )
DateTime..* 2
...2 3
Today..3 8
...8 9
AddYears..9 A
(..A B
$num..B C
)..C D
;..D E
}// 	
private11 
void11 ,
 visitDateTimePicker_ValueChanged11 5
(115 6
object116 <
sender11= C
,11C D
	EventArgs11E N
e11O P
)11P Q
{22 	
messagesLabel33 
.33 
Text33 
=33  
$str33! #
;33# $
string66 
	dayOfWeek66 
=66 
visitDateTimePicker66 2
.662 3
Value663 8
.668 9
	DayOfWeek669 B
.66B C
ToString66C K
(66K L
)66L M
;66M N
if77 
(77 
(77 
	dayOfWeek77 
==77 
$str77 (
)77( )
||77* ,
(77- .
	dayOfWeek77. 7
==778 :
$str77; C
)77C D
)77D E
{88 
messagesLabel99 
.99 
Text99 "
=99# $
$str99% <
;99< =
chooseDateButton::  
.::  !
Enabled::! (
=::) *
false::+ 0
;::0 1
};; 
else<< 
{== 
	dayOfWeek>> 
=>> 
visitDateTimePicker>> /
.>>/ 0
Value>>0 5
.>>5 6
ToString>>6 >
(>>> ?
$str>>? K
)>>K L
;>>L M
boolAA 
	dayIsFreeAA 
=AA  
VisitsHandlerAA! .
.AA. /
CheckDoctorBusynessAA/ B
(AAB C
DoctorAAC I
,AAI J
	dayOfWeekAAK T
)AAT U
;AAU V
ifDD 
(DD 
	dayIsFreeDD 
)DD 
{EE 
DateFF 
=FF 
	dayOfWeekFF $
;FF$ %
chooseDateButtonGG $
.GG$ %
EnabledGG% ,
=GG- .
trueGG/ 3
;GG3 4
}HH 
elseII 
{JJ 
messagesLabelKK !
.KK! "
TextKK" &
=KK' (
$strKK) ?
;KK? @
chooseDateButtonLL $
.LL$ %
EnabledLL% ,
=LL- .
falseLL/ 4
;LL4 5
}MM 
}NN 
}OO 	
}PP 
}QQ ã
BD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\VisitForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public		 

partial		 
class		 
	VisitForm		 "
:		# $
Form		% )
{

 
private 
DoctorVisit 
Visit !
;! "
public 
	VisitForm 
( 
DoctorVisit $
visit% *
)* +
{ 	
InitializeComponent 
(  
)  !
;! "
Visit 
= 
visit 
; 
} 	
private 
void 
VisitForm_Load #
(# $
object$ *
sender+ 1
,1 2
	EventArgs3 <
e= >
)> ?
{ 	
InitializeLabels 
( 
) 
; 
if 
( 
MainForm 
. 
	CurDoctor "
==# %
null& *
)* +
{ 
writeInfoButton 
.  
Visible  '
=( )
false* /
;/ 0
endVisitButton 
. 
Visible &
=' (
false) .
;. /
} 
if 
( 
MainForm 
. 
CurAdmin !
!=" $
null% )
)) *
{ 

moveButton   
.   
Enabled   "
=  # $
false  % *
;  * +
cancelButton!! 
.!! 
Enabled!! $
=!!% &
false!!' ,
;!!, -
}"" 
if$$ 
($$ 
($$ 
Visit$$ 
.$$ 
Status$$ 
==$$ 
$str$$  )
)$$) *
||$$+ -
($$. /
Visit$$/ 4
.$$4 5
Status$$5 ;
==$$< >
$str$$? I
)$$I J
)$$J K
{%% 
BlockButtons&& 
(&& 
)&& 
;&& 
}'' 
if)) 
()) 
MainForm)) 
.)) 
	CurDoctor)) "
!=))# %
null))& *
)))* +
{** 
patientLabel++ 
.++ 
Click++ "
+=++# %
PatientLabel_Click++& 8
;++8 9
patientLabel,, 
.,, 
	ForeColor,, &
=,,' (
Color,,) .
.,,. /
Blue,,/ 3
;,,3 4
}-- 
if// 
(// 
MainForm// 
.// 

CurPatient// #
!=//$ &
null//' +
)//+ ,
{00 
doctorLabel11 
.11 
Click11 !
+=11" $
DoctorLabel_Click11% 6
;116 7
doctorLabel22 
.22 
	ForeColor22 %
=22& '
Color22( -
.22- .
Blue22. 2
;222 3
}33 
if55 
(55 
MainForm55 
.55 
CurAdmin55 !
!=55" $
null55% )
)55) *
{66 
patientLabel77 
.77 
Click77 "
+=77# %
PatientLabel_Click77& 8
;778 9
patientLabel88 
.88 
	ForeColor88 &
=88' (
Color88) .
.88. /
Blue88/ 3
;883 4
doctorLabel:: 
.:: 
Click:: !
+=::" $
DoctorLabel_Click::% 6
;::6 7
doctorLabel;; 
.;; 
	ForeColor;; %
=;;& '
Color;;( -
.;;- .
Blue;;. 2
;;;2 3
}<< 
}== 	
private?? 
void?? 
PatientLabel_Click?? '
(??' (
object??( .
sender??/ 5
,??5 6
	EventArgs??7 @
e??A B
)??B C
{@@ 	
PatientBB 
patientBB 
=BB 
DataHandlerBB )
.BB) *

GetPatientBB* 4
(BB4 5
VisitBB5 :
.BB: ;
PatientCardIDBB; H
)BBH I
;BBI J
PatientInfoFormDD 
patientInfoFormDD +
=DD, -
newDD. 1
PatientInfoFormDD2 A
(DDA B
patientDDB I
)DDI J
;DDJ K
patientInfoFormEE 
.EE 
ShowEE  
(EE  !
)EE! "
;EE" #
}FF 	
privateHH 
voidHH 
DoctorLabel_ClickHH &
(HH& '
objectHH' -
senderHH. 4
,HH4 5
	EventArgsHH6 ?
eHH@ A
)HHA B
{II 	
DoctorKK 
doctorKK 
=KK 
DataHandlerKK '
.KK' (
	GetDoctorKK( 1
(KK1 2
VisitKK2 7
.KK7 8
DoctorIDKK8 @
)KK@ A
;KKA B
DoctorInfoFormMM 
doctorInfoFormMM )
=MM* +
newMM, /
DoctorInfoFormMM0 >
(MM> ?
doctorMM? E
)MME F
;MMF G
doctorInfoFormNN 
.NN 
ShowNN 
(NN  
)NN  !
;NN! "
}OO 	
privateQQ 
voidQQ 
InitializeLabelsQQ %
(QQ% &
)QQ& '
{RR 	
trySS 
{TT 
VisitUU 
=UU 
DataHandlerUU #
.UU# $
GetDoctorVisitUU$ 2
(UU2 3
VisitUU3 8
.UU8 9
VisitIDUU9 @
)UU@ A
;UUA B
	dateLabelWW 
.WW 
TextWW 
=WW  
$strWW! )
+WW* +
VisitWW, 1
.WW1 2
DateWW2 6
;WW6 7
statusLabelXX 
.XX 
TextXX  
=XX! "
$strXX# -
+XX. /
VisitXX0 5
.XX5 6
StatusXX6 <
;XX< =
	typeLabelYY 
.YY 
TextYY 
=YY  
$strYY! (
+YY) *
VisitYY+ 0
.YY0 1
TypeYY1 5
;YY5 6
Doctor[[ 
doctor[[ 
=[[ 
DataHandler[[  +
.[[+ ,
	GetDoctor[[, 5
([[5 6
Visit[[6 ;
.[[; <
DoctorID[[< D
)[[D E
;[[E F
doctorLabel\\ 
.\\ 
Text\\  
=\\! "
$str\\# -
+\\. /
doctor\\0 6
.\\6 7
User\\7 ;
.\\; <
Name\\< @
;\\@ A
Patient^^ 
patient^^ 
=^^  !
DataHandler^^" -
.^^- .

GetPatient^^. 8
(^^8 9
Visit^^9 >
.^^> ?
PatientCardID^^? L
)^^L M
;^^M N
patientLabel__ 
.__ 
Text__ !
=__" #
$str__$ /
+__0 1
patient__2 9
.__9 :
User__: >
.__> ?
Name__? C
;__C D
}`` 
catchaa 
(aa 
	Exceptionaa 
exaa 
)aa  
{bb 
Loggercc 
.cc 
WriteLogcc 
(cc  
excc  "
)cc" #
;cc# $
ErrorHandlerdd 
.dd 
	ShowErrordd &
(dd& '
$strdd' Q
)ddQ R
;ddR S
Closeee 
(ee 
)ee 
;ee 
}ff 
}gg 	
privatejj 
voidjj !
complaintsLabel_Clickjj *
(jj* +
objectjj+ 1
senderjj2 8
,jj8 9
	EventArgsjj: C
ejjD E
)jjE F
{kk 	
ifll 
(ll 
(ll 
Visitll 
.ll 

Complaintsll !
!=ll" $
nullll% )
)ll) *
&&ll+ -
(ll. /
Visitll/ 4
.ll4 5

Complaintsll5 ?
!=ll@ B
$strllC E
)llE F
)llF G
{mm 
VisitInfoFormnn 
visitInfoFormnn +
=nn, -
newnn. 1
VisitInfoFormnn2 ?
(nn? @
$strnn@ H
,nnH I
VisitnnJ O
.nnO P

ComplaintsnnP Z
)nnZ [
;nn[ \
visitInfoFormoo 
.oo 
Showoo "
(oo" #
)oo# $
;oo$ %
}pp 
elseqq 
MessagesHandlerrr 
.rr  
ShowMessagerr  +
(rr+ ,
$strrr, C
)rrC D
;rrD E
}ss 	
privatevv 
voidvv  
diagnosisLabel_Clickvv )
(vv) *
objectvv* 0
sendervv1 7
,vv7 8
	EventArgsvv9 B
evvC D
)vvD E
{ww 	
ifxx 
(xx 
(xx 
Visitxx 
.xx 
	Diagnosisxx  
!=xx! #
nullxx$ (
)xx( )
&&xx* ,
(xx- .
Visitxx. 3
.xx3 4
	Diagnosisxx4 =
!=xx> @
$strxxA C
)xxC D
)xxD E
{yy 
VisitInfoFormzz 
visitInfoFormzz +
=zz, -
newzz. 1
VisitInfoFormzz2 ?
(zz? @
$strzz@ I
,zzI J
VisitzzK P
.zzP Q
	DiagnosiszzQ Z
)zzZ [
;zz[ \
visitInfoForm{{ 
.{{ 
Show{{ "
({{" #
){{# $
;{{$ %
}|| 
else}} 
MessagesHandler~~ 
.~~  
ShowMessage~~  +
(~~+ ,
$str~~, C
)~~C D
;~~D E
} 	
private
‚‚ 
void
‚‚ "
treatmentLabel_Click
‚‚ )
(
‚‚) *
object
‚‚* 0
sender
‚‚1 7
,
‚‚7 8
	EventArgs
‚‚9 B
e
‚‚C D
)
‚‚D E
{
ƒƒ 	
if
„„ 
(
„„ 
(
„„ 
Visit
„„ 
.
„„ 
	Treatment
„„  
!=
„„! #
null
„„$ (
)
„„( )
&&
„„* ,
(
„„- .
Visit
„„. 3
.
„„3 4
	Treatment
„„4 =
!=
„„> @
$str
„„A C
)
„„C D
)
„„D E
{
…… 
VisitInfoForm
†† 
visitInfoForm
†† +
=
††, -
new
††. 1
VisitInfoForm
††2 ?
(
††? @
$str
††@ I
,
††I J
Visit
††K P
.
††P Q
	Treatment
††Q Z
)
††Z [
;
††[ \
visitInfoForm
‡‡ 
.
‡‡ 
Show
‡‡ "
(
‡‡" #
)
‡‡# $
;
‡‡$ %
}
ˆˆ 
else
‰‰ 
MessagesHandler
ŠŠ 
.
ŠŠ  
ShowMessage
ŠŠ  +
(
ŠŠ+ ,
$str
ŠŠ, C
)
ŠŠC D
;
ŠŠD E
}
‹‹ 	
private
ŽŽ 
void
ŽŽ 
moveButton_Click
ŽŽ %
(
ŽŽ% &
object
ŽŽ& ,
sender
ŽŽ- 3
,
ŽŽ3 4
	EventArgs
ŽŽ5 >
e
ŽŽ? @
)
ŽŽ@ A
{
 	
Doctor
 
doctor
 
=
 
DataHandler
 '
.
' (
	GetDoctor
( 1
(
1 2
Visit
2 7
.
7 8
DoctorID
8 @
)
@ A
;
A B
ChooseDateForm
‘‘ 
chooseDateForm
‘‘ )
=
‘‘* +
new
‘‘, /
ChooseDateForm
‘‘0 >
(
‘‘> ?
doctor
‘‘? E
,
‘‘E F
Visit
‘‘G L
)
‘‘L M
;
‘‘M N
chooseDateForm
’’ 
.
’’ 

FormClosed
’’ %
+=
’’& ('
ChooseDateForm_FormClosed
’’) B
;
’’B C
chooseDateForm
““ 
.
““ 
Show
““ 
(
““  
)
““  !
;
““! "
}
”” 	
private
—— 
void
—— '
ChooseDateForm_FormClosed
—— .
(
——. /
object
——/ 5
sender
——6 <
,
——< =!
FormClosedEventArgs
——> Q
e
——R S
)
——S T
{
˜˜ 	
InitializeLabels
šš 
(
šš 
)
šš 
;
šš 
}
›› 	
private
žž 
void
žž  
cancelButton_Click
žž '
(
žž' (
object
žž( .
sender
žž/ 5
,
žž5 6
	EventArgs
žž7 @
e
žžA B
)
žžB C
{
ŸŸ 	
DialogResult
¡¡ 
result
¡¡ 
=
¡¡  !

MessageBox
¡¡" ,
.
¡¡, -
Show
¡¡- 1
(
¡¡1 2
$str
¢¢ 8
,
¢¢8 9
$str
££ 
,
££  
MessageBoxButtons
¤¤ !
.
¤¤! "
YesNo
¤¤" '
,
¤¤' (
MessageBoxIcon
¥¥ 
.
¥¥ 
Question
¥¥ '
)
¦¦ 
;
¦¦ 
if
¨¨ 
(
¨¨ 
result
¨¨ 
==
¨¨ 
DialogResult
¨¨ &
.
¨¨& '
Yes
¨¨' *
)
¨¨* +
{
©© 
Visit
ªª 
.
ªª 
Cancel
ªª 
(
ªª 
)
ªª 
;
ªª 
DataHandler
«« 
.
«« 
UpdateInDatabase
«« ,
(
««, -
Visit
««- 2
)
««2 3
;
««3 4
InitializeLabels
¬¬  
(
¬¬  !
)
¬¬! "
;
¬¬" #
BlockButtons
­­ 
(
­­ 
)
­­ 
;
­­ 
}
®® 
}
¯¯ 	
private
±± 
void
±± 
BlockButtons
±± !
(
±±! "
)
±±" #
{
²² 	
writeInfoButton
³³ 
.
³³ 
Enabled
³³ #
=
³³$ %
false
³³& +
;
³³+ ,
endVisitButton
´´ 
.
´´ 
Enabled
´´ "
=
´´# $
false
´´% *
;
´´* +

moveButton
µµ 
.
µµ 
Enabled
µµ 
=
µµ  
false
µµ! &
;
µµ& '
cancelButton
¶¶ 
.
¶¶ 
Enabled
¶¶  
=
¶¶! "
false
¶¶# (
;
¶¶( )
}
·· 	
private
ºº 
void
ºº "
endVisitButton_Click
ºº )
(
ºº) *
object
ºº* 0
sender
ºº1 7
,
ºº7 8
	EventArgs
ºº9 B
e
ººC D
)
ººD E
{
»» 	
DialogResult
½½ 
result
½½ 
=
½½  !

MessageBox
½½" ,
.
½½, -
Show
½½- 1
(
½½1 2
$str
¾¾ 9
,
¾¾9 :
$str
¿¿ 
,
¿¿  
MessageBoxButtons
ÀÀ !
.
ÀÀ! "
YesNo
ÀÀ" '
,
ÀÀ' (
MessageBoxIcon
ÁÁ 
.
ÁÁ 
Question
ÁÁ '
)
ÂÂ 
;
ÂÂ 
if
ÄÄ 
(
ÄÄ 
result
ÄÄ 
==
ÄÄ 
DialogResult
ÄÄ &
.
ÄÄ& '
Yes
ÄÄ' *
)
ÄÄ* +
{
ÅÅ 
Visit
ÆÆ 
.
ÆÆ 
Complete
ÆÆ 
(
ÆÆ 
)
ÆÆ  
;
ÆÆ  !
DataHandler
ÇÇ 
.
ÇÇ 
UpdateInDatabase
ÇÇ ,
(
ÇÇ, -
Visit
ÇÇ- 2
)
ÇÇ2 3
;
ÇÇ3 4
InitializeLabels
ÈÈ  
(
ÈÈ  !
)
ÈÈ! "
;
ÈÈ" #
BlockButtons
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÊÊ 
}
ËË 	
private
ÎÎ 
void
ÎÎ #
writeInfoButton_Click
ÎÎ *
(
ÎÎ* +
object
ÎÎ+ 1
sender
ÎÎ2 8
,
ÎÎ8 9
	EventArgs
ÎÎ: C
e
ÎÎD E
)
ÎÎE F
{
ÏÏ 	
AddVisitInfoForm
ÐÐ 
addInfoForm
ÐÐ (
=
ÐÐ) *
new
ÐÐ+ .
AddVisitInfoForm
ÐÐ/ ?
(
ÐÐ? @
Visit
ÐÐ@ E
)
ÐÐE F
;
ÐÐF G
addInfoForm
ÑÑ 
.
ÑÑ 

FormClosed
ÑÑ "
+=
ÑÑ# %)
AddVisitInfoForm_FormClosed
ÑÑ& A
;
ÑÑA B
addInfoForm
ÒÒ 
.
ÒÒ 
Show
ÒÒ 
(
ÒÒ 
)
ÒÒ 
;
ÒÒ 
}
ÓÓ 	
private
ÕÕ 
void
ÕÕ )
AddVisitInfoForm_FormClosed
ÕÕ 0
(
ÕÕ0 1
object
ÕÕ1 7
sender
ÕÕ8 >
,
ÕÕ> ?!
FormClosedEventArgs
ÕÕ@ S
e
ÕÕT U
)
ÕÕU V
{
ÖÖ 	
InitializeLabels
×× 
(
×× 
)
×× 
;
×× 
}
ØØ 	
}
ÙÙ 
}ÚÚ §
FD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\VisitInfoForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
VisitInfoForm &
:' (
Form) -
{ 
private 
string 
Type 
; 
private		 
string		 
Content		 
;		 
public 
VisitInfoForm 
( 
string #
type$ (
,( )
string* 0
content1 8
)8 9
{ 	
InitializeComponent 
(  
)  !
;! "
Type 
= 
type 
; 
Content 
= 
content 
; 
Text 
= 
$str *
++ ,
type- 1
.1 2
ToLower2 9
(9 :
): ;
+< =
$str> A
;A B
} 	
private 
void 
VisitInfoForm_Load '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	

titleLabel 
. 
Text 
= 
Type "
;" #
infoTextBox 
. 
Text 
= 
Content &
;& '
} 	
} 
} Ù=
GD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\VisitsListForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
VisitsListForm '
:( )
Form* .
{		 
private

 
	DataTable

 
dt

 
=

 
new

 "
	DataTable

# ,
(

, -
)

- .
;

. /
public 
VisitsListForm 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
VisitsListForm_Load (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{ 	
try 
{ 
dt 
= 
VisitsHandler "
." #
GetDataTable# /
(/ 0
MainForm0 8
.8 9
currentUser9 D
)D E
;E F
if 
( 
( 
dt 
!= 
null 
)  
&&! #
($ %
dt% '
.' (
Columns( /
./ 0
Count0 5
>6 7
$num8 9
)9 :
): ;
{ 
visitsDataGrid "
." #

DataSource# -
=. /
dt0 2
;2 3
for 
( 
int 
i 
=  
$num! "
;" #
i$ %
<& '
visitsDataGrid( 6
.6 7
Columns7 >
.> ?
Count? D
;D E
iF G
++G I
)I J
{ 
if   
(   
i   
!=    
visitsDataGrid  ! /
.  / 0
Columns  0 7
.  7 8
Count  8 =
-  > ?
$num  @ A
)  A B
visitsDataGrid!! *
.!!* +
Columns!!+ 2
[!!2 3
i!!3 4
]!!4 5
.!!5 6
AutoSizeMode!!6 B
=!!C D*
DataGridViewAutoSizeColumnMode!!E c
.!!c d
DisplayedCells!!d r
;!!r s
else## 
visitsDataGrid$$ *
.$$* +
Columns$$+ 2
[$$2 3
i$$3 4
]$$4 5
.$$5 6
AutoSizeMode$$6 B
=$$C D*
DataGridViewAutoSizeColumnMode$$E c
.$$c d
Fill$$d h
;$$h i
}%% 
visitsDataGrid&& "
.&&" #
Columns&&# *
[&&* +
$num&&+ ,
]&&, -
.&&- .
Visible&&. 5
=&&6 7
false&&8 =
;&&= >
visitsDataGrid)) "
.))" #

DataSource))# -
=)). /
VisitsHandler))0 =
.))= >
FillData))> F
())F G
MainForm))G O
.))O P
currentUser))P [
,))[ \
dt))] _
)))_ `
;))` a
}** 
else++ 
throw,, 
new,, 
	Exception,, '
(,,' (
$str,,( F
),,F G
;,,G H
}-- 
catch.. 
(.. 
	Exception.. 
ex.. 
)..  
{// 
Logger00 
.00 
WriteLog00 
(00  
ex00  "
)00" #
;00# $
ErrorHandler11 
.11 
	ShowError11 &
(11& '
ex11' )
.11) *
Message11* 1
)111 2
;112 3
Close22 
(22 
)22 
;22 
}33 
}44 	
private77 
void77 
searchButton_Click77 '
(77' (
object77( .
sender77/ 5
,775 6
	EventArgs777 @
e77A B
)77B C
{88 	
string99 
query99 
=99 
searchTextBox99 (
.99( )
Text99) -
;99- .
visitsDataGrid;; 
.;; 

DataSource;; %
=;;& '
VisitsHandler;;( 5
.;;5 6
Search;;6 <
(;;< =
MainForm;;= E
.;;E F
currentUser;;F Q
,;;Q R
query;;S X
,;;X Y
dt;;Z \
);;\ ]
;;;] ^
}<< 	
private?? 
void?? 
ShowVisitForm?? "
(??" #
DataGridViewRow??# 2
row??3 6
)??6 7
{@@ 	
ifAA 
(AA 
rowAA 
.AA 
CellsAA 
[AA 
$numAA 
]AA 
.AA 
ValueAA "
!=AA# %
nullAA& *
)AA* +
{BB 
intCC 
IDCC 
=CC 
ConvertCC  
.CC  !
ToInt32CC! (
(CC( )
rowCC) ,
.CC, -
CellsCC- 2
[CC2 3
$numCC3 4
]CC4 5
.CC5 6
ValueCC6 ;
.CC; <
ToStringCC< D
(CCD E
)CCE F
)CCF G
;CCG H
DoctorVisitFF 
visitFF !
=FF" #
DataHandlerFF$ /
.FF/ 0
GetDoctorVisitFF0 >
(FF> ?
IDFF? A
)FFA B
;FFB C
	VisitFormII 
	visitFormII #
=II$ %
newII& )
	VisitFormII* 3
(II3 4
visitII4 9
)II9 :
;II: ;
	visitFormJJ 
.JJ 

FormClosedJJ $
+=JJ% ' 
VisitForm_FormClosedJJ( <
;JJ< =
	visitFormKK 
.KK 
ShowKK 
(KK 
)KK  
;KK  !
}LL 
elseMM 
MessagesHandlerNN 
.NN  
ShowMessageNN  +
(NN+ ,
$strNN, E
)NNE F
;NNF G
}OO 	
privateRR 
voidRR 
infoButton_ClickRR %
(RR% &
objectRR& ,
senderRR- 3
,RR3 4
	EventArgsRR5 >
eRR? @
)RR@ A
{SS 	
ifTT 
(TT 
visitsDataGridTT 
.TT 
SelectedRowsTT +
.TT+ ,
CountTT, 1
>TT2 3
$numTT4 5
)TT5 6
{UU 
DataGridViewRowWW 
rowWW  #
=WW$ %
visitsDataGridWW& 4
.WW4 5
SelectedRowsWW5 A
[WWA B
$numWWB C
]WWC D
;WWD E
ShowVisitFormXX 
(XX 
rowXX !
)XX! "
;XX" #
}YY 
elseZZ 
ifZZ 
(ZZ 
visitsDataGridZZ "
.ZZ" #
SelectedCellsZZ# 0
.ZZ0 1
CountZZ1 6
>ZZ7 8
$numZZ9 :
)ZZ: ;
{[[ 
DataGridViewRow\\ 
row\\  #
=\\$ %
visitsDataGrid\\& 4
.\\4 5
SelectedCells\\5 B
[\\B C
$num\\C D
]\\D E
.\\E F
	OwningRow\\F O
;\\O P
ShowVisitForm]] 
(]] 
row]] !
)]]! "
;]]" #
}^^ 
else__ 
MessagesHandler`` 
.``  
ShowMessage``  +
(``+ ,
$str``, E
)``E F
;``F G
}aa 	
privatedd 
voiddd  
VisitForm_FormCloseddd )
(dd) *
objectdd* 0
senderdd1 7
,dd7 8
FormClosedEventArgsdd9 L
eddM N
)ddN O
{ee 	
visitsDataGridgg 
.gg 

DataSourcegg %
=gg& '
VisitsHandlergg( 5
.gg5 6
FillDatagg6 >
(gg> ?
MainFormgg? G
.ggG H
currentUserggH S
,ggS T
dtggU W
)ggW X
;ggX Y
}hh 	
}ii 
}jj ö%
ED:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\DoctorInfoForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public		 

partial		 
class		 
DoctorInfoForm		 '
:		( )
Form		* .
{

 
private 
Doctor 

InfoDoctor !
;! "
public 
DoctorInfoForm 
( 
Doctor $
doctor% +
)+ ,
{ 	
InitializeComponent 
(  
)  !
;! "

InfoDoctor 
= 
doctor 
;  
} 	
private 
void 
DoctorInfoForm_Load (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{ 	
InitializeLabels 
( 
) 
; 
if 
( 
MainForm 
. 
CurAdmin !
!=" $
null% )
)) *
{ 
addVisitButton 
. 
Enabled &
=' (
false) .
;. /
feedbackButton 
. 
Text #
=$ %
$str& 6
;6 7
feedbackButton 
. 
Click $
+=% '
ShowFeedbacks_Click( ;
;; <
} 
else 
if 
( 
MainForm 
. 

CurPatient (
!=) +
null, 0
)0 1
{ 
feedbackButton 
. 
Text #
=$ %
$str& 6
;6 7
feedbackButton 
. 
Click $
+=% '
AddFeedback_Click( 9
;9 :
}   
}"" 	
private%% 
void%% 
InitializeLabels%% %
(%%% &
)%%& '
{&& 	
try'' 
{(( 
	nameLabel)) 
.)) 
Text)) 
=))  
$str))! (
+))) *

InfoDoctor))+ 5
.))5 6
User))6 :
.)): ;
Name)); ?
;))? @

emailLabel** 
.** 
Text** 
=**  !
$str**" +
+**, -

InfoDoctor**. 8
.**8 9
User**9 =
.**= >
Email**> C
;**C D
specialtyLabel++ 
.++ 
Text++ #
=++$ %
$str++& 7
+++8 9

InfoDoctor++: D
.++D E
	Specialty++E N
.++N O
Name++O S
;++S T
},, 
catch-- 
(-- 
	Exception-- 
ex-- 
)--  
{.. 
Logger// 
.// 
WriteLog// 
(//  
ex//  "
)//" #
;//# $
ErrorHandler00 
.00 
	ShowError00 &
(00& '
$str00' K
)00K L
;00L M
Close11 
(11 
)11 
;11 
}22 
}33 	
private66 
void66  
addVisitButton_Click66 )
(66) *
object66* 0
sender661 7
,667 8
	EventArgs669 B
e66C D
)66D E
{77 	
AddVisitForm88 
addVisitForm88 %
=88& '
new88( +
AddVisitForm88, 8
(888 9

InfoDoctor889 C
)88C D
;88D E
addVisitForm99 
.99 
Show99 
(99 
)99 
;99  
}:: 	
private== 
void== 
AddFeedback_Click== &
(==& '
object==' -
sender==. 4
,==4 5
	EventArgs==6 ?
e==@ A
)==A B
{>> 	
AddFeedbackForm?? 
addFeedbackForm?? +
=??, -
new??. 1
AddFeedbackForm??2 A
(??A B

InfoDoctor??B L
,??L M
MainForm??N V
.??V W

CurPatient??W a
)??a b
;??b c
addFeedbackForm@@ 
.@@ 
Show@@  
(@@  !
)@@! "
;@@" #
}AA 	
privateDD 
voidDD 
ShowFeedbacks_ClickDD (
(DD( )
objectDD) /
senderDD0 6
,DD6 7
	EventArgsDD8 A
eDDB C
)DDC D
{EE 	
FeedbackListFormFF 
feedbackListFormFF -
=FF. /
newFF0 3
FeedbackListFormFF4 D
(FFD E

InfoDoctorFFE O
)FFO P
;FFP Q
feedbackListFormGG 
.GG 
ShowGG !
(GG! "
)GG" #
;GG# $
}HH 	
}II 
}JJ «
FD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\PatientInfoForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 
PatientInfoForm (
:) *
Form+ /
{ 
private		 
Patient		 
InfoPatient		 #
;		# $
public 
PatientInfoForm 
( 
Patient &
patient' .
). /
{ 	
InitializeComponent 
(  
)  !
;! "
InfoPatient 
= 
patient !
;! "
} 	
private 
void  
PatientInfoForm_Load )
() *
object* 0
sender1 7
,7 8
	EventArgs9 B
eC D
)D E
{ 	
InitializeLabels 
( 
) 
; 
} 	
private 
void 
InitializeLabels %
(% &
)& '
{ 	
try 
{ 
	nameLabel 
. 
Text 
=  
$str! (
+) *
InfoPatient+ 6
.6 7
User7 ;
.; <
Name< @
;@ A
omsLabel 
. 
Text 
= 
$str  '
+( )
InfoPatient* 5
.5 6
OMS6 9
;9 :

phoneLabel 
. 
Text 
=  !
$str" -
+. /
InfoPatient0 ;
.; <
Phone< A
;A B
jobPlaceLabel 
. 
Text "
=# $
$str% ;
+< =
InfoPatient> I
.I J
JobPlaceJ R
;R S
addressLabel 
. 
Text !
=" #
$str$ .
+/ 0
InfoPatient1 <
.< =
Address= D
;D E
birthdateLabel 
. 
Text #
=$ %
$str& 7
+8 9
InfoPatient: E
.E F
	BirthDateF O
;O P
if!! 
(!! 
InfoPatient!! 
.!!  
Gender!!  &
==!!' )
$str!!* -
)!!- .
genderLabel"" 
.""  
Text""  $
=""% &
$str""' 5
;""5 6
else## 
genderLabel$$ 
.$$  
Text$$  $
=$$% &
$str$$' 5
;$$5 6
}%% 
catch&& 
(&& 
	Exception&& 
ex&& 
)&&  
{'' 
Logger(( 
.(( 
WriteLog(( 
(((  
ex((  "
)((" #
;((# $
ErrorHandler)) 
.)) 
	ShowError)) &
())& '
$str))' R
)))R S
;))S T
Close** 
(** 
)** 
;** 
}++ 
},, 	
}-- 
}.. Ô
CD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\UserInfoForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
UserInfoForm %
:& '
Form( ,
{ 
private		 
User		 
InfoUser		 
;		 
public 
UserInfoForm 
( 
User  
user! %
)% &
{ 	
InitializeComponent 
(  
)  !
;! "
InfoUser 
= 
user 
; 
} 	
private 
void 
UserInfoForm_Load &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
try 
{ 
InitializeLabels  
(  !
)! "
;" #
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' J
)J K
;K L
Close 
( 
) 
; 
} 
} 	
private 
void 
InitializeLabels %
(% &
)& '
{   	
	nameLabel!! 
.!! 
Text!! 
=!! 
$str!! $
+!!% &
InfoUser!!' /
.!!/ 0
Name!!0 4
;!!4 5

emailLabel"" 
."" 
Text"" 
="" 
$str"" '
+""( )
InfoUser""* 2
.""2 3
Email""3 8
;""8 9

loginLabel## 
.## 
Text## 
=## 
$str## '
+##( )
InfoUser##* 2
.##2 3
Login##3 8
;##8 9
if$$ 
($$ 
InfoUser$$ 
.$$ 
Doctors$$  
.$$  !
Count$$! &
>$$' (
$num$$) *
)$$* +
	typeLabel%% 
.%% 
Text%% 
=%%  
$str%%! .
;%%. /
else&& 
if&& 
(&& 
InfoUser&& 
.&& 
Patients&& &
.&&& '
Count&&' ,
>&&- .
$num&&/ 0
)&&0 1
	typeLabel'' 
.'' 
Text'' 
=''  
$str''! /
;''/ 0
else(( 
	typeLabel)) 
.)) 
Text)) 
=))  
$str))! 5
;))5 6
}** 	
private-- 
void-- 
editButton_Click-- %
(--% &
object--& ,
sender--- 3
,--3 4
	EventArgs--5 >
e--? @
)--@ A
{.. 	
EditUserForm// 
editUserForm// %
=//& '
new//( +
EditUserForm//, 8
(//8 9
InfoUser//9 A
)//A B
;//B C
editUserForm00 
.00 

FormClosed00 #
+=00$ &#
EditUserForm_FormClosed00' >
;00> ?
editUserForm11 
.11 
Show11 
(11 
)11 
;11  
}22 	
private44 
void44 #
EditUserForm_FormClosed44 ,
(44, -
object44- 3
sender444 :
,44: ;
FormClosedEventArgs44< O
e44P Q
)44Q R
{55 	
InitializeLabels66 
(66 
)66 
;66 
}77 	
}88 
}99 µ
DD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Profiles\AdminForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 
	AdminForm "
:# $
Form% )
{		 
public

 
	AdminForm

 
(

 
)

 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
InitializeLabels %
(% &
)& '
{ 	
try 
{ 
	nameLabel 
. 
Text 
=  
$str! (
+) *
MainForm+ 3
.3 4
CurAdmin4 <
.< =
User= A
.A B
NameB F
;F G

emailLabel 
. 
Text 
=  !
$str" +
+, -
MainForm. 6
.6 7
CurAdmin7 ?
.? @
User@ D
.D E
EmailE J
;J K
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' E
)E F
;F G
Close 
( 
) 
; 
} 
} 	
private 
void 
visitsButton_Click '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
VisitsListForm   

visitsForm   %
=  & '
new  ( +
VisitsListForm  , :
(  : ;
)  ; <
;  < =

visitsForm!! 
.!! 
Show!! 
(!! 
)!! 
;!! 
}"" 	
private$$ 
void$$ !
usersListButton_Click$$ *
($$* +
object$$+ 1
sender$$2 8
,$$8 9
	EventArgs$$: C
e$$D E
)$$E F
{%% 	
UsersListForm&& 
usersListForm&& '
=&&( )
new&&* -
UsersListForm&&. ;
(&&; <
)&&< =
;&&= >
usersListForm'' 
.'' 
Show'' 
('' 
)''  
;''  !
}(( 	
private** 
void** 
AdminForm_Load** #
(**# $
object**$ *
sender**+ 1
,**1 2
	EventArgs**3 <
e**= >
)**> ?
{++ 	
InitializeLabels,, 
(,, 
),, 
;,, 
}-- 	
}.. 
}// Ð
ED:\git\PolyclinicSystem\PolyclinicSystem\Forms\Profiles\DoctorForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 

DoctorForm #
:$ %
Form& *
{ 
public		 

DoctorForm		 
(		 
)		 
{

 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
DoctorForm_Load $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
InitializeLabels 
( 
) 
; 
} 	
private 
void 
InitializeLabels %
(% &
)& '
{ 	
try 
{ 
	nameLabel 
. 
Text 
=  
$str! (
+) *
MainForm+ 3
.3 4
	CurDoctor4 =
.= >
User> B
.B C
NameC G
;G H

emailLabel 
. 
Text 
=  !
$str" +
+, -
MainForm. 6
.6 7
	CurDoctor7 @
.@ A
UserA E
.E F
EmailF K
;K L
specialtyLabel 
. 
Text #
=$ %
$str& 7
+8 9
MainForm: B
.B C
	CurDoctorC L
.L M
	SpecialtyM V
.V W
NameW [
;[ \
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' E
)E F
;F G
Close   
(   
)   
;   
}!! 
}"" 	
private%% 
void%% 
visitsButton_Click%% '
(%%' (
object%%( .
sender%%/ 5
,%%5 6
	EventArgs%%7 @
e%%A B
)%%B C
{&& 	
VisitsListForm'' 

visitsForm'' %
=''& '
new''( +
VisitsListForm'', :
('': ;
)''; <
;''< =

visitsForm(( 
.(( 
Show(( 
((( 
)(( 
;(( 
})) 	
}** 
}++ „
JD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Profiles\EditPatientForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 
EditPatientForm (
:) *
Form+ /
{ 
public 
EditPatientForm 
( 
)  
{		 	
InitializeComponent

 
(

  
)

  !
;

! "
} 	
private 
void  
EditPatientForm_Load )
() *
object* 0
sender1 7
,7 8
	EventArgs9 B
eC D
)D E
{ 	
try 
{ 

omsTextBox 
. 
Text 
=  !
MainForm" *
.* +

CurPatient+ 5
.5 6
OMS6 9
;9 :
addressTextBox 
. 
Text #
=$ %
MainForm& .
.. /

CurPatient/ 9
.9 :
Address: A
;A B
jobPlaceTextBox 
.  
Text  $
=% &
MainForm' /
./ 0

CurPatient0 :
.: ;
JobPlace; C
;C D
phoneTextBox 
. 
Text !
=" #
MainForm$ ,
., -

CurPatient- 7
.7 8
Phone8 =
;= >
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' Q
)Q R
;R S
Close 
( 
) 
; 
} 
} 	
private   
void   
confirmButton_Click   (
(  ( )
object  ) /
sender  0 6
,  6 7
	EventArgs  8 A
e  B C
)  C D
{!! 	
string## 
oms## 
=## 

omsTextBox## #
.### $
Text##$ (
;##( )
string$$ 
address$$ 
=$$ 
addressTextBox$$ +
.$$+ ,
Text$$, 0
;$$0 1
string%% 
jobPlace%% 
=%% 
jobPlaceTextBox%% -
.%%- .
Text%%. 2
;%%2 3
string&& 
phone&& 
=&& 
phoneTextBox&& '
.&&' (
Text&&( ,
;&&, -
try(( 
{)) 
bool** 
result** 
=** 
ProfilesHandler** -
.**- .
EditPatient**. 9
(**9 :
MainForm**: B
.**B C

CurPatient**C M
,**M N
oms**O R
,**R S
jobPlace**T \
,**\ ]
phone**^ c
,**c d
address**e l
)**l m
;**m n
if++ 
(++ 
result++ 
)++ 
{,, 
MessagesHandler-- #
.--# $
ShowMessage--$ /
(--/ 0
$str--0 E
)--E F
;--F G
Close.. 
(.. 
).. 
;.. 
}// 
}00 
catch11 
(11 
	Exception11 
ex11 
)11  
{22 
Logger33 
.33 
WriteLog33 
(33  
ex33  "
)33" #
;33# $
ErrorHandler44 
.44 
	ShowError44 &
(44& '
$str44' G
)44G H
;44H I
Close55 
(55 
)55 
;55 
}66 
}77 	
}88 
}99 Ø'
FD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Profiles\PatientForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 
PatientForm $
:% &
Form' +
{		 
public

 
PatientForm

 
(

 
)

 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
visitsButton_Click '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
VisitsListForm 

visitsForm %
=& '
new( +
VisitsListForm, :
(: ;
); <
;< =

visitsForm 
. 
Show 
( 
) 
; 
} 	
private 
void 
InitializeLabels %
(% &
)& '
{ 	
try 
{ 
	nameLabel 
. 
Text 
=  
$str! (
+) *
MainForm+ 3
.3 4

CurPatient4 >
.> ?
User? C
.C D
NameD H
;H I
omsLabel 
. 
Text 
= 
$str  '
+( )
MainForm* 2
.2 3

CurPatient3 =
.= >
OMS> A
;A B

phoneLabel 
. 
Text 
=  !
$str" -
+. /
MainForm0 8
.8 9

CurPatient9 C
.C D
PhoneD I
;I J
jobPlaceLabel 
. 
Text "
=# $
$str% ;
+< =
MainForm> F
.F G

CurPatientG Q
.Q R
JobPlaceR Z
;Z [
addressLabel 
. 
Text !
=" #
$str$ .
+/ 0
MainForm1 9
.9 :

CurPatient: D
.D E
AddressE L
;L M
birthdateLabel 
. 
Text #
=$ %
$str& 7
+8 9
MainForm: B
.B C

CurPatientC M
.M N
	BirthDateN W
;W X
if   
(   
MainForm   
.   

CurPatient   '
.  ' (
Gender  ( .
==  / 1
$str  2 5
)  5 6
genderLabel!! 
.!!  
Text!!  $
=!!% &
$str!!' 5
;!!5 6
else"" 
genderLabel## 
.##  
Text##  $
=##% &
$str##' 5
;##5 6
}$$ 
catch%% 
(%% 
	Exception%% 
ex%% 
)%%  
{&& 
Logger'' 
.'' 
WriteLog'' 
(''  
ex''  "
)''" #
;''# $
ErrorHandler(( 
.(( 
	ShowError(( &
(((& '
$str((' R
)((R S
;((S T
Close)) 
()) 
))) 
;)) 
}** 
}++ 	
private-- 
void-- 
PatientForm_Load-- %
(--% &
object--& ,
sender--- 3
,--3 4
	EventArgs--5 >
e--? @
)--@ A
{.. 	
InitializeLabels00 
(00 
)00 
;00 
}11 	
private44 
void44 #
editProfileButton_Click44 ,
(44, -
object44- 3
sender444 :
,44: ;
	EventArgs44< E
e44F G
)44G H
{55 	
EditPatientForm66 
editPatientForm66 +
=66, -
new66. 1
EditPatientForm662 A
(66A B
)66B C
;66C D
editPatientForm77 
.77 

FormClosed77 &
+=77' )&
EditPatientForm_FormClosed77* D
;77D E
editPatientForm88 
.88 
Show88  
(88  !
)88! "
;88" #
}99 	
private<< 
void<< &
EditPatientForm_FormClosed<< /
(<</ 0
object<<0 6
sender<<7 =
,<<= >
	EventArgs<<? H
e<<I J
)<<J K
{== 	
InitializeLabels>> 
(>> 
)>> 
;>> 
}?? 	
privateAA 
voidAA 
doctorsButton_ClickAA (
(AA( )
objectAA) /
senderAA0 6
,AA6 7
	EventArgsAA8 A
eAAB C
)AAC D
{BB 	
DoctorsListFormCC 
doctorsListFormCC +
=CC, -
newCC. 1
DoctorsListFormCC2 A
(CCA B
)CCB C
;CCC D
doctorsListFormDD 
.DD 
ShowDD  
(DD  !
)DD! "
;DD" #
}EE 	
}FF 
}GG Ë
JD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Authorization\SignUpForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 

SignUpForm #
:$ %
Form& *
{ 
public		 

SignUpForm		 
(		 
)		 
{

 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
SignUpForm_Load $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
birthdateTimePicker 
.  
MaxDate  '
=( )
DateTime* 2
.2 3
Today3 8
;8 9
} 	
static 
public 
Patient 
registeredPatient /
{0 1
get2 5
;5 6
set7 :
;: ;
}< =
private 
void 
signUpButton_Click '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
string 
gender 
= 
$str 
; 
if 
( 
maleRadioButton 
.  
Checked  '
)' (
gender 
= 
$str 
; 
else 
if 
( 
femaleRadioButton &
.& '
Checked' .
). /
gender 
= 
$str 
; 
else   
gender!! 
=!! 
null!! 
;!! 
string$$ 
	birthdate$$ 
=$$ 
birthdateTimePicker$$ 2
.$$2 3
Value$$3 8
.$$8 9
ToString$$9 A
($$A B
$str$$B N
)$$N O
;$$O P
Patient'' 
patient'' 
='' 
Authorization'' +
.''+ ,
SignUp'', 2
(''2 3
loginTextBox''3 ?
.''? @
Text''@ D
,''D E
emailTextBox''F R
.''R S
Text''S W
,''W X

fioTextBox(( 
.(( 
Text(( 
,((  
passwordTextBox((! 0
.((0 1
Text((1 5
,((5 6

omsTextBox((7 A
.((A B
Text((B F
,((F G
phoneTextBox((H T
.((T U
Text((U Y
,((Y Z
addressTextBox)) 
.)) 
Text)) #
,))# $
gender))% +
,))+ ,
	birthdate))- 6
)))6 7
;))7 8
if,, 
(,, 
patient,, 
!=,, 
null,, 
),,  
{-- 
MessagesHandler// 
.//  
ShowMessage//  +
(//+ ,
$str//, H
)//H I
;//I J
Close11 
(11 
)11 
;11 
}22 
}33 	
}55 
}66 ¡
RD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Authorization\ForgotPasswordForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 
ForgotPasswordForm +
:, -
Form. 2
{ 
public 
ForgotPasswordForm !
(! "
)" #
{		 	
InitializeComponent

 
(

  
)

  !
;

! "
} 	
private 
void &
changePasswordButton_Click /
(/ 0
object0 6
sender7 =
,= >
	EventArgs? H
eI J
)J K
{ 	
string 
attempt 
= 
Authorization *
.* +
ChangePassword+ 9
(9 :
loginTextBox: F
.F G
TextG K
,K L
emailTextBoxM Y
.Y Z
TextZ ^
,^ _
passwordTextBox` o
.o p
Textp t
,t u
repeatPasswTextBox	v ˆ
.
ˆ ‰
Text
‰ 
)
 Ž
;
Ž 
if 
( 
attempt 
== 
$str +
)+ ,
{ 
MessagesHandler 
.  
ShowMessage  +
(+ ,
$str, D
)D E
;E F
Close 
( 
) 
; 
} 
} 	
} 
} €}
GD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\Authorization.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
Authorization %
{ 
static		 
public		 
User		 
SignIn		 !
(		! "
string		" (
login		) .
,		. /
string		0 6
password		7 ?
)		? @
{

 	
try 
{ 
if 
( 
IsEmpty 
( 
login !
)! "
)" #
ErrorHandler  
.  !
	ShowError! *
(* +
$str+ <
)< =
;= >
else 
if 
( 
IsEmpty  
(  !
password! )
)) *
)* +
ErrorHandler  
.  !
	ShowError! *
(* +
$str+ =
)= >
;> ?
else 
{ 
User 
user 
= 
DataHandler  +
.+ ,
GetUser, 3
(3 4
login4 9
)9 :
;: ;
if 
( 
user 
== 
null  $
)$ %
ErrorHandler $
.$ %
	ShowError% .
(. /
$str/ [
)[ \
;\ ]
else 
if 
( 
password %
!=& (
user) -
.- .
Password. 6
)6 7
ErrorHandler $
.$ %
	ShowError% .
(. /
$str/ G
)G H
;H I
else 
return 
user  $
;$ %
} 
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger   
.   
WriteLog   
(    
ex    "
)  " #
;  # $
return!! 
null!! 
;!! 
}"" 
return$$ 
null$$ 
;$$ 
}%% 	
static(( 
public(( 
string(( 
ChangePassword(( +
(((+ ,
string((, 2
login((3 8
,((8 9
string((: @
email((A F
,((F G
string((H N
password((O W
,((W X
string((Y _
rptPassword((` k
)((k l
{)) 	
try** 
{++ 
if-- 
(-- 
IsEmpty-- 
(-- 
login-- !
)--! "
)--" #
ErrorHandler..  
...  !
	ShowError..! *
(..* +
$str..+ <
)..< =
;..= >
else// 
if// 
(// 
IsEmpty//  
(//  !
email//! &
)//& '
)//' (
ErrorHandler00  
.00  !
	ShowError00! *
(00* +
$str00+ I
)00I J
;00J K
else11 
if11 
(11 
IsEmpty11  
(11  !
password11! )
)11) *
)11* +
ErrorHandler22  
.22  !
	ShowError22! *
(22* +
$str22+ =
)22= >
;22> ?
else33 
if33 
(33 
password33 !
!=33" $
rptPassword33% 0
)330 1
ErrorHandler44  
.44  !
	ShowError44! *
(44* +
$str44+ @
)44@ A
;44A B
else55 
{66 
User88 
user88 
=88 
DataHandler88  +
.88+ ,
GetUser88, 3
(883 4
login884 9
)889 :
;88: ;
if99 
(99 
user99 
==99 
null99  $
)99$ %
ErrorHandler:: $
.::$ %
	ShowError::% .
(::. /
$str::/ [
)::[ \
;::\ ]
else<< 
if<< 
(<< 
email<< "
!=<<# %
user<<& *
.<<* +
Email<<+ 0
)<<0 1
ErrorHandler== $
.==$ %
	ShowError==% .
(==. /
$str==/ R
)==R S
;==S T
else?? 
{@@ 
userBB 
.BB 
ChangePasswordBB +
(BB+ ,
passwordBB, 4
)BB4 5
;BB5 6
DataHandlerDD #
.DD# $
UpdateInDatabaseDD$ 4
(DD4 5
userDD5 9
)DD9 :
;DD: ;
returnFF 
$strFF /
;FF/ 0
}GG 
}HH 
}II 
catchJJ 
(JJ 
	ExceptionJJ 
exJJ 
)JJ  
{KK 
LoggerLL 
.LL 
WriteLogLL 
(LL  
exLL  "
)LL" #
;LL# $
returnMM 
$strMM 
;MM  
}NN 
returnPP 
$strPP 
;PP 
}QQ 	
staticTT 
publicTT 
PatientTT 
SignUpTT $
(TT$ %
stringTT% +
loginTT, 1
,TT1 2
stringTT3 9
emailTT: ?
,TT? @
stringTTA G
fioTTH K
,TTK L
stringTTM S
passwordTTT \
,TT\ ]
stringUU 
omsUU 
,UU 
stringUU 
phoneUU $
,UU$ %
stringUU& ,
addressUU- 4
,UU4 5
stringUU6 <
genderUU= C
,UUC D
stringUUE K
	birthdateUUL U
)UUU V
{VV 	
tryWW 
{XX 
ifZZ 
(ZZ 
IsEmptyZZ 
(ZZ 
loginZZ !
)ZZ! "
)ZZ" #
ErrorHandler[[  
.[[  !
	ShowError[[! *
([[* +
$str[[+ <
)[[< =
;[[= >
else\\ 
if\\ 
(\\ 
IsEmpty\\  
(\\  !
password\\! )
)\\) *
)\\* +
ErrorHandler]]  
.]]  !
	ShowError]]! *
(]]* +
$str]]+ =
)]]= >
;]]> ?
else^^ 
if^^ 
(^^ 
IsEmpty^^  
(^^  !
email^^! &
)^^& '
)^^' (
ErrorHandler__  
.__  !
	ShowError__! *
(__* +
$str__+ I
)__I J
;__J K
else`` 
if`` 
(`` 
IsEmpty``  
(``  !
fio``! $
)``$ %
)``% &
ErrorHandleraa  
.aa  !
	ShowErroraa! *
(aa* +
$straa+ ;
)aa; <
;aa< =
elsebb 
ifbb 
(bb 
IsEmptybb  
(bb  !
omsbb! $
)bb$ %
)bb% &
ErrorHandlercc  
.cc  !
	ShowErrorcc! *
(cc* +
$strcc+ :
)cc: ;
;cc; <
elsedd 
ifdd 
(dd 
IsEmptydd  
(dd  !
phonedd! &
)dd& '
)dd' (
ErrorHandleree  
.ee  !
	ShowErroree! *
(ee* +
$stree+ E
)eeE F
;eeF G
elseff 
ifff 
(ff 
IsEmptyff  
(ff  !
addressff! (
)ff( )
)ff) *
ErrorHandlergg  
.gg  !
	ShowErrorgg! *
(gg* +
$strgg+ <
)gg< =
;gg= >
elsehh 
ifhh 
(hh 
IsEmptyhh  
(hh  !
genderhh! '
)hh' (
)hh( )
ErrorHandlerii  
.ii  !
	ShowErrorii! *
(ii* +
$strii+ :
)ii: ;
;ii; <
elsejj 
ifjj 
(jj 
IsEmptyjj  
(jj  !
	birthdatejj! *
)jj* +
)jj+ ,
ErrorHandlerkk  
.kk  !
	ShowErrorkk! *
(kk* +
$strkk+ E
)kkE F
;kkF G
elsell 
{mm 
ifoo 
(oo 
!oo 
	Validatoroo "
.oo" #

CheckEmailoo# -
(oo- .
emailoo. 3
)oo3 4
)oo4 5
ErrorHandlerpp $
.pp$ %
	ShowErrorpp% .
(pp. /
$strpp/ R
)ppR S
;ppS T
elseqq 
ifqq 
(qq 
!qq 
	Validatorqq '
.qq' (
CheckOMSqq( 0
(qq0 1
omsqq1 4
)qq4 5
)qq5 6
ErrorHandlerrr $
.rr$ %
	ShowErrorrr% .
(rr. /
$strrr/ D
)rrD E
;rrE F
elsess 
ifss 
(ss 
!ss 
	Validatorss '
.ss' (

CheckPhoness( 2
(ss2 3
phoness3 8
)ss8 9
)ss9 :
ErrorHandlertt $
.tt$ %
	ShowErrortt% .
(tt. /
$strtt/ P
)ttP Q
;ttQ R
elsevv 
{ww 
ifxx 
(xx 
DataHandlerxx '
.xx' (

GetPatientxx( 2
(xx2 3
loginxx3 8
)xx8 9
!=xx: <
nullxx= A
)xxA B
ErrorHandleryy (
.yy( )
	ShowErroryy) 2
(yy2 3
$stryy3 N
)yyN O
;yyO P
else{{ 
{|| 
DataHandler~~ '
.~~' (

AddPatient~~( 2
(~~2 3
login~~3 8
,~~8 9
fio~~: =
,~~= >
email~~? D
,~~D E
password~~F N
,~~N O
gender~~P V
,~~V W
oms~~X [
,~~[ \
null~~] a
,~~a b
	birthdate~~c l
,~~l m
address~~n u
,~~u v
phone~~w |
)~~| }
;~~} ~
string
€€ "

cardNumber
€€# -
=
€€. / 
GenerateCardNumber
€€0 B
(
€€B C
)
€€C D
;
€€D E
DataHandler
 '
.
' (
AddPatientCard
( 6
(
6 7
login
7 <
,
< =

cardNumber
> H
)
H I
;
I J
return
ƒƒ "
DataHandler
ƒƒ# .
.
ƒƒ. /

GetPatient
ƒƒ/ 9
(
ƒƒ9 :
login
ƒƒ: ?
)
ƒƒ? @
;
ƒƒ@ A
}
„„ 
}
…… 
}
†† 
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
Logger
‹‹ 
.
‹‹ 
WriteLog
‹‹ 
(
‹‹  
ex
‹‹  "
)
‹‹" #
;
‹‹# $
return
ŒŒ 
null
ŒŒ 
;
ŒŒ 
}
 
return
 
null
 
;
 
}
 	
static
““ 
private
““ 
string
““  
GenerateCardNumber
““ 0
(
““0 1
)
““1 2
{
”” 	
Random
•• 
rnd
•• 
=
•• 
new
•• 
Random
•• #
(
••# $
)
••$ %
;
••% &
string
–– 
number
–– 
=
–– 
rnd
–– 
.
––  
Next
––  $
(
––$ %
$num
––% '
)
––' (
.
––( )
ToString
––) 1
(
––1 2
)
––2 3
+
––4 5
rnd
––6 9
.
––9 :
Next
––: >
(
––> ?
$num
––? A
)
––A B
.
––B C
ToString
––C K
(
––K L
)
––L M
+
——4 5
rnd
——6 9
.
——9 :
Next
——: >
(
——> ?
$num
——? A
)
——A B
.
——B C
ToString
——C K
(
——K L
)
——L M
+
——N O
rnd
——P S
.
——S T
Next
——T X
(
——X Y
$num
——Y [
)
——[ \
.
——\ ]
ToString
——] e
(
——e f
)
——f g
+
˜˜4 5
rnd
˜˜6 9
.
˜˜9 :
Next
˜˜: >
(
˜˜> ?
$num
˜˜? A
)
˜˜A B
.
˜˜B C
ToString
˜˜C K
(
˜˜K L
)
˜˜L M
;
˜˜M N
return
™™ 
number
™™ 
;
™™ 
}
šš 	
static
 
public
 
string
 

DefineUser
 '
(
' (
User
( ,
user
- 1
)
1 2
{
žž 	
if
ŸŸ 
(
ŸŸ 
user
ŸŸ 
.
ŸŸ 
Doctors
ŸŸ 
.
ŸŸ 
Count
ŸŸ "
>
ŸŸ# $
$num
ŸŸ% &
)
ŸŸ& '
return
   
$str
   
;
    
else
¡¡ 
if
¡¡ 
(
¡¡ 
user
¡¡ 
.
¡¡ 
Patients
¡¡ "
.
¡¡" #
Count
¡¡# (
>
¡¡) *
$num
¡¡+ ,
)
¡¡, -
return
¢¢ 
$str
¢¢  
;
¢¢  !
else
££ 
return
££ 
$str
££ 
;
££  
}
¤¤ 	
static
§§ 
public
§§ 
void
§§ 
SetUser
§§ "
(
§§" #
User
§§# '
user
§§( ,
,
§§, -
string
§§. 4
usertype
§§5 =
)
§§= >
{
¨¨ 	
try
©© 
{
ªª 
if
«« 
(
«« 
usertype
«« 
==
«« 
$str
««  (
)
««( )
MainForm
¬¬ 
.
¬¬ 
	CurDoctor
¬¬ &
=
¬¬' (
DataHandler
¬¬) 4
.
¬¬4 5
	GetDoctor
¬¬5 >
(
¬¬> ?
user
¬¬? C
.
¬¬C D
Login
¬¬D I
)
¬¬I J
;
¬¬J K
else
­­ 
if
­­ 
(
­­ 
usertype
­­ !
==
­­" $
$str
­­% .
)
­­. /
MainForm
®® 
.
®® 

CurPatient
®® '
=
®®( )
DataHandler
®®* 5
.
®®5 6

GetPatient
®®6 @
(
®®@ A
user
®®A E
.
®®E F
Login
®®F K
)
®®K L
;
®®L M
else
¯¯ 
MainForm
°° 
.
°° 
CurAdmin
°° %
=
°°& '
DataHandler
°°( 3
.
°°3 4
GetAdmin
°°4 <
(
°°< =
user
°°= A
.
°°A B
Login
°°B G
)
°°G H
;
°°H I
MainForm
±± 
.
±± 
currentUser
±± $
=
±±% &
usertype
±±' /
;
±±/ 0
}
²² 
catch
³³ 
(
³³ 
	Exception
³³ 
ex
³³ 
)
³³  
{
´´ 
Logger
µµ 
.
µµ 
WriteLog
µµ 
(
µµ  
ex
µµ  "
)
µµ" #
;
µµ# $
}
¶¶ 
}
¸¸ 	
static
»» 
public
»» 
void
»» 

LogoutUser
»» %
(
»»% &
)
»»& '
{
¼¼ 	
MainForm
½½ 
.
½½ 
currentUser
½½  
=
½½! "
$str
½½# %
;
½½% &
MainForm
¾¾ 
.
¾¾ 
CurAdmin
¾¾ 
=
¾¾ 
null
¾¾  $
;
¾¾$ %
MainForm
¿¿ 
.
¿¿ 
	CurDoctor
¿¿ 
=
¿¿  
null
¿¿! %
;
¿¿% &
MainForm
ÀÀ 
.
ÀÀ 

CurPatient
ÀÀ 
=
ÀÀ  !
null
ÀÀ" &
;
ÀÀ& '
}
ÁÁ 	
static
ÄÄ 
private
ÄÄ 
bool
ÄÄ 
IsEmpty
ÄÄ #
(
ÄÄ# $
string
ÄÄ$ *
value
ÄÄ+ 0
)
ÄÄ0 1
{
ÅÅ 	
if
ÆÆ 
(
ÆÆ 
(
ÆÆ 
value
ÆÆ 
==
ÆÆ 
$str
ÆÆ 
)
ÆÆ 
||
ÆÆ  
(
ÆÆ! "
value
ÆÆ" '
==
ÆÆ( *
null
ÆÆ+ /
)
ÆÆ/ 0
)
ÆÆ0 1
return
ÇÇ 
true
ÇÇ 
;
ÇÇ 
return
ÈÈ 
false
ÈÈ 
;
ÈÈ 
}
ÉÉ 	
}
ÊÊ 
}ËË ²Œ
ED:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\DataHandler.cs
	namespace 	
PolyclinicSystem
 
{		 
static

 

public

 
class

 
DataHandler

 #
{ 
static 
public 
readonly 
string %
DBFile& ,
=- .
$str/ >
;> ?
static 
public 
bool 
CreateDatabase )
() *
)* +
{ 	
bool 
result 
= 
false 
;  
try 
{ 
using 
( 
SQLiteConnection '
db( *
=+ ,
new- 0
SQLiteConnection1 A
(A B
$strB Q
)Q R
)R S
{ 
db 
. 
CreateTable "
<" #
	Specialty# ,
>, -
(- .
). /
;/ 0
db 
. 
CreateTable "
<" #
User# '
>' (
(( )
)) *
;* +
db 
. 
CreateTable "
<" #
Administrator# 0
>0 1
(1 2
)2 3
;3 4
db 
. 
CreateTable "
<" #
Doctor# )
>) *
(* +
)+ ,
;, -
db 
. 
CreateTable "
<" #
Patient# *
>* +
(+ ,
), -
;- .
db 
. 
CreateTable "
<" #
PatientCard# .
>. /
(/ 0
)0 1
;1 2
db 
. 
CreateTable "
<" #
DoctorVisit# .
>. /
(/ 0
)0 1
;1 2
db 
. 
CreateTable "
<" #
Feedback# +
>+ ,
(, -
)- .
;. /
} 
AddAdministrator    
(    !
$str  ! (
,  ( )
$str  * C
,  C D
$str  E T
,  T U
$str  V ]
,  ] ^
$str  _ l
)  l m
;  m n
AddSpecialty"" 
("" 
$str"" )
)"") *
;""* +
AddSpecialty## 
(## 
$str## %
)##% &
;##& '
AddSpecialty$$ 
($$ 
$str$$ '
)$$' (
;$$( )
AddSpecialty%% 
(%% 
$str%% &
)%%& '
;%%' (
AddSpecialty&& 
(&& 
$str&& &
)&&& '
;&&' (
AddSpecialty'' 
('' 
$str'' *
)''* +
;''+ ,
AddSpecialty(( 
((( 
$str(( (
)((( )
;(() *
AddSpecialty)) 
()) 
$str)) '
)))' (
;))( )
AddSpecialty** 
(** 
$str** '
)**' (
;**( )
result++ 
=++ 
true++ 
;++ 
},, 
catch-- 
(-- 
	Exception-- 
ex-- 
)--  
{.. 
Logger// 
.// 
WriteLog// 
(//  
ex//  "
)//" #
;//# $
ErrorHandler00 
.00 
	ShowError00 &
(00& '
$str00' M
)00M N
;00N O
}11 
return33 
result33 
;33 
}44 	
static66 
private66 
void66 
AddToDatabase66 )
(66) *
object66* 0
obj661 4
)664 5
{77 	
try88 
{99 
using:: 
(:: 
SQLiteConnection:: '
db::( *
=::+ ,
new::- 0
SQLiteConnection::1 A
(::A B
DBFile::B H
)::H I
)::I J
{;; 
db<< 
.<< 
Insert<< 
(<< 
obj<< !
)<<! "
;<<" #
}== 
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
ErrorHandlerAA 
.AA 
	ShowErrorAA &
(AA& '
exAA' )
)AA) *
;AA* +
}BB 
}CC 	
staticEE 
publicEE 
voidEE 
UpdateInDatabaseEE +
(EE+ ,
objectEE, 2
objEE3 6
)EE6 7
{FF 	
tryGG 
{HH 
usingII 
(II 
SQLiteConnectionII '
dbII( *
=II+ ,
newII- 0
SQLiteConnectionII1 A
(IIA B
DBFileIIB H
)IIH I
)III J
{JJ 
dbKK 
.KK 
UpdateWithChildrenKK )
(KK) *
objKK* -
)KK- .
;KK. /
}LL 
}MM 
catchNN 
(NN 
	ExceptionNN 
exNN 
)NN  
{OO 
ErrorHandlerPP 
.PP 
	ShowErrorPP &
(PP& '
exPP' )
)PP) *
;PP* +
}QQ 
}RR 	
staticTT 
publicTT 
voidTT 
AddUserTT "
(TT" #
stringTT# )
loginTT* /
,TT/ 0
stringTT1 7
nameTT8 <
,TT< =
stringTT> D
emailTTE J
,TTJ K
stringTTL R
passwordTTS [
)TT[ \
{UU 	
tryVV 
{WW 
UserXX 
userXX 
=XX 
newXX 
UserXX  $
{YY 
LoginZZ 
=ZZ 
loginZZ !
,ZZ! "
Name[[ 
=[[ 
name[[ 
,[[  
Email\\ 
=\\ 
email\\ !
,\\! "
Password]] 
=]] 
password]] '
}^^ 
;^^ 
AddToDatabase`` 
(`` 
user`` "
)``" #
;``# $
}aa 
catchbb 
(bb 
	Exceptionbb 
exbb 
)bb  
{cc 
ErrorHandlerdd 
.dd 
	ShowErrordd &
(dd& '
exdd' )
)dd) *
;dd* +
}ee 
}ff 	
statichh 
publichh 
voidhh 
AddSpecialtyhh '
(hh' (
stringhh( .
namehh/ 3
)hh3 4
{ii 	
tryjj 
{kk 
	Specialtyll 
	specialtyll #
=ll$ %
newll& )
	Specialtyll* 3
{mm 
Namenn 
=nn 
namenn 
}oo 
;oo 
AddToDatabaseqq 
(qq 
	specialtyqq '
)qq' (
;qq( )
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
ErrorHandleruu 
.uu 
	ShowErroruu &
(uu& '
exuu' )
)uu) *
;uu* +
}vv 
}ww 	
staticyy 
publicyy 
voidyy 
AddAdministratoryy +
(yy+ ,
stringyy, 2
loginyy3 8
,yy8 9
stringyy: @
nameyyA E
,yyE F
stringyyG M
emailyyN S
,yyS T
stringyyU [
passwordyy\ d
,yyd e
stringyyf l
phoneyym r
)yyr s
{zz 	
try{{ 
{|| 
User~~ 
user~~ 
=~~ 
new~~ 
User~~  $
{ 
Login
€€ 
=
€€ 
login
€€ !
,
€€! "
Name
 
=
 
name
 
,
  
Email
‚‚ 
=
‚‚ 
email
‚‚ !
,
‚‚! "
Password
ƒƒ 
=
ƒƒ 
password
ƒƒ '
}
„„ 
;
„„ 
AddToDatabase
…… 
(
…… 
user
…… "
)
……" #
;
……# $
Administrator
ˆˆ 
admin
ˆˆ #
=
ˆˆ$ %
new
ˆˆ& )
Administrator
ˆˆ* 7
{
‰‰ 
Phone
ŠŠ 
=
ŠŠ 
phone
ŠŠ !
}
‹‹ 
;
‹‹ 
AddToDatabase
ŒŒ 
(
ŒŒ 
admin
ŒŒ #
)
ŒŒ# $
;
ŒŒ$ %
user
ŽŽ 
.
ŽŽ 
Administrators
ŽŽ #
=
ŽŽ$ %
new
ŽŽ& )
List
ŽŽ* .
<
ŽŽ. /
Administrator
ŽŽ/ <
>
ŽŽ< =
{
ŽŽ> ?
admin
ŽŽ@ E
}
ŽŽF G
;
ŽŽG H
UpdateInDatabase
  
(
  !
user
! %
)
% &
;
& '
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
ErrorHandler
““ 
.
““ 
	ShowError
““ &
(
““& '
ex
““' )
)
““) *
;
““* +
}
”” 
}
•• 	
static
—— 
public
—— 
void
—— 

AddPatient
—— %
(
——% &
string
——& ,
login
——- 2
,
——2 3
string
——4 :
name
——; ?
,
——? @
string
——A G
email
——H M
,
——M N
string
——O U
password
——V ^
,
——^ _
string
˜˜ 
gender
˜˜ 
,
˜˜ 
string
˜˜ !
oms
˜˜" %
,
˜˜% &
string
˜˜' -
jobplace
˜˜. 6
,
˜˜6 7
string
˜˜8 >
	birthdate
˜˜? H
,
˜˜H I
string
˜˜J P
address
˜˜Q X
,
˜˜X Y
string
˜˜Z `
phone
˜˜a f
)
˜˜f g
{
™™ 	
try
šš 
{
›› 
User
 
user
 
=
 
new
 
User
  $
{
žž 
Login
ŸŸ 
=
ŸŸ 
login
ŸŸ !
,
ŸŸ! "
Name
   
=
   
name
   
,
    
Email
¡¡ 
=
¡¡ 
email
¡¡ !
,
¡¡! "
Password
¢¢ 
=
¢¢ 
password
¢¢ '
}
££ 
;
££ 
AddToDatabase
¤¤ 
(
¤¤ 
user
¤¤ "
)
¤¤" #
;
¤¤# $
Patient
§§ 
patient
§§ 
=
§§  !
new
§§" %
Patient
§§& -
{
¨¨ 
Gender
©© 
=
©© 
gender
©© #
,
©©# $
OMS
ªª 
=
ªª 
oms
ªª 
,
ªª 
JobPlace
«« 
=
«« 
jobplace
«« '
,
««' (
	BirthDate
¬¬ 
=
¬¬ 
	birthdate
¬¬  )
,
¬¬) *
Address
­­ 
=
­­ 
address
­­ %
,
­­% &
Phone
®® 
=
®® 
phone
®® !
}
¯¯ 
;
¯¯ 
AddToDatabase
°° 
(
°° 
patient
°° %
)
°°% &
;
°°& '
user
³³ 
.
³³ 
Patients
³³ 
=
³³ 
new
³³  #
List
³³$ (
<
³³( )
Patient
³³) 0
>
³³0 1
{
³³2 3
patient
³³4 ;
}
³³< =
;
³³= >
UpdateInDatabase
´´  
(
´´  !
user
´´! %
)
´´% &
;
´´& '
}
µµ 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
ex
¶¶ 
)
¶¶  
{
·· 
ErrorHandler
¸¸ 
.
¸¸ 
	ShowError
¸¸ &
(
¸¸& '
ex
¸¸' )
)
¸¸) *
;
¸¸* +
}
¹¹ 
}
ºº 	
static
¼¼ 
public
¼¼ 
void
¼¼ 
	AddDoctor
¼¼ $
(
¼¼$ %
string
¼¼% +
login
¼¼, 1
,
¼¼1 2
string
¼¼3 9
name
¼¼: >
,
¼¼> ?
string
¼¼@ F
email
¼¼G L
,
¼¼L M
string
¼¼N T
password
¼¼U ]
,
¼¼] ^
string
¼¼_ e
	specialty
¼¼f o
)
¼¼o p
{
½½ 	
try
¾¾ 
{
¿¿ 
User
ÁÁ 
user
ÁÁ 
=
ÁÁ 
new
ÁÁ 
User
ÁÁ  $
{
ÂÂ 
Login
ÃÃ 
=
ÃÃ 
login
ÃÃ !
,
ÃÃ! "
Name
ÄÄ 
=
ÄÄ 
name
ÄÄ 
,
ÄÄ  
Email
ÅÅ 
=
ÅÅ 
email
ÅÅ !
,
ÅÅ! "
Password
ÆÆ 
=
ÆÆ 
password
ÆÆ '
}
ÇÇ 
;
ÇÇ 
AddToDatabase
ÈÈ 
(
ÈÈ 
user
ÈÈ "
)
ÈÈ" #
;
ÈÈ# $
Doctor
ËË 
doctor
ËË 
=
ËË 
new
ËË  #
Doctor
ËË$ *
{
ËË+ ,
}
ËË- .
;
ËË. /
AddToDatabase
ÌÌ 
(
ÌÌ 
doctor
ÌÌ $
)
ÌÌ$ %
;
ÌÌ% &
user
ÏÏ 
.
ÏÏ 
Doctors
ÏÏ 
=
ÏÏ 
new
ÏÏ "
List
ÏÏ# '
<
ÏÏ' (
Doctor
ÏÏ( .
>
ÏÏ. /
{
ÏÏ0 1
doctor
ÏÏ2 8
}
ÏÏ9 :
;
ÏÏ: ;
UpdateInDatabase
ÐÐ  
(
ÐÐ  !
user
ÐÐ! %
)
ÐÐ% &
;
ÐÐ& '
	Specialty
ÓÓ 
spec
ÓÓ 
=
ÓÓ  
GetSpecialty
ÓÓ! -
(
ÓÓ- .
	specialty
ÓÓ. 7
)
ÓÓ7 8
;
ÓÓ8 9
if
ÔÔ 
(
ÔÔ 
spec
ÔÔ 
.
ÔÔ 
Doctors
ÔÔ  
.
ÔÔ  !
Count
ÔÔ! &
==
ÔÔ' )
$num
ÔÔ* +
)
ÔÔ+ ,
spec
ÕÕ 
.
ÕÕ 
Doctors
ÕÕ  
=
ÕÕ! "
new
ÕÕ# &
List
ÕÕ' +
<
ÕÕ+ ,
Doctor
ÕÕ, 2
>
ÕÕ2 3
{
ÕÕ4 5
doctor
ÕÕ6 <
}
ÕÕ= >
;
ÕÕ> ?
else
ÖÖ 
spec
×× 
.
×× 
Doctors
××  
.
××  !
Add
××! $
(
××$ %
doctor
××% +
)
××+ ,
;
××, -
UpdateInDatabase
ØØ  
(
ØØ  !
spec
ØØ! %
)
ØØ% &
;
ØØ& '
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ 
{
ÛÛ 
ErrorHandler
ÜÜ 
.
ÜÜ 
	ShowError
ÜÜ &
(
ÜÜ& '
ex
ÜÜ' )
)
ÜÜ) *
;
ÜÜ* +
}
ÝÝ 
}
ÞÞ 	
static
àà 
public
àà 
void
àà 
AddPatientCard
àà )
(
àà) *
string
àà* 0
login
àà1 6
,
àà6 7
string
àà8 >
number
àà? E
)
ààE F
{
áá 	
try
ââ 
{
ãã 
PatientCard
åå 
card
åå  
=
åå! "
new
åå# &
PatientCard
åå' 2
{
åå3 4

CardNumber
ææ 
=
ææ  
number
ææ! '
}
çç 
;
çç 
AddToDatabase
èè 
(
èè 
card
èè "
)
èè" #
;
èè# $
Patient
ëë 
patient
ëë 
=
ëë  !

GetPatient
ëë" ,
(
ëë, -
login
ëë- 2
)
ëë2 3
;
ëë3 4
if
ìì 
(
ìì 
patient
ìì 
.
ìì 
PatientCards
ìì (
.
ìì( )
Count
ìì) .
==
ìì/ 1
$num
ìì2 3
)
ìì3 4
patient
íí 
.
íí 
PatientCards
íí (
=
íí) *
new
íí+ .
List
íí/ 3
<
íí3 4
PatientCard
íí4 ?
>
íí? @
{
ííA B
card
ííC G
}
ííH I
;
ííI J
else
îî 
patient
ïï 
.
ïï 
PatientCards
ïï (
.
ïï( )
Add
ïï) ,
(
ïï, -
card
ïï- 1
)
ïï1 2
;
ïï2 3
UpdateInDatabase
ðð  
(
ðð  !
patient
ðð! (
)
ðð( )
;
ðð) *
}
ññ 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
óó 
ErrorHandler
ôô 
.
ôô 
	ShowError
ôô &
(
ôô& '
ex
ôô' )
)
ôô) *
;
ôô* +
}
õõ 
}
öö 	
static
øø 
public
øø 
void
øø 
AddDoctorVisit
øø )
(
øø) *
string
øø* 0
doctorLogin
øø1 <
,
øø< =
string
øø> D

cardNumber
øøE O
,
øøO P
string
øøQ W
date
øøX \
,
øø\ ]
string
øø^ d
type
øøe i
)
øøi j
{
ùù 	
try
úú 
{
ûû 
DoctorVisit
ýý 
visit
ýý !
=
ýý" #
new
ýý$ '
DoctorVisit
ýý( 3
{
þþ 
Date
ÿÿ 
=
ÿÿ 
date
ÿÿ 
,
ÿÿ  
Status
€€ 
=
€€ 
$str
€€ '
,
€€' (
Type
 
=
 
type
 
}
‚‚ 
;
‚‚ 
AddToDatabase
ƒƒ 
(
ƒƒ 
visit
ƒƒ #
)
ƒƒ# $
;
ƒƒ$ %
PatientCard
†† 
card
††  
=
††! "
GetPatientCard
††# 1
(
††1 2

cardNumber
††2 <
)
††< =
;
††= >
if
‡‡ 
(
‡‡ 
card
‡‡ 
.
‡‡ 
DoctorVisits
‡‡ %
.
‡‡% &
Count
‡‡& +
==
‡‡, .
$num
‡‡/ 0
)
‡‡0 1
card
ˆˆ 
.
ˆˆ 
DoctorVisits
ˆˆ %
=
ˆˆ& '
new
ˆˆ( +
List
ˆˆ, 0
<
ˆˆ0 1
DoctorVisit
ˆˆ1 <
>
ˆˆ< =
{
ˆˆ> ?
visit
ˆˆ@ E
}
ˆˆF G
;
ˆˆG H
else
‰‰ 
card
ŠŠ 
.
ŠŠ 
DoctorVisits
ŠŠ %
.
ŠŠ% &
Add
ŠŠ& )
(
ŠŠ) *
visit
ŠŠ* /
)
ŠŠ/ 0
;
ŠŠ0 1
UpdateInDatabase
‹‹  
(
‹‹  !
card
‹‹! %
)
‹‹% &
;
‹‹& '
Doctor
ŽŽ 
doctor
ŽŽ 
=
ŽŽ 
	GetDoctor
ŽŽ  )
(
ŽŽ) *
doctorLogin
ŽŽ* 5
)
ŽŽ5 6
;
ŽŽ6 7
if
 
(
 
doctor
 
.
 
DoctorVisits
 '
.
' (
Count
( -
==
. 0
$num
1 2
)
2 3
doctor
 
.
 
DoctorVisits
 '
=
( )
new
* -
List
. 2
<
2 3
DoctorVisit
3 >
>
> ?
{
@ A
visit
B G
}
H I
;
I J
else
‘‘ 
doctor
’’ 
.
’’ 
DoctorVisits
’’ '
.
’’' (
Add
’’( +
(
’’+ ,
visit
’’, 1
)
’’1 2
;
’’2 3
UpdateInDatabase
““  
(
““  !
doctor
““! '
)
““' (
;
““( )
}
”” 
catch
•• 
(
•• 
	Exception
•• 
ex
•• 
)
••  
{
–– 
ErrorHandler
—— 
.
—— 
	ShowError
—— &
(
——& '
ex
——' )
)
——) *
;
——* +
}
˜˜ 
}
™™ 	
static
›› 
public
›› 
void
›› 
AddFeedback
›› &
(
››& '
string
››' -
doctorLogin
››. 9
,
››9 :
string
››; A
patientLogin
››B N
,
››N O
int
››P S
rating
››T Z
,
››Z [
string
››\ b
date
››c g
,
››g h
string
››i o
text
››p t
)
››t u
{
œœ 	
try
 
{
žž 
Feedback
   
feedback
   !
=
  " #
new
  $ '
Feedback
  ( 0
{
¡¡ 
Rating
¢¢ 
=
¢¢ 
rating
¢¢ #
,
¢¢# $
Date
££ 
=
££ 
date
££ 
,
££  
Text
¤¤ 
=
¤¤ 
text
¤¤ 
}
¥¥ 
;
¥¥ 
AddToDatabase
¦¦ 
(
¦¦ 
feedback
¦¦ &
)
¦¦& '
;
¦¦' (
Doctor
©© 
doctor
©© 
=
©© 
	GetDoctor
©©  )
(
©©) *
doctorLogin
©©* 5
)
©©5 6
;
©©6 7
if
ªª 
(
ªª 
doctor
ªª 
.
ªª 
	Feedbacks
ªª $
.
ªª$ %
Count
ªª% *
==
ªª+ -
$num
ªª. /
)
ªª/ 0
doctor
«« 
.
«« 
	Feedbacks
«« $
=
««% &
new
««' *
List
««+ /
<
««/ 0
Feedback
««0 8
>
««8 9
{
««: ;
feedback
««< D
}
««E F
;
««F G
else
¬¬ 
doctor
­­ 
.
­­ 
	Feedbacks
­­ $
.
­­$ %
Add
­­% (
(
­­( )
feedback
­­) 1
)
­­1 2
;
­­2 3
UpdateInDatabase
®®  
(
®®  !
doctor
®®! '
)
®®' (
;
®®( )
Patient
±± 
patient
±± 
=
±±  !

GetPatient
±±" ,
(
±±, -
patientLogin
±±- 9
)
±±9 :
;
±±: ;
if
²² 
(
²² 
patient
²² 
.
²² 
	Feedbacks
²² %
.
²²% &
Count
²²& +
==
²², .
$num
²²/ 0
)
²²0 1
patient
³³ 
.
³³ 
	Feedbacks
³³ %
=
³³& '
new
³³( +
List
³³, 0
<
³³0 1
Feedback
³³1 9
>
³³9 :
{
³³; <
feedback
³³= E
}
³³F G
;
³³G H
else
´´ 
patient
µµ 
.
µµ 
	Feedbacks
µµ %
.
µµ% &
Add
µµ& )
(
µµ) *
feedback
µµ* 2
)
µµ2 3
;
µµ3 4
UpdateInDatabase
¶¶  
(
¶¶  !
patient
¶¶! (
)
¶¶( )
;
¶¶) *
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
ex
¸¸ 
)
¸¸  
{
¹¹ 
ErrorHandler
ºº 
.
ºº 
	ShowError
ºº &
(
ºº& '
ex
ºº' )
)
ºº) *
;
ºº* +
}
»» 
}
¼¼ 	
static
¾¾ 
public
¾¾ 
List
¾¾ 
<
¾¾ 
User
¾¾ 
>
¾¾  
GetUsers
¾¾! )
(
¾¾) *
)
¾¾* +
{
¿¿ 	
try
ÀÀ 
{
ÁÁ 
List
ÂÂ 
<
ÂÂ 
User
ÂÂ 
>
ÂÂ 
users
ÂÂ  
;
ÂÂ  !
using
ÄÄ 
(
ÄÄ 
SQLiteConnection
ÄÄ '
db
ÄÄ( *
=
ÄÄ+ ,
new
ÄÄ- 0
SQLiteConnection
ÄÄ1 A
(
ÄÄA B
DBFile
ÄÄB H
)
ÄÄH I
)
ÄÄI J
users
ÅÅ 
=
ÅÅ 
db
ÅÅ 
.
ÅÅ  
GetAllWithChildren
ÅÅ 1
<
ÅÅ1 2
User
ÅÅ2 6
>
ÅÅ6 7
(
ÅÅ7 8
)
ÅÅ8 9
;
ÅÅ9 :
return
ÇÇ 
users
ÇÇ 
;
ÇÇ 
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÊÊ 
Logger
ËË 
.
ËË 
WriteLog
ËË 
(
ËË  
ex
ËË  "
)
ËË" #
;
ËË# $
return
ÌÌ 
null
ÌÌ 
;
ÌÌ 
}
ÍÍ 
}
ÎÎ 	
static
ÐÐ 
public
ÐÐ 
User
ÐÐ 
GetUser
ÐÐ "
(
ÐÐ" #
string
ÐÐ# )
login
ÐÐ* /
)
ÐÐ/ 0
{
ÑÑ 	
try
ÒÒ 
{
ÓÓ 
using
ÔÔ 
(
ÔÔ 
SQLiteConnection
ÔÔ &
db
ÔÔ' )
=
ÔÔ* +
new
ÔÔ, /
SQLiteConnection
ÔÔ0 @
(
ÔÔ@ A
DBFile
ÔÔA G
)
ÔÔG H
)
ÔÔH I
{
ÕÕ 
User
ÖÖ 
user
ÖÖ 
=
ÖÖ 
db
ÖÖ  "
.
ÖÖ" #
Query
ÖÖ# (
<
ÖÖ( )
User
ÖÖ) -
>
ÖÖ- .
(
ÖÖ. /
$str
ÖÖ/ S
,
ÖÖS T
login
ÖÖU Z
)
ÖÖZ [
.
ÖÖ[ \
First
ÖÖ\ a
(
ÖÖa b
)
ÖÖb c
;
ÖÖc d
return
×× 
db
×× 
.
×× 
GetWithChildren
×× -
<
××- .
User
××. 2
>
××2 3
(
××3 4
user
××4 8
.
××8 9
ID
××9 ;
)
××; <
;
××< =
}
ØØ 
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
Logger
ÜÜ 
.
ÜÜ 
WriteLog
ÜÜ 
(
ÜÜ  
ex
ÜÜ  "
)
ÜÜ" #
;
ÜÜ# $
return
ÝÝ 
null
ÝÝ 
;
ÝÝ 
}
ÞÞ 
}
ßß 	
static
áá 
public
áá 
User
áá 
GetUser
áá "
(
áá" #
int
áá# &
ID
áá' )
)
áá) *
{
ââ 	
try
ãã 
{
ää 
using
åå 
(
åå 
SQLiteConnection
åå '
db
åå( *
=
åå+ ,
new
åå- 0
SQLiteConnection
åå1 A
(
ååA B
DBFile
ååB H
)
ååH I
)
ååI J
{
ææ 
return
çç 
db
çç 
.
çç 
GetWithChildren
çç -
<
çç- .
User
çç. 2
>
çç2 3
(
çç3 4
ID
çç4 6
)
çç6 7
;
çç7 8
}
èè 
}
éé 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
Logger
ìì 
.
ìì 
WriteLog
ìì 
(
ìì  
ex
ìì  "
)
ìì" #
;
ìì# $
return
íí 
null
íí 
;
íí 
}
îî 
}
ïï 	
static
ññ 
public
ññ 
	Specialty
ññ 
GetSpecialty
ññ  ,
(
ññ, -
string
ññ- 3
specName
ññ4 <
)
ññ< =
{
òò 	
try
óó 
{
ôô 
using
õõ 
(
õõ 
SQLiteConnection
õõ &
db
õõ' )
=
õõ* +
new
õõ, /
SQLiteConnection
õõ0 @
(
õõ@ A
DBFile
õõA G
)
õõG H
)
õõH I
{
öö 
	Specialty
÷÷ 
spec
÷÷ "
=
÷÷# $
db
÷÷% '
.
÷÷' (
Query
÷÷( -
<
÷÷- .
	Specialty
÷÷. 7
>
÷÷7 8
(
÷÷8 9
$str
÷÷9 a
,
÷÷a b
specName
÷÷c k
)
÷÷k l
.
÷÷l m
First
÷÷m r
(
÷÷r s
)
÷÷s t
;
÷÷t u
return
øø 
db
øø 
.
øø 
GetWithChildren
øø -
<
øø- .
	Specialty
øø. 7
>
øø7 8
(
øø8 9
spec
øø9 =
.
øø= >
ID
øø> @
)
øø@ A
;
øøA B
}
ùù 
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
ErrorHandler
ýý 
.
ýý 
	ShowError
ýý &
(
ýý& '
ex
ýý' )
)
ýý) *
;
ýý* +
return
þþ 
null
þþ 
;
þþ 
}
ÿÿ 
}
€€ 	
static
‚‚ 
public
‚‚ 
List
‚‚ 
<
‚‚ 
	Specialty
‚‚ $
>
‚‚$ %
GetSpecialties
‚‚& 4
(
‚‚4 5
)
‚‚5 6
{
ƒƒ 	
try
„„ 
{
…… 
List
†† 
<
†† 
	Specialty
†† 
>
†† 
specialties
††  +
;
††+ ,
using
ˆˆ 
(
ˆˆ 
SQLiteConnection
ˆˆ '
db
ˆˆ( *
=
ˆˆ+ ,
new
ˆˆ- 0
SQLiteConnection
ˆˆ1 A
(
ˆˆA B
DBFile
ˆˆB H
)
ˆˆH I
)
ˆˆI J
specialties
‰‰ 
=
‰‰  !
db
‰‰" $
.
‰‰$ % 
GetAllWithChildren
‰‰% 7
<
‰‰7 8
	Specialty
‰‰8 A
>
‰‰A B
(
‰‰B C
)
‰‰C D
;
‰‰D E
return
‹‹ 
specialties
‹‹ "
;
‹‹" #
}
ŒŒ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
ŽŽ 
Logger
 
.
 
WriteLog
 
(
  
ex
  "
)
" #
;
# $
return
 
null
 
;
 
}
‘‘ 
}
’’ 	
static
”” 
public
”” 
	Specialty
”” "
GetSpecialtyByDoctor
””  4
(
””4 5
int
””5 8
doctorID
””9 A
)
””A B
{
•• 	
try
–– 
{
—— 
using
˜˜ 
(
˜˜ 
SQLiteConnection
˜˜ &
db
˜˜' )
=
˜˜* +
new
˜˜, /
SQLiteConnection
˜˜0 @
(
˜˜@ A
DBFile
˜˜A G
)
˜˜G H
)
˜˜H I
{
™™ 
Doctor
šš 
doctor
šš !
=
šš" #
db
šš$ &
.
šš& '
Query
šš' ,
<
šš, -
Doctor
šš- 3
>
šš3 4
(
šš4 5
$str
šš5 ^
,
šš^ _
doctorID
šš` h
)
ššh i
.
šši j
First
ššj o
(
ššo p
)
ššp q
;
ššq r
	Specialty
›› 
spec
›› "
=
››# $
db
››% '
.
››' (
Query
››( -
<
››- .
	Specialty
››. 7
>
››7 8
(
››8 9
$str
››9 _
,
››_ `
doctor
››a g
.
››g h
SpecialtyID
››h s
)
››s t
.
››t u
First
››u z
(
››z {
)
››{ |
;
››| }
return
œœ 
spec
œœ 
;
œœ  
}
 
}
žž 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   
ErrorHandler
¡¡ 
.
¡¡ 
	ShowError
¡¡ &
(
¡¡& '
ex
¡¡' )
)
¡¡) *
;
¡¡* +
return
¢¢ 
null
¢¢ 
;
¢¢ 
}
££ 
}
¤¤ 	
static
¦¦ 
public
¦¦ 
Patient
¦¦ 

GetPatient
¦¦ (
(
¦¦( )
string
¦¦) /
login
¦¦0 5
)
¦¦5 6
{
§§ 	
try
¨¨ 
{
©© 
using
ªª 
(
ªª 
SQLiteConnection
ªª &
db
ªª' )
=
ªª* +
new
ªª, /
SQLiteConnection
ªª0 @
(
ªª@ A
DBFile
ªªA G
)
ªªG H
)
ªªH I
{
«« 
User
¬¬ 
user
¬¬ 
=
¬¬ 
db
¬¬  "
.
¬¬" #
Query
¬¬# (
<
¬¬( )
User
¬¬) -
>
¬¬- .
(
¬¬. /
$str
¬¬/ S
,
¬¬S T
login
¬¬U Z
)
¬¬Z [
.
¬¬[ \
First
¬¬\ a
(
¬¬a b
)
¬¬b c
;
¬¬c d
Patient
­­ 
patient
­­ #
=
­­$ %
db
­­& (
.
­­( )
Query
­­) .
<
­­. /
Patient
­­/ 6
>
­­6 7
(
­­7 8
$str
­­8 `
,
­­` a
user
­­b f
.
­­f g
ID
­­g i
)
­­i j
.
­­j k
First
­­k p
(
­­p q
)
­­q r
;
­­r s
return
®® 
db
®® 
.
®® 
GetWithChildren
®® -
<
®®- .
Patient
®®. 5
>
®®5 6
(
®®6 7
patient
®®7 >
.
®®> ?
	PatientID
®®? H
)
®®H I
;
®®I J
}
¯¯ 
}
°° 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
²² 
Logger
³³ 
.
³³ 
WriteLog
³³ 
(
³³  
ex
³³  "
)
³³" #
;
³³# $
return
´´ 
null
´´ 
;
´´ 
}
µµ 
}
¶¶ 	
static
¸¸ 
public
¸¸ 
Patient
¸¸ 

GetPatient
¸¸ (
(
¸¸( )
int
¸¸) ,
cardID
¸¸- 3
)
¸¸3 4
{
¹¹ 	
try
ºº 
{
»» 
using
¼¼ 
(
¼¼ 
SQLiteConnection
¼¼ '
db
¼¼( *
=
¼¼+ ,
new
¼¼- 0
SQLiteConnection
¼¼1 A
(
¼¼A B
DBFile
¼¼B H
)
¼¼H I
)
¼¼I J
{
½½ 
PatientCard
¾¾ 
card
¾¾  $
=
¾¾% &
db
¾¾' )
.
¾¾) *
GetWithChildren
¾¾* 9
<
¾¾9 :
PatientCard
¾¾: E
>
¾¾E F
(
¾¾F G
cardID
¾¾G M
)
¾¾M N
;
¾¾N O
return
¿¿ 
db
¿¿ 
.
¿¿ 
GetWithChildren
¿¿ -
<
¿¿- .
Patient
¿¿. 5
>
¿¿5 6
(
¿¿6 7
card
¿¿7 ;
.
¿¿; <
	PatientID
¿¿< E
)
¿¿E F
;
¿¿F G
}
ÀÀ 
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
ErrorHandler
ÄÄ 
.
ÄÄ 
	ShowError
ÄÄ &
(
ÄÄ& '
ex
ÄÄ' )
)
ÄÄ) *
;
ÄÄ* +
return
ÅÅ 
null
ÅÅ 
;
ÅÅ 
}
ÆÆ 
}
ÇÇ 	
static
ÉÉ 
public
ÉÉ 
Patient
ÉÉ 

GetPatient
ÉÉ (
(
ÉÉ( )
int
ÉÉ) ,
id
ÉÉ- /
,
ÉÉ/ 0
bool
ÉÉ1 5
flag
ÉÉ6 :
)
ÉÉ: ;
{
ÊÊ 	
if
ËË 
(
ËË 
!
ËË 
flag
ËË 
)
ËË 
return
ÌÌ 

GetPatient
ÌÌ !
(
ÌÌ! "
id
ÌÌ" $
)
ÌÌ$ %
;
ÌÌ% &
else
ÍÍ 
{
ÎÎ 
try
ÏÏ 
{
ÐÐ 
using
ÑÑ 
(
ÑÑ 
SQLiteConnection
ÑÑ +
db
ÑÑ, .
=
ÑÑ/ 0
new
ÑÑ1 4
SQLiteConnection
ÑÑ5 E
(
ÑÑE F
DBFile
ÑÑF L
)
ÑÑL M
)
ÑÑM N
return
ÒÒ 
db
ÒÒ !
.
ÒÒ! "
GetWithChildren
ÒÒ" 1
<
ÒÒ1 2
Patient
ÒÒ2 9
>
ÒÒ9 :
(
ÒÒ: ;
id
ÒÒ; =
)
ÒÒ= >
;
ÒÒ> ?
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ  
ex
ÔÔ! #
)
ÔÔ# $
{
ÕÕ 
Logger
ÖÖ 
.
ÖÖ 
WriteLog
ÖÖ #
(
ÖÖ# $
ex
ÖÖ$ &
)
ÖÖ& '
;
ÖÖ' (
return
×× 
null
×× 
;
××  
}
ØØ 
}
ÙÙ 
}
ÚÚ 	
static
ÜÜ 
public
ÜÜ 
PatientCard
ÜÜ !
GetPatientCard
ÜÜ" 0
(
ÜÜ0 1
string
ÜÜ1 7

cardNumber
ÜÜ8 B
)
ÜÜB C
{
ÝÝ 	
try
ÞÞ 
{
ßß 
using
àà 
(
àà 
SQLiteConnection
àà &
db
àà' )
=
àà* +
new
àà, /
SQLiteConnection
àà0 @
(
àà@ A
DBFile
ààA G
)
ààG H
)
ààH I
{
áá 
PatientCard
ââ 
card
ââ  $
=
ââ% &
db
ââ' )
.
ââ) *
Query
ââ* /
<
ââ/ 0
PatientCard
ââ0 ;
>
ââ; <
(
ââ< =
$str
ââ= m
,
ââm n

cardNumber
ââo y
)
âây z
.
ââz {
Firstââ{ €
(ââ€ 
)ââ ‚
;ââ‚ ƒ
return
ãã 
db
ãã 
.
ãã 
GetWithChildren
ãã -
<
ãã- .
PatientCard
ãã. 9
>
ãã9 :
(
ãã: ;
card
ãã; ?
.
ãã? @
CardID
ãã@ F
)
ããF G
;
ããG H
}
ää 
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
çç 
ErrorHandler
èè 
.
èè 
	ShowError
èè &
(
èè& '
ex
èè' )
)
èè) *
;
èè* +
return
éé 
null
éé 
;
éé 
}
êê 
}
ëë 	
static
íí 
public
íí 
PatientCard
íí !%
GetPatientCardByPatient
íí" 9
(
íí9 :
int
íí: =
id
íí> @
)
íí@ A
{
îî 	
try
ïï 
{
ðð 
using
ññ 
(
ññ 
SQLiteConnection
ññ &
db
ññ' )
=
ññ* +
new
ññ, /
SQLiteConnection
ññ0 @
(
ññ@ A
DBFile
ññA G
)
ññG H
)
ññH I
{
òò 
PatientCard
óó 
card
óó  $
=
óó% &
db
óó' )
.
óó) *
Query
óó* /
<
óó/ 0
PatientCard
óó0 ;
>
óó; <
(
óó< =
$str
óó= l
,
óól m
id
óón p
)
óóp q
.
óóq r
First
óór w
(
óów x
)
óóx y
;
óóy z
return
ôô 
db
ôô 
.
ôô 
GetWithChildren
ôô -
<
ôô- .
PatientCard
ôô. 9
>
ôô9 :
(
ôô: ;
card
ôô; ?
.
ôô? @
CardID
ôô@ F
)
ôôF G
;
ôôG H
}
õõ 
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷  
{
øø 
Logger
ùù 
.
ùù 
WriteLog
ùù 
(
ùù  
ex
ùù  "
)
ùù" #
;
ùù# $
return
úú 
null
úú 
;
úú 
}
ûû 
}
üü 	
static
þþ 
public
þþ 
Doctor
þþ 
	GetDoctor
þþ &
(
þþ& '
string
þþ' -
login
þþ. 3
)
þþ3 4
{
ÿÿ 	
try
€€ 
{
 
using
‚‚ 
(
‚‚ 
SQLiteConnection
‚‚ &
db
‚‚' )
=
‚‚* +
new
‚‚, /
SQLiteConnection
‚‚0 @
(
‚‚@ A
DBFile
‚‚A G
)
‚‚G H
)
‚‚H I
{
ƒƒ 
User
„„ 
user
„„ 
=
„„ 
db
„„  "
.
„„" #
Query
„„# (
<
„„( )
User
„„) -
>
„„- .
(
„„. /
$str
„„/ S
,
„„S T
login
„„U Z
)
„„Z [
.
„„[ \
First
„„\ a
(
„„a b
)
„„b c
;
„„c d
Doctor
…… 
doctor
…… !
=
……" #
db
……$ &
.
……& '
Query
……' ,
<
……, -
Doctor
……- 3
>
……3 4
(
……4 5
$str
……5 \
,
……\ ]
user
……^ b
.
……b c
ID
……c e
)
……e f
.
……f g
First
……g l
(
……l m
)
……m n
;
……n o
return
†† 
db
†† 
.
†† 
GetWithChildren
†† -
<
††- .
Doctor
††. 4
>
††4 5
(
††5 6
doctor
††6 <
.
††< =
DoctorID
††= E
)
††E F
;
††F G
}
‡‡ 
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
ErrorHandler
‹‹ 
.
‹‹ 
	ShowError
‹‹ &
(
‹‹& '
ex
‹‹' )
)
‹‹) *
;
‹‹* +
return
ŒŒ 
null
ŒŒ 
;
ŒŒ 
}
 
}
ŽŽ 	
static
 
public
 
Doctor
 
	GetDoctor
 &
(
& '
int
' *
ID
+ -
)
- .
{
‘‘ 	
try
’’ 
{
““ 
using
”” 
(
”” 
SQLiteConnection
”” &
db
””' )
=
””* +
new
””, /
SQLiteConnection
””0 @
(
””@ A
DBFile
””A G
)
””G H
)
””H I
{
•• 
return
–– 
db
–– 
.
–– 
GetWithChildren
–– -
<
––- .
Doctor
––. 4
>
––4 5
(
––5 6
ID
––6 8
)
––8 9
;
––9 :
}
—— 
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
šš 
ErrorHandler
›› 
.
›› 
	ShowError
›› &
(
››& '
ex
››' )
)
››) *
;
››* +
return
œœ 
null
œœ 
;
œœ 
}
 
}
žž 	
static
   
public
   
DoctorVisit
   !
GetDoctorVisit
  " 0
(
  0 1
int
  1 4
ID
  5 7
)
  7 8
{
¡¡ 	
try
¢¢ 
{
££ 
using
¤¤ 
(
¤¤ 
SQLiteConnection
¤¤ '
db
¤¤( *
=
¤¤+ ,
new
¤¤- 0
SQLiteConnection
¤¤1 A
(
¤¤A B
DBFile
¤¤B H
)
¤¤H I
)
¤¤I J
return
¥¥ 
db
¥¥ 
.
¥¥ 
GetWithChildren
¥¥ -
<
¥¥- .
DoctorVisit
¥¥. 9
>
¥¥9 :
(
¥¥: ;
ID
¥¥; =
)
¥¥= >
;
¥¥> ?
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§ 
ex
§§ 
)
§§  
{
¨¨ 
Logger
©© 
.
©© 
WriteLog
©© 
(
©©  
ex
©©  "
)
©©" #
;
©©# $
return
ªª 
null
ªª 
;
ªª 
}
«« 
}
¬¬ 	
static
®® 
public
®® 
List
®® 
<
®® 
DoctorVisit
®® &
>
®®& '
	GetVisits
®®( 1
(
®®1 2
)
®®2 3
{
¯¯ 	
try
°° 
{
±± 
List
²² 
<
²² 
DoctorVisit
²²  
>
²²  !
visits
²²" (
;
²²( )
using
´´ 
(
´´ 
SQLiteConnection
´´ '
db
´´( *
=
´´+ ,
new
´´- 0
SQLiteConnection
´´1 A
(
´´A B
DBFile
´´B H
)
´´H I
)
´´I J
visits
µµ 
=
µµ 
db
µµ 
.
µµ   
GetAllWithChildren
µµ  2
<
µµ2 3
DoctorVisit
µµ3 >
>
µµ> ?
(
µµ? @
)
µµ@ A
;
µµA B
return
·· 
visits
·· 
;
·· 
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹ 
ex
¹¹ 
)
¹¹  
{
ºº 
Logger
»» 
.
»» 
WriteLog
»» 
(
»»  
ex
»»  "
)
»»" #
;
»»# $
return
¼¼ 
null
¼¼ 
;
¼¼ 
}
½½ 
}
¾¾ 	
static
ÀÀ 
public
ÀÀ 
List
ÀÀ 
<
ÀÀ 
DoctorVisit
ÀÀ &
>
ÀÀ& ' 
GetVisitsByPatient
ÀÀ( :
(
ÀÀ: ;
int
ÀÀ; >
id
ÀÀ? A
)
ÀÀA B
{
ÁÁ 	
try
ÂÂ 
{
ÃÃ 
PatientCard
ÅÅ 
card
ÅÅ  
=
ÅÅ! "%
GetPatientCardByPatient
ÅÅ# :
(
ÅÅ: ;
id
ÅÅ; =
)
ÅÅ= >
;
ÅÅ> ?
List
ÈÈ 
<
ÈÈ 
DoctorVisit
ÈÈ  
>
ÈÈ  !
visits
ÈÈ" (
;
ÈÈ( )
using
ÊÊ 
(
ÊÊ 
SQLiteConnection
ÊÊ '
db
ÊÊ( *
=
ÊÊ+ ,
new
ÊÊ- 0
SQLiteConnection
ÊÊ1 A
(
ÊÊA B
DBFile
ÊÊB H
)
ÊÊH I
)
ÊÊI J
{
ËË 
visits
ÌÌ 
=
ÌÌ 
db
ÌÌ 
.
ÌÌ   
GetAllWithChildren
ÌÌ  2
<
ÌÌ2 3
DoctorVisit
ÌÌ3 >
>
ÌÌ> ?
(
ÌÌ? @
)
ÌÌ@ A
;
ÌÌA B
visits
ÍÍ 
=
ÍÍ 
visits
ÍÍ #
.
ÍÍ# $
Where
ÍÍ$ )
(
ÍÍ) *
i
ÍÍ* +
=>
ÍÍ, .
i
ÍÍ/ 0
.
ÍÍ0 1
PatientCardID
ÍÍ1 >
==
ÍÍ? A
card
ÍÍB F
.
ÍÍF G
CardID
ÍÍG M
)
ÍÍM N
.
ÍÍN O
ToList
ÍÍO U
(
ÍÍU V
)
ÍÍV W
;
ÍÍW X
}
ÎÎ 
return
ÐÐ 
visits
ÐÐ 
;
ÐÐ 
}
ÑÑ 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ 
ex
ÒÒ 
)
ÒÒ  
{
ÓÓ 
Logger
ÔÔ 
.
ÔÔ 
WriteLog
ÔÔ 
(
ÔÔ  
ex
ÔÔ  "
)
ÔÔ" #
;
ÔÔ# $
return
ÕÕ 
null
ÕÕ 
;
ÕÕ 
}
ÖÖ 
}
×× 	
static
ÙÙ 
public
ÙÙ 
List
ÙÙ 
<
ÙÙ 
DoctorVisit
ÙÙ &
>
ÙÙ& '
GetVisitsByDoctor
ÙÙ( 9
(
ÙÙ9 :
int
ÙÙ: =
id
ÙÙ> @
)
ÙÙ@ A
{
ÚÚ 	
try
ÛÛ 
{
ÜÜ 
List
ÝÝ 
<
ÝÝ 
DoctorVisit
ÝÝ  
>
ÝÝ  !
visits
ÝÝ" (
;
ÝÝ( )
using
ßß 
(
ßß 
SQLiteConnection
ßß '
db
ßß( *
=
ßß+ ,
new
ßß- 0
SQLiteConnection
ßß1 A
(
ßßA B
DBFile
ßßB H
)
ßßH I
)
ßßI J
{
àà 
visits
áá 
=
áá 
db
áá 
.
áá  
Query
áá  %
<
áá% &
DoctorVisit
áá& 1
>
áá1 2
(
áá2 3
$str
áá3 a
,
ááa b
id
áác e
)
ááe f
.
ááf g
ToList
áág m
(
áám n
)
áán o
;
ááo p
}
ââ 
return
ää 
visits
ää 
;
ää 
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
çç 
Logger
èè 
.
èè 
WriteLog
èè 
(
èè  
ex
èè  "
)
èè" #
;
èè# $
return
éé 
null
éé 
;
éé 
}
êê 
}
ëë 	
static
íí 
public
íí 
Administrator
íí #
GetAdmin
íí$ ,
(
íí, -
string
íí- 3
login
íí4 9
)
íí9 :
{
îî 	
try
ïï 
{
ðð 
using
ññ 
(
ññ 
SQLiteConnection
ññ '
db
ññ( *
=
ññ+ ,
new
ññ- 0
SQLiteConnection
ññ1 A
(
ññA B
DBFile
ññB H
)
ññH I
)
ññI J
{
òò 
User
óó 
user
óó 
=
óó 
db
óó  "
.
óó" #
Query
óó# (
<
óó( )
User
óó) -
>
óó- .
(
óó. /
$str
óó/ S
,
óóS T
login
óóU Z
)
óóZ [
.
óó[ \
First
óó\ a
(
óóa b
)
óób c
;
óóc d
Administrator
ôô !
admin
ôô" '
=
ôô( )
db
ôô* ,
.
ôô, -
Query
ôô- 2
<
ôô2 3
Administrator
ôô3 @
>
ôô@ A
(
ôôA B
$str
ôôB p
,
ôôp q
user
ôôr v
.
ôôv w
ID
ôôw y
)
ôôy z
.
ôôz {
Firstôô{ €
(ôô€ 
)ôô ‚
;ôô‚ ƒ
return
õõ 
db
õõ 
.
õõ 
GetWithChildren
õõ -
<
õõ- .
Administrator
õõ. ;
>
õõ; <
(
õõ< =
admin
õõ= B
.
õõB C
AdminID
õõC J
)
õõJ K
;
õõK L
}
öö 
}
÷÷ 
catch
øø 
(
øø 
	Exception
øø 
ex
øø 
)
øø  
{
ùù 
Logger
úú 
.
úú 
WriteLog
úú 
(
úú  
ex
úú  "
)
úú" #
;
úú# $
return
ûû 
null
ûû 
;
ûû 
}
üü 
}
ýý 	
static
ÿÿ 
public
ÿÿ 
List
ÿÿ 
<
ÿÿ 
Doctor
ÿÿ !
>
ÿÿ! "

GetDoctors
ÿÿ# -
(
ÿÿ- .
)
ÿÿ. /
{
€€ 	
try
 
{
‚‚ 
List
ƒƒ 
<
ƒƒ 
Doctor
ƒƒ 
>
ƒƒ 
doctors
ƒƒ $
;
ƒƒ$ %
using
…… 
(
…… 
SQLiteConnection
…… '
db
……( *
=
……+ ,
new
……- 0
SQLiteConnection
……1 A
(
……A B
DBFile
……B H
)
……H I
)
……I J
{
†† 
doctors
‡‡ 
=
‡‡ 
db
‡‡  
.
‡‡  ! 
GetAllWithChildren
‡‡! 3
<
‡‡3 4
Doctor
‡‡4 :
>
‡‡: ;
(
‡‡; <
)
‡‡< =
;
‡‡= >
}
ˆˆ 
return
ŠŠ 
doctors
ŠŠ 
;
ŠŠ 
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
Logger
ŽŽ 
.
ŽŽ 
WriteLog
ŽŽ 
(
ŽŽ  
ex
ŽŽ  "
)
ŽŽ" #
;
ŽŽ# $
return
 
null
 
;
 
}
 
}
‘‘ 	
static
““ 
public
““ 
Feedback
““ 
GetFeedback
““ *
(
““* +
int
““+ .
ID
““/ 1
)
““1 2
{
”” 	
try
•• 
{
–– 
using
—— 
(
—— 
SQLiteConnection
—— '
db
——( *
=
——+ ,
new
——- 0
SQLiteConnection
——1 A
(
——A B
DBFile
——B H
)
——H I
)
——I J
{
˜˜ 
return
™™ 
db
™™ 
.
™™ 
GetWithChildren
™™ -
<
™™- .
Feedback
™™. 6
>
™™6 7
(
™™7 8
ID
™™8 :
)
™™: ;
;
™™; <
}
šš 
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
Logger
žž 
.
žž 
WriteLog
žž 
(
žž  
ex
žž  "
)
žž" #
;
žž# $
return
ŸŸ 
null
ŸŸ 
;
ŸŸ 
}
   
}
¡¡ 	
}
¢¢ 
}££ ¦

FD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\ErrorHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
ErrorHandler $
{ 
static 
public 
void 
	ShowError $
($ %
string% +
error, 1
)1 2
{		 	

MessageBox

 
.

 
Show

 
(

 
error 
, 
$str "
," #
MessageBoxButtons !
.! "
OK" $
,$ %
MessageBoxIcon 
. 
Error $
) 
; 
} 	
static 
public 
void 
	ShowError $
($ %
	Exception% .
	exception/ 8
)8 9
{ 	

MessageBox 
. 
Show 
( 
	exception 
. 
ToString "
(" #
)# $
,$ %
$str "
," #
MessageBoxButtons !
.! "
OK" $
,$ %
MessageBoxIcon 
. 
Error $
) 
; 
} 	
} 
} ‡?
HD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Authorization\MainForm.cs
	namespace 	
PolyclinicSystem
 
{ 
public		 

partial		 
class		 
MainForm		 !
:		" #
Form		$ (
{

 
static 
public 
Patient 

CurPatient (
{) *
get+ .
;. /
set0 3
;3 4
}5 6
static 
public 
Doctor 
	CurDoctor &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
static 
public 
Administrator #
CurAdmin$ ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
static 
public 
string 
currentUser (
=) *
$str+ -
;- .
public 
MainForm 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
Logger 
. 
ActivateLogger !
(! "
)" #
;# $
} 	
private 
void 
MainForm_Load "
(" #
object# )
sender* 0
,0 1
	EventArgs2 ;
e< =
)= >
{ 	
if 
( 
! 
File 
. 
Exists 
( 
$str +
)+ ,
), -
{ 
bool 
result 
= 
DataHandler )
.) *
CreateDatabase* 8
(8 9
)9 :
;: ;
if 
( 
! 
result 
) 
Close 
( 
) 
; 
} 
}   	
private## 
void## 
signInButton_Click## '
(##' (
object##( .
sender##/ 5
,##5 6
	EventArgs##7 @
e##A B
)##B C
{$$ 	
try%% 
{&& 
User'' 
user'' 
='' 
Authorization'' )
.'') *
SignIn''* 0
(''0 1
loginTextBox''1 =
.''= >
Text''> B
,''B C
passwordTextBox''D S
.''S T
Text''T X
)''X Y
;''Y Z
if(( 
((( 
user(( 
!=(( 
null((  
)((  !
{)) 
string++ 
userType++ #
=++$ %
Authorization++& 3
.++3 4

DefineUser++4 >
(++> ?
user++? C
)++C D
;++D E
Authorization-- !
.--! "
SetUser--" )
(--) *
user--* .
,--. /
userType--0 8
)--8 9
;--9 :
if// 
(// 
userType//  
==//! #
$str//$ -
)//- .
{00 
PatientForm11 #
patientForm11$ /
=110 1
new112 5
PatientForm116 A
(11A B
)11B C
;11C D
patientForm22 #
.22# $

FormClosed22$ .
+=22/ 1
UserForm_FormClosed222 E
;22E F
patientForm33 #
.33# $
Show33$ (
(33( )
)33) *
;33* +
}44 
else55 
if55 
(55 
userType55 %
==55& (
$str55) 1
)551 2
{66 

DoctorForm77 "

doctorForm77# -
=77. /
new770 3

DoctorForm774 >
(77> ?
)77? @
;77@ A

doctorForm88 "
.88" #

FormClosed88# -
+=88. 0
UserForm_FormClosed881 D
;88D E

doctorForm99 "
.99" #
Show99# '
(99' (
)99( )
;99) *
}:: 
else;; 
if;; 
(;; 
userType;; %
==;;& (
$str;;) 0
);;0 1
{<< 
	AdminForm== !
	adminForm==" +
===, -
new==. 1
	AdminForm==2 ;
(==; <
)==< =
;=== >
	adminForm>> !
.>>! "

FormClosed>>" ,
+=>>- /
UserForm_FormClosed>>0 C
;>>C D
	adminForm?? !
.??! "
Show??" &
(??& '
)??' (
;??( )
}@@ 
VisibleAA 
=AA 
falseAA #
;AA# $
}BB 
}CC 
catchDD 
(DD 
	ExceptionDD 
exDD 
)DD  
{EE 
LoggerFF 
.FF 
WriteLogFF 
(FF  
exFF  "
)FF" #
;FF# $
}GG 
}HH 	
privateKK 
voidKK 
signUpButton_ClickKK '
(KK' (
objectKK( .
senderKK/ 5
,KK5 6
	EventArgsKK7 @
eKKA B
)KKB C
{LL 	
tryMM 
{NN 

SignUpFormOO 

signUpFormOO %
=OO& '
newOO( +

SignUpFormOO, 6
(OO6 7
)OO7 8
;OO8 9

signUpFormPP 
.PP 

FormClosedPP %
+=PP& (!
SignUpForm_FormClosedPP) >
;PP> ?

signUpFormQQ 
.QQ 
ShowQQ 
(QQ  
)QQ  !
;QQ! "
VisibleRR 
=RR 
falseRR 
;RR  
}SS 
catchTT 
(TT 
	ExceptionTT 
exTT 
)TT  
{UU 
LoggerVV 
.VV 
WriteLogVV 
(VV  
exVV  "
)VV" #
;VV# $
}WW 
}XX 	
private[[ 
void[[ %
forgotPasswordLabel_Click[[ .
([[. /
object[[/ 5
sender[[6 <
,[[< =
	EventArgs[[> G
e[[H I
)[[I J
{\\ 	
try]] 
{^^ 
ForgotPasswordForm__ "
form__# '
=__( )
new__* -
ForgotPasswordForm__. @
(__@ A
)__A B
;__B C
form`` 
.`` 

FormClosed`` 
+=``  ")
ForgotPasswordForm_FormClosed``# @
;``@ A
formaa 
.aa 
Showaa 
(aa 
)aa 
;aa 
Visiblebb 
=bb 
falsebb 
;bb  
}cc 
catchdd 
(dd 
	Exceptiondd 
exdd 
)dd  
{ee 
Loggerff 
.ff 
WriteLogff 
(ff  
exff  "
)ff" #
;ff# $
}gg 
}hh 	
privatekk 
voidkk )
ForgotPasswordForm_FormClosedkk 2
(kk2 3
objectkk3 9
senderkk: @
,kk@ A
FormClosedEventArgskkB U
ekkV W
)kkW X
{ll 	
Visiblemm 
=mm 
truemm 
;mm 
}nn 	
privateqq 
voidqq !
SignUpForm_FormClosedqq *
(qq* +
objectqq+ 1
senderqq2 8
,qq8 9
FormClosedEventArgsqq: M
eqqN O
)qqO P
{rr 	
Visibless 
=ss 
truess 
;ss 
}tt 	
privateww 
voidww 
UserForm_FormClosedww (
(ww( )
objectww) /
senderww0 6
,ww6 7
FormClosedEventArgsww8 K
ewwL M
)wwM N
{xx 	
Authorizationyy 
.yy 

LogoutUseryy $
(yy$ %
)yy% &
;yy& '
loginTextBoxzz 
.zz 
Textzz 
=zz 
$strzz  "
;zz" #
passwordTextBox{{ 
.{{ 
Text{{  
={{! "
$str{{# %
;{{% &
Visible|| 
=|| 
true|| 
;|| 
}}} 	
}~~ 
} ¼
3D:\git\PolyclinicSystem\PolyclinicSystem\Program.cs
	namespace 	
PolyclinicSystem
 
{ 
static		 

class		 
Program		 
{

 
[ 	
	STAThread	 
] 
static 
void 
Main 
( 
) 
{ 	
Application 
. 
EnableVisualStyles *
(* +
)+ ,
;, -
Application 
. -
!SetCompatibleTextRenderingDefault 9
(9 :
false: ?
)? @
;@ A
Application 
. 
Run 
( 
new 
MainForm  (
(( )
)) *
)* +
;+ ,
} 	
} 
} î
CD:\git\PolyclinicSystem\PolyclinicSystem\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str +
)+ ,
], -
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str -
)- .
]. /
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *ª
@D:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\Logger.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
Logger 
{ 
static 
public 
void 
ActivateLogger )
() *
)* +
{		 	
	Directory

 
.

 
CreateDirectory

 %
(

% &
$str

& ,
)

, -
;

- .
} 	
static 
public 
void 
WriteLog #
(# $
string$ *
message+ 2
)2 3
{ 	
string 
currentDate 
=  
DateTime! )
.) *
Today* /
./ 0
ToString0 8
(8 9
$str9 E
)E F
;F G
using 
( 
StreamWriter 
sw  "
=# $
new% (
StreamWriter) 5
(5 6
$str6 ?
+@ A
currentDateB M
+N O
$strP V
,V W
trueX \
,\ ]
System^ d
.d e
Texte i
.i j
Encodingj r
.r s
UTF8s w
)w x
)x y
{ 
sw 
. 
	WriteLine 
( 
$str ;
); <
;< =
sw 
. 
	WriteLine 
( 
DateTime %
.% &
Now& )
)) *
;* +
sw 
. 
	WriteLine 
( 
message $
)$ %
;% &
} 
} 	
static 
public 
void 
WriteLog #
(# $
	Exception$ -
message. 5
)5 6
{ 	
string 
currentDate 
=  
DateTime! )
.) *
Today* /
./ 0
ToString0 8
(8 9
$str9 E
)E F
;F G
using 
( 
StreamWriter 
sw  "
=# $
new% (
StreamWriter) 5
(5 6
$str6 ?
+@ A
currentDateB M
+N O
$strP V
,V W
trueX \
,\ ]
System^ d
.d e
Texte i
.i j
Encodingj r
.r s
UTF8s w
)w x
)x y
{ 
sw 
. 
	WriteLine 
( 
$str ;
); <
;< =
sw 
. 
	WriteLine 
( 
DateTime %
.% &
Now& )
)) *
;* +
sw 
. 
	WriteLine 
( 
message $
.$ %
ToString% -
(- .
). /
)/ 0
;0 1
}   
}!! 	
}"" 
}## Ú
ID:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\MessagesHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
class 	
MessagesHandler
 
{ 
static 
public 
void 
ShowMessage &
(& '
string' -
message. 5
)5 6
{ 	

MessageBox		 
.		 
Show		 
(		 
message

 
,

 
$str 
, 
MessageBoxButtons !
.! "
OK" $
,$ %
MessageBoxIcon 
. 
Information *
) 
; 
} 	
} 
} áE
ID:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\ProfilesHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
ProfilesHandler '
{ 
static 
public 
bool 
EditUser #
(# $
User$ (
user) -
,- .
string/ 5
login6 ;
,; <
string= C
emailD I
,I J
stringK Q
nameR V
,V W
stringX ^
password_ g
)g h
{ 	
bool		 
result		 
=		 
false		 
;		  
if 
( 
IsEmpty 
( 
login 
) 
) 
ErrorHandler 
. 
	ShowError &
(& '
$str' 8
)8 9
;9 :
else 
if 
( 
IsEmpty 
( 
email "
)" #
)# $
ErrorHandler 
. 
	ShowError &
(& '
$str' E
)E F
;F G
else 
if 
( 
IsEmpty 
( 
name !
)! "
)" #
ErrorHandler 
. 
	ShowError &
(& '
$str' 7
)7 8
;8 9
else 
if 
( 
IsEmpty 
( 
password %
)% &
)& '
ErrorHandler 
. 
	ShowError &
(& '
$str' 9
)9 :
;: ;
else 
if 
( 
! 
	Validator 
.  

CheckEmail  *
(* +
email+ 0
)0 1
)1 2
ErrorHandler 
. 
	ShowError &
(& '
$str' J
)J K
;K L
else 
{ 
if 
( 
DataHandler 
.  

GetPatient  *
(* +
login+ 0
)0 1
!=2 4
null5 9
)9 :
ErrorHandler  
.  !
	ShowError! *
(* +
$str+ F
)F G
;G H
else 
{ 
user 
. 
Edit 
( 
name "
," #
email$ )
,) *
password+ 3
,3 4
login5 :
): ;
;; <
DataHandler 
.  
UpdateInDatabase  0
(0 1
user1 5
)5 6
;6 7
return 
true 
;  
} 
}   
return"" 
result"" 
;"" 
}## 	
static%% 
public%% 
bool%% 
EditPatient%% &
(%%& '
Patient%%' .
patient%%/ 6
,%%6 7
string%%8 >
oms%%? B
,%%B C
string%%D J
jobplace%%K S
,%%S T
string%%U [
phone%%\ a
,%%a b
string%%c i
address%%j q
)%%q r
{&& 	
bool'' 
result'' 
='' 
false'' 
;''  
if)) 
()) 
IsEmpty)) 
()) 
oms)) 
))) 
))) 
ErrorHandler** 
.** 
	ShowError** &
(**& '
$str**' 6
)**6 7
;**7 8
else++ 
if++ 
(++ 
IsEmpty++ 
(++ 
phone++ "
)++" #
)++# $
ErrorHandler,, 
.,, 
	ShowError,, &
(,,& '
$str,,' A
),,A B
;,,B C
else-- 
if-- 
(-- 
IsEmpty-- 
(-- 
address-- $
)--$ %
)--% &
ErrorHandler.. 
... 
	ShowError.. &
(..& '
$str..' 8
)..8 9
;..9 :
else// 
if// 
(// 
!// 
	Validator// 
.//  
CheckOMS//  (
(//( )
oms//) ,
)//, -
)//- .
ErrorHandler00 
.00 
	ShowError00 &
(00& '
$str00' <
)00< =
;00= >
else11 
if11 
(11 
!11 
	Validator11 
.11  

CheckPhone11  *
(11* +
phone11+ 0
)110 1
)111 2
ErrorHandler22 
.22 
	ShowError22 &
(22& '
$str22' H
)22H I
;22I J
else33 
{44 
patient55 
.55 
Edit55 
(55 
oms55  
,55  !
jobplace55" *
,55* +
address55, 3
,553 4
phone555 :
)55: ;
;55; <
DataHandler66 
.66 
UpdateInDatabase66 ,
(66, -
patient66- 4
)664 5
;665 6
return77 
true77 
;77 
}88 
return:: 
result:: 
;:: 
};; 	
static== 
public== 
bool== 
	AddDoctor== $
(==$ %
string==% +
login==, 1
,==1 2
string==3 9
name==: >
,==> ?
string==@ F
email==G L
,==L M
string==N T
password==U ]
,==] ^
string==_ e
	specialty==f o
)==o p
{>> 	
bool?? 
result?? 
=?? 
false?? 
;??  
ifAA 
(AA 
IsEmptyAA 
(AA 
loginAA 
)AA 
)AA 
ErrorHandlerBB 
.BB 
	ShowErrorBB &
(BB& '
$strBB' 8
)BB8 9
;BB9 :
elseCC 
ifCC 
(CC 
IsEmptyCC 
(CC 
nameCC !
)CC! "
)CC" #
ErrorHandlerDD 
.DD 
	ShowErrorDD &
(DD& '
$strDD' 7
)DD7 8
;DD8 9
elseEE 
ifEE 
(EE 
IsEmptyEE 
(EE 
emailEE "
)EE" #
)EE# $
ErrorHandlerFF 
.FF 
	ShowErrorFF &
(FF& '
$strFF' E
)FFE F
;FFF G
elseGG 
ifGG 
(GG 
IsEmptyGG 
(GG 
passwordGG %
)GG% &
)GG& '
ErrorHandlerHH 
.HH 
	ShowErrorHH &
(HH& '
$strHH' 9
)HH9 :
;HH: ;
elseII 
ifII 
(II 
IsEmptyII 
(II 
	specialtyII &
)II& '
)II' (
ErrorHandlerJJ 
.JJ 
	ShowErrorJJ &
(JJ& '
$strJJ' A
)JJA B
;JJB C
elseKK 
ifKK 
(KK 
!KK 
	ValidatorKK 
.KK  

CheckEmailKK  *
(KK* +
emailKK+ 0
)KK0 1
)KK1 2
ErrorHandlerLL 
.LL 
	ShowErrorLL &
(LL& '
$strLL' N
)LLN O
;LLO P
elseMM 
{NN 
ifPP 
(PP 
DataHandlerPP 
.PP  

GetPatientPP  *
(PP* +
loginPP+ 0
)PP0 1
!=PP2 4
nullPP5 9
)PP9 :
ErrorHandlerQQ  
.QQ  !
	ShowErrorQQ! *
(QQ* +
$strQQ+ F
)QQF G
;QQG H
elseRR 
{SS 
DataHandlerTT 
.TT  
	AddDoctorTT  )
(TT) *
loginTT* /
,TT/ 0
nameTT1 5
,TT5 6
emailTT7 <
,TT< =
passwordTT> F
,TTF G
	specialtyTTH Q
)TTQ R
;TTR S
MessagesHandlerUU #
.UU# $
ShowMessageUU$ /
(UU/ 0
$strUU0 E
)UUE F
;UUF G
returnVV 
trueVV 
;VV  
}WW 
}XX 
returnZZ 
resultZZ 
;ZZ 
}[[ 	
static]] 
private]] 
bool]] 
IsEmpty]] #
(]]# $
string]]$ *
value]]+ 0
)]]0 1
{^^ 	
if__ 
(__ 
(__ 
value__ 
==__ 
null__ 
)__ 
||__  "
(__# $
value__$ )
==__* ,
$str__- /
)__/ 0
)__0 1
return`` 
true`` 
;`` 
elseaa 
returnaa 
falseaa 
;aa 
}bb 	
}cc 
}dd Æ$
CD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\Validator.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
	Validator !
{ 
static		 
public		 
bool		 

CheckEmail		 %
(		% &
string		& ,
email		- 2
)		2 3
{

 	
string 
pattern 
= 
$str -
;- .
return 
Regex 
. 
IsMatch  
(  !
email! &
,& '
pattern( /
)/ 0
;0 1
} 	
static 
public 
bool 
CheckOMS #
(# $
string$ *
oms+ .
). /
{ 	
string 
pattern 
= 
$str (
;( )
return 
Regex 
. 
IsMatch  
(  !
oms! $
,$ %
pattern& -
)- .
;. /
} 	
static 
public 
bool 

CheckPhone %
(% &
string& ,
phone- 2
)2 3
{ 	
string 
pattern1 
= 
$str *
;* +
string 
pattern2 
= 
$str (
;( )
return 
( 
( 
Regex 
. 
IsMatch "
(" #
phone# (
,( )
pattern1* 2
)2 3
)3 4
||5 7
Regex8 =
.= >
IsMatch> E
(E F
phoneF K
,K L
pattern2M U
)U V
)V W
;W X
} 	
static 
public 
bool 
IsDate !
(! "
string" (
date) -
)- .
{ 	
string 
pattern 
= 
$str 5
;5 6
return!! 
(!! 
Regex!! 
.!! 
IsMatch!! !
(!!! "
date!!" &
,!!& '
pattern!!( /
)!!/ 0
)!!0 1
;!!1 2
}"" 	
static$$ 
public$$ 
bool$$ 
IsSpecialty$$ &
($$& '
string$$' -
	specialty$$. 7
)$$7 8
{%% 	
bool&& 
result&& 
=&& 
false&& 
;&&  
List(( 
<(( 
	Specialty(( 
>(( 
specialties(( '
=((( )
DataHandler((* 5
.((5 6
GetSpecialties((6 D
(((D E
)((E F
;((F G
foreach** 
(** 
	Specialty** 
spec** #
in**$ &
specialties**' 2
)**2 3
if++ 
(++ 
spec++ 
.++ 
Name++ 
==++  
	specialty++! *
)++* +
{,, 
result-- 
=-- 
true-- !
;--! "
break.. 
;.. 
}// 
return11 
result11 
;11 
}22 	
static44 
public44 
bool44 
IsStatus44 #
(44# $
string44$ *
status44+ 1
)441 2
{55 	
if66 
(66 
(66 
status66 
==66 
$str66 %
)66% &
||66' )
(66* +
status66+ 1
==662 4
$str665 >
)66> ?
||66@ B
(66C D
status66D J
==66K M
$str66N Y
)66Y Z
||66[ ]
(66^ _
status66_ e
==66f h
$str66i s
)66s t
)66t u
return77 
true77 
;77 
else88 
return88 
false88 
;88 
}99 	
static;; 
public;; 
bool;; 
IsType;; !
(;;! "
string;;" (
type;;) -
);;- .
{<< 	
if== 
(== 
(== 
type== 
==== 
$str== !
)==! "
||==# %
(==& '
type==' +
====, .
$str==/ 8
)==8 9
||==: <
(=== >
type==> B
====C E
$str==F U
)==U V
)==V W
return>> 
true>> 
;>> 
else?? 
return?? 
false?? 
;?? 
}@@ 	
}AA 
}BB Ï§
GD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\VisitsHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
public		 

static		 
class		 
VisitsHandler		 %
{

 
static 
public 
	DataTable 
GetDataTable  ,
(, -
string- 3
usertype4 <
)< =
{ 	
	DataTable 
dt 
= 
new 
	DataTable (
(( )
)) *
;* +
try 
{ 
switch 
( 
usertype  
)  !
{ 
case 
$str "
:" #
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 :
,: ;
typeof< B
(B C
intC F
)F G
)G H
)H I
;I J
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 C
,C D
typeofE K
(K L
stringL R
)R S
)S T
)T U
;U V
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 >
,> ?
typeof@ F
(F G
stringG M
)M N
)N O
)O P
;P Q
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 B
,B C
typeofD J
(J K
stringK Q
)Q R
)R S
)S T
;T U
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 A
,A B
typeofC I
(I J
stringJ P
)P Q
)Q R
)R S
;S T
break 
; 
case 
$str !
:! "
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 :
,: ;
typeof< B
(B C
intC F
)F G
)G H
)H I
;I J
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 C
,C D
typeofE K
(K L
stringL R
)R S
)S T
)T U
;U V
dt   
.   
Columns   "
.  " #
Add  # &
(  & '
new  ' *

DataColumn  + 5
(  5 6
$str  6 >
,  > ?
typeof  @ F
(  F G
string  G M
)  M N
)  N O
)  O P
;  P Q
dt!! 
.!! 
Columns!! "
.!!" #
Add!!# &
(!!& '
new!!' *

DataColumn!!+ 5
(!!5 6
$str!!6 D
,!!D E
typeof!!F L
(!!L M
string!!M S
)!!S T
)!!T U
)!!U V
;!!V W
break"" 
;"" 
case## 
$str##  
:##  !
dt$$ 
.$$ 
Columns$$ "
.$$" #
Add$$# &
($$& '
new$$' *

DataColumn$$+ 5
($$5 6
$str$$6 :
,$$: ;
typeof$$< B
($$B C
int$$C F
)$$F G
)$$G H
)$$H I
;$$I J
dt%% 
.%% 
Columns%% "
.%%" #
Add%%# &
(%%& '
new%%' *

DataColumn%%+ 5
(%%5 6
$str%%6 C
,%%C D
typeof%%E K
(%%K L
string%%L R
)%%R S
)%%S T
)%%T U
;%%U V
dt&& 
.&& 
Columns&& "
.&&" #
Add&&# &
(&&& '
new&&' *

DataColumn&&+ 5
(&&5 6
$str&&6 >
,&&> ?
typeof&&@ F
(&&F G
string&&G M
)&&M N
)&&N O
)&&O P
;&&P Q
dt'' 
.'' 
Columns'' "
.''" #
Add''# &
(''& '
new''' *

DataColumn''+ 5
(''5 6
$str''6 D
,''D E
typeof''F L
(''L M
string''M S
)''S T
)''T U
)''U V
;''V W
dt(( 
.(( 
Columns(( "
.((" #
Add((# &
(((& '
new((' *

DataColumn((+ 5
(((5 6
$str((6 A
,((A B
typeof((C I
(((I J
string((J P
)((P Q
)((Q R
)((R S
;((S T
break)) 
;)) 
}** 
}++ 
catch,, 
(,, 
	Exception,, 
ex,, 
),,  
{-- 
Logger.. 
... 
WriteLog.. 
(..  
ex..  "
).." #
;..# $
return// 
null// 
;// 
}00 
return22 
dt22 
;22 
}33 	
static66 
public66 
	DataTable66 
FillData66  (
(66( )
string66) /
usertype660 8
,668 9
	DataTable66: C
dt66D F
)66F G
{77 	
dt88 
.88 
Rows88 
.88 
Clear88 
(88 
)88 
;88 
try:: 
{;; 
List<< 
<<< 
DoctorVisit<<  
><<  !
visits<<" (
;<<( )
switch== 
(== 
usertype== 
)==  
{>> 
case?? 
$str?? "
:??" #
visits@@ 
=@@  
DataHandler@@! ,
.@@, -
GetVisitsByPatient@@- ?
(@@? @
MainForm@@@ H
.@@H I

CurPatient@@I S
.@@S T
	PatientID@@T ]
)@@] ^
;@@^ _
foreachAA 
(AA  !
DoctorVisitAA! ,
visitAA- 2
inAA3 5
visitsAA6 <
)AA< =
{BB 
stringDD "
dateDD# '
=DD( )
visitDD* /
.DD/ 0
DateDD0 4
;DD4 5
stringFF "
	specialtyFF# ,
=FF- .
DataHandlerFF/ :
.FF: ; 
GetSpecialtyByDoctorFF; O
(FFO P
visitFFP U
.FFU V
DoctorIDFFV ^
)FF^ _
.FF_ `
NameFF` d
;FFd e
stringHH "
statusHH# )
=HH* +
visitHH, 1
.HH1 2
StatusHH2 8
;HH8 9
stringJJ "
nameJJ# '
=JJ( )
DataHandlerJJ* 5
.JJ5 6
	GetDoctorJJ6 ?
(JJ? @
visitJJ@ E
.JJE F
DoctorIDJJF N
)JJN O
.JJO P
UserJJP T
.JJT U
NameJJU Y
;JJY Z
dtMM 
.MM 
RowsMM #
.MM# $
AddMM$ '
(MM' (
visitMM( -
.MM- .
VisitIDMM. 5
,MM5 6
dateMM7 ;
,MM; <
statusMM= C
,MMC D
	specialtyMME N
,MMN O
nameMMP T
)MMT U
;MMU V
}NN 
breakOO 
;OO 
casePP 
$strPP !
:PP! "
visitsQQ 
=QQ  
DataHandlerQQ! ,
.QQ, -
GetVisitsByDoctorQQ- >
(QQ> ?
MainFormQQ? G
.QQG H
	CurDoctorQQH Q
.QQQ R
DoctorIDQQR Z
)QQZ [
;QQ[ \
foreachRR 
(RR  !
DoctorVisitRR! ,
visitRR- 2
inRR3 5
visitsRR6 <
)RR< =
{SS 
stringUU "
dateUU# '
=UU( )
visitUU* /
.UU/ 0
DateUU0 4
;UU4 5
stringWW "
statusWW# )
=WW* +
visitWW, 1
.WW1 2
StatusWW2 8
;WW8 9
stringYY "
nameYY# '
=YY( )
DataHandlerYY* 5
.YY5 6

GetPatientYY6 @
(YY@ A
visitYYA F
.YYF G
PatientCardIDYYG T
)YYT U
.YYU V
UserYYV Z
.YYZ [
NameYY[ _
;YY_ `
dt\\ 
.\\ 
Rows\\ #
.\\# $
Add\\$ '
(\\' (
visit\\( -
.\\- .
VisitID\\. 5
,\\5 6
date\\7 ;
,\\; <
status\\= C
,\\C D
name\\E I
)\\I J
;\\J K
}]] 
break^^ 
;^^ 
case__ 
$str__  
:__  !
visits`` 
=``  
DataHandler``! ,
.``, -
	GetVisits``- 6
(``6 7
)``7 8
;``8 9
foreachaa 
(aa  !
DoctorVisitaa! ,
visitaa- 2
inaa3 5
visitsaa6 <
)aa< =
{bb 
stringdd "
datedd# '
=dd( )
visitdd* /
.dd/ 0
Datedd0 4
;dd4 5
stringff "
statusff# )
=ff* +
visitff, 1
.ff1 2
Statusff2 8
;ff8 9
stringhh "
patNamehh# *
=hh+ ,
DataHandlerhh- 8
.hh8 9

GetPatienthh9 C
(hhC D
visithhD I
.hhI J
PatientCardIDhhJ W
)hhW X
.hhX Y
UserhhY ]
.hh] ^
Namehh^ b
;hhb c
stringjj "
docNamejj# *
=jj+ ,
DataHandlerjj- 8
.jj8 9
	GetDoctorjj9 B
(jjB C
visitjjC H
.jjH I
DoctorIDjjI Q
)jjQ R
.jjR S
UserjjS W
.jjW X
NamejjX \
;jj\ ]
dtmm 
.mm 
Rowsmm #
.mm# $
Addmm$ '
(mm' (
visitmm( -
.mm- .
VisitIDmm. 5
,mm5 6
datemm7 ;
,mm; <
statusmm= C
,mmC D
patNamemmE L
,mmL M
docNamemmN U
)mmU V
;mmV W
}nn 
breakoo 
;oo 
}pp 
returnrr 
dtrr 
;rr 
}ss 
catchtt 
(tt 
	Exceptiontt 
extt 
)tt  
{uu 
Loggervv 
.vv 
WriteLogvv 
(vv  
exvv  "
)vv" #
;vv# $
returnww 
nullww 
;ww 
}xx 
}yy 	
static|| 
public|| 
	DataTable|| 
Search||  &
(||& '
string||' -
usertype||. 6
,||6 7
string||8 >
query||? D
,||D E
	DataTable||F O
dt||P R
)||R S
{}} 	
if 
( 
( 
query 
== 
$str 
) 
||  
(! "
query" '
==( *
null+ /
)/ 0
)0 1
return
€€ 
FillData
€€ 
(
€€  
usertype
€€  (
,
€€( )
dt
€€* ,
)
€€, -
;
€€- .
string
ƒƒ 
[
ƒƒ 
]
ƒƒ 

queryParts
ƒƒ 
=
ƒƒ  !
query
ƒƒ" '
.
ƒƒ' (
Split
ƒƒ( -
(
ƒƒ- .
$char
ƒƒ. 1
)
ƒƒ1 2
;
ƒƒ2 3
switch
…… 
(
…… 
usertype
…… 
)
…… 
{
†† 
case
‡‡ 
$str
‡‡ 
:
‡‡ 
foreach
ˆˆ 
(
ˆˆ 
string
ˆˆ "
qry
ˆˆ# &
in
ˆˆ' )

queryParts
ˆˆ* 4
)
ˆˆ4 5
{
‰‰ 
if
ŠŠ 
(
ŠŠ 
	Validator
ŠŠ $
.
ŠŠ$ %
IsDate
ŠŠ% +
(
ŠŠ+ ,
qry
ŠŠ, /
)
ŠŠ/ 0
)
ŠŠ0 1
dt
‹‹ 
=
‹‹  

FilterData
‹‹! +
(
‹‹+ ,
dt
‹‹, .
,
‹‹. /
$str
‹‹0 =
,
‹‹= >
qry
‹‹? B
)
‹‹B C
;
‹‹C D
else
ŒŒ 
if
ŒŒ 
(
ŒŒ  !
	Validator
ŒŒ! *
.
ŒŒ* +
IsSpecialty
ŒŒ+ 6
(
ŒŒ6 7
qry
ŒŒ7 :
)
ŒŒ: ;
)
ŒŒ; <
dt
 
=
  

FilterData
! +
(
+ ,
dt
, .
,
. /
$str
0 <
,
< =
qry
> A
)
A B
;
B C
else
ŽŽ 
if
ŽŽ 
(
ŽŽ  !
	Validator
ŽŽ! *
.
ŽŽ* +
IsStatus
ŽŽ+ 3
(
ŽŽ3 4
qry
ŽŽ4 7
)
ŽŽ7 8
)
ŽŽ8 9
dt
 
=
  

FilterData
! +
(
+ ,
dt
, .
,
. /
$str
0 8
,
8 9
qry
: =
)
= >
;
> ?
else
 
dt
‘‘ 
=
‘‘  

FilterData
‘‘! +
(
‘‘+ ,
dt
‘‘, .
,
‘‘. /
$str
‘‘0 ;
,
‘‘; <
qry
‘‘= @
)
‘‘@ A
;
‘‘A B
}
’’ 
break
““ 
;
““ 
case
”” 
$str
”” 
:
”” 
foreach
•• 
(
•• 
string
•• #
qry
••$ '
in
••( *

queryParts
••+ 5
)
••5 6
{
–– 
if
—— 
(
—— 
	Validator
—— %
.
——% &
IsDate
——& ,
(
——, -
qry
——- 0
)
——0 1
)
——1 2
dt
˜˜ 
=
˜˜  

FilterData
˜˜! +
(
˜˜+ ,
dt
˜˜, .
,
˜˜. /
$str
˜˜0 =
,
˜˜= >
qry
˜˜? B
)
˜˜B C
;
˜˜C D
else
™™ 
if
™™ 
(
™™  !
	Validator
™™! *
.
™™* +
IsSpecialty
™™+ 6
(
™™6 7
qry
™™7 :
)
™™: ;
)
™™; <
dt
šš 
=
šš  

FilterData
šš! +
(
šš+ ,
dt
šš, .
,
šš. /
$str
šš0 <
,
šš< =
qry
šš> A
)
ššA B
;
ššB C
else
›› 
if
›› 
(
››  !
	Validator
››! *
.
››* +
IsStatus
››+ 3
(
››3 4
qry
››4 7
)
››7 8
)
››8 9
dt
œœ 
=
œœ  

FilterData
œœ! +
(
œœ+ ,
dt
œœ, .
,
œœ. /
$str
œœ0 8
,
œœ8 9
qry
œœ: =
)
œœ= >
;
œœ> ?
else
 
dt
žž 
=
žž  

FilterData
žž! +
(
žž+ ,
dt
žž, .
,
žž. /
$str
žž0 >
,
žž> ?
qry
žž@ C
)
žžC D
;
žžD E
}
ŸŸ 
break
   
;
   
case
¡¡ 
$str
¡¡ 
:
¡¡ 
foreach
¢¢ 
(
¢¢ 
string
¢¢ #
qry
¢¢$ '
in
¢¢( *

queryParts
¢¢+ 5
)
¢¢5 6
{
££ 
if
¤¤ 
(
¤¤ 
	Validator
¤¤ %
.
¤¤% &
IsDate
¤¤& ,
(
¤¤, -
qry
¤¤- 0
)
¤¤0 1
)
¤¤1 2
dt
¥¥ 
=
¥¥  

FilterData
¥¥! +
(
¥¥+ ,
dt
¥¥, .
,
¥¥. /
$str
¥¥0 =
,
¥¥= >
qry
¥¥? B
)
¥¥B C
;
¥¥C D
else
¦¦ 
if
¦¦ 
(
¦¦  !
	Validator
¦¦! *
.
¦¦* +
IsStatus
¦¦+ 3
(
¦¦3 4
qry
¦¦4 7
)
¦¦7 8
)
¦¦8 9
dt
§§ 
=
§§  

FilterData
§§! +
(
§§+ ,
dt
§§, .
,
§§. /
$str
§§0 8
,
§§8 9
qry
§§: =
)
§§= >
;
§§> ?
else
¨¨ 
{
©© 
	DataTable
ªª %
dt1
ªª& )
=
ªª* +

FilterData
ªª, 6
(
ªª6 7
dt
ªª7 9
,
ªª9 :
$str
ªª; I
,
ªªI J
qry
ªªK N
)
ªªN O
;
ªªO P
	DataTable
«« %
dt2
««& )
=
««* +

FilterData
««, 6
(
««6 7
dt
««7 9
,
««9 :
$str
««; F
,
««F G
qry
««H K
)
««K L
;
««L M
if
¬¬ 
(
¬¬  
(
¬¬  !
dt1
¬¬! $
.
¬¬$ %
Rows
¬¬% )
.
¬¬) *
Count
¬¬* /
>
¬¬0 1
$num
¬¬2 3
)
¬¬3 4
||
¬¬5 7
(
¬¬8 9
dt2
¬¬9 <
.
¬¬< =
Rows
¬¬= A
.
¬¬A B
Count
¬¬B G
>
¬¬H I
$num
¬¬J K
)
¬¬K L
)
¬¬L M
dt
­­  "
=
­­# $
dt1
­­% (
.
­­( )
AsEnumerable
­­) 5
(
­­5 6
)
­­6 7
.
®®  !
Union
®®! &
(
®®& '
dt2
®®' *
.
®®* +
AsEnumerable
®®+ 7
(
®®7 8
)
®®8 9
)
®®9 :
.
¯¯  !
Distinct
¯¯! )
(
¯¯) *
)
¯¯* +
.
°°  !
CopyToDataTable
°°! 0
(
°°0 1
)
°°1 2
;
°°2 3
else
±±  
dt
²²  "
.
²²" #
Rows
²²# '
.
²²' (
Clear
²²( -
(
²²- .
)
²². /
;
²²/ 0
}
³³ 
}
´´ 
break
µµ 
;
µµ 
}
¶¶ 
return
¸¸ 
dt
¸¸ 
;
¸¸ 
}
¹¹ 	
static
¼¼ 
private
¼¼ 
	DataTable
¼¼  

FilterData
¼¼! +
(
¼¼+ ,
	DataTable
¼¼, 5
table
¼¼6 ;
,
¼¼; <
string
¼¼= C
field
¼¼D I
,
¼¼I J
string
¼¼K Q
value
¼¼R W
)
¼¼W X
{
½½ 	
try
¾¾ 
{
¿¿ 
table
ÀÀ 
=
ÀÀ 
table
ÀÀ 
.
ÀÀ 
AsEnumerable
ÀÀ *
(
ÀÀ* +
)
ÀÀ+ ,
.
ÁÁ 
Where
ÁÁ 
(
ÁÁ 
row
ÁÁ 
=>
ÁÁ 
row
ÁÁ !
.
ÁÁ! "
Field
ÁÁ" '
<
ÁÁ' (
string
ÁÁ( .
>
ÁÁ. /
(
ÁÁ/ 0
field
ÁÁ0 5
)
ÁÁ5 6
==
ÁÁ7 9
value
ÁÁ: ?
)
ÁÁ? @
.
ÂÂ 
CopyToDataTable
ÂÂ  
(
ÂÂ  !
)
ÂÂ! "
;
ÂÂ" #
return
ÃÃ 
table
ÃÃ 
;
ÃÃ 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÆÆ 
Logger
ÇÇ 
.
ÇÇ 
WriteLog
ÇÇ 
(
ÇÇ  
ex
ÇÇ  "
)
ÇÇ" #
;
ÇÇ# $
	DataTable
ÈÈ 
dt
ÈÈ 
=
ÈÈ 
table
ÈÈ $
.
ÈÈ$ %
Clone
ÈÈ% *
(
ÈÈ* +
)
ÈÈ+ ,
;
ÈÈ, -
return
ÉÉ 
dt
ÉÉ 
;
ÉÉ 
}
ÊÊ 
}
ËË 	
static
ÏÏ 
public
ÏÏ 
bool
ÏÏ !
CheckDoctorBusyness
ÏÏ .
(
ÏÏ. /
Doctor
ÏÏ/ 5
doctor
ÏÏ6 <
,
ÏÏ< =
string
ÏÏ> D
date
ÏÏE I
)
ÏÏI J
{
ÐÐ 	
if
ÒÒ 
(
ÒÒ 
doctor
ÒÒ 
.
ÒÒ 
DoctorVisits
ÒÒ #
.
ÒÒ# $
Count
ÒÒ$ )
>
ÒÒ* +
$num
ÒÒ, -
)
ÒÒ- .
{
ÓÓ 
List
ÕÕ 
<
ÕÕ 
DoctorVisit
ÕÕ  
>
ÕÕ  !
visits
ÕÕ" (
=
ÕÕ) *
DataHandler
ÕÕ+ 6
.
ÕÕ6 7
GetVisitsByDoctor
ÕÕ7 H
(
ÕÕH I
doctor
ÕÕI O
.
ÕÕO P
DoctorID
ÕÕP X
)
ÕÕX Y
;
ÕÕY Z
visits
ØØ 
=
ØØ 
visits
ØØ 
.
ØØ  
Where
ØØ  %
(
ØØ% &
i
ØØ& '
=>
ØØ( *
i
ØØ+ ,
.
ØØ, -
Status
ØØ- 3
!=
ØØ4 6
$str
ØØ7 A
&&
ØØB D
i
ØØE F
.
ØØF G
Status
ØØG M
!=
ØØN P
$str
ØØQ Z
)
ØØZ [
.
ØØ[ \
ToList
ØØ\ b
(
ØØb c
)
ØØc d
;
ØØd e
visits
ÛÛ 
=
ÛÛ 
visits
ÛÛ 
.
ÛÛ  
Where
ÛÛ  %
(
ÛÛ% &
i
ÛÛ& '
=>
ÛÛ( *
i
ÛÛ+ ,
.
ÛÛ, -
Date
ÛÛ- 1
==
ÛÛ2 4
date
ÛÛ5 9
)
ÛÛ9 :
.
ÛÛ: ;
ToList
ÛÛ; A
(
ÛÛA B
)
ÛÛB C
;
ÛÛC D
if
ÝÝ 
(
ÝÝ 
visits
ÝÝ 
.
ÝÝ 
Count
ÝÝ  
>
ÝÝ! "
$num
ÝÝ# $
)
ÝÝ$ %
return
ÞÞ 
false
ÞÞ  
;
ÞÞ  !
else
ßß 
return
àà 
true
àà 
;
àà  
}
áá 
else
ââ 
return
ãã 
true
ãã 
;
ãã 
}
ää 	
}
åå 
}ææ 