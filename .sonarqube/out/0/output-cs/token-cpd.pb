ê
AD:\git\PolyclinicSystem\PolyclinicSystem\Classes\Administrator.cs
public 
class 
Administrator 
{ 
[ 

PrimaryKey 
, 
AutoIncrement 
] 
public 

int 
AdminID 
{ 
get 
; 
set !
;! "
}# $
[		 
NotNull		 
,		 
	MaxLength		 
(		 
$num		 
)		 
]		 
public

 

string

 
Phone

 
{

 
get

 
;

 
set

 "
;

" #
}

$ %
[ 

ForeignKey 
( 
typeof 
( 
User 
) 
) 
] 
public 

int 
UserId 
{ 
get 
; 
set  
;  !
}" #
[ 
	ManyToOne 
] 
public 

User 
User 
{ 
get 
; 
set 
;  
}! "
public 

void 
Edit 
( 
string 
phone !
)! "
{ 
Phone 
= 
phone 
; 
} 
} ≤
:D:\git\PolyclinicSystem\PolyclinicSystem\Classes\Doctor.cs
public 
class 
Doctor 
{ 
[ 

PrimaryKey 
, 
AutoIncrement 
] 
public 

int 
DoctorID 
{ 
get 
; 
set "
;" #
}$ %
[

 

ForeignKey

 
(

 
typeof

 
(

 
	Specialty

  
)

  !
)

! "
]

" #
public 

int 
SpecialtyID 
{ 
get  
;  !
set" %
;% &
}' (
[ 

ForeignKey 
( 
typeof 
( 
User 
) 
) 
] 
public 

int 
UserID 
{ 
get 
; 
set  
;  !
}" #
[ 
	ManyToOne 
] 
public 

User 
User 
{ 
get 
; 
set 
;  
}! "
[ 
	ManyToOne 
] 
public 

	Specialty 
	Specialty 
{  
get! $
;$ %
set& )
;) *
}+ ,
[ 
	OneToMany 
( 
CascadeOperations  
=! "
CascadeOperation# 3
.3 4
All4 7
)7 8
]8 9
public 

List 
< 
DoctorVisit 
> 
DoctorVisits )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
[ 
	OneToMany 
( 
CascadeOperations  
=! "
CascadeOperation# 3
.3 4
All4 7
)7 8
]8 9
public 

List 
< 
Feedback 
> 
	Feedbacks #
{$ %
get& )
;) *
set+ .
;. /
}0 1
} “
?D:\git\PolyclinicSystem\PolyclinicSystem\Classes\DoctorVisit.cs
public 
class 
DoctorVisit 
{ 
[ 

PrimaryKey 
, 
AutoIncrement 
] 
public 

int 
VisitID 
{ 
get 
; 
set !
;! "
}# $
public		 

string		 
Type		 
{		 
get		 
;		 
set		 !
;		! "
}		# $
public 

string 
Date 
{ 
get 
; 
set !
;! "
}# $
public 

string 

Complaints 
{ 
get "
;" #
set$ '
;' (
}) *
public 

string 
	Diagnosis 
{ 
get !
;! "
set# &
;& '
}( )
public 

string 
	Treatment 
{ 
get !
;! "
set# &
;& '
}( )
[ 
NotNull 
] 
public 

string 
Status 
{ 
get 
; 
set  #
;# $
}% &
[ 

ForeignKey 
( 
typeof 
( 
Doctor 
) 
) 
]  
public 

int 
DoctorID 
{ 
get 
; 
set "
;" #
}$ %
[ 

ForeignKey 
( 
typeof 
( 
PatientCard "
)" #
)# $
]$ %
public 

int 
PatientCardID 
{ 
get "
;" #
set$ '
;' (
}) *
[ 
	ManyToOne 
] 
public 

Doctor 
Doctor 
{ 
get 
; 
set  #
;# $
}% &
[ 
	ManyToOne 
] 
public   

PatientCard   
PatientCard   "
{  # $
get  % (
;  ( )
set  * -
;  - .
}  / 0
public## 

void## 
Move## 
(## 
string## 
newDate## #
)### $
{$$ 
Date%% 
=%% 
newDate%% 
;%% 
Status&& 
=&& 
$str&& 
;&& 
}'' 
public** 

void** 
Cancel** 
(** 
)** 
{++ 
Status,, 
=,, 
$str,, 
;,, 
Date-- 
=-- 
null-- 
;-- 
}.. 
public11 

void11 
Complete11 
(11 
)11 
{22 
Status33 
=33 
$str33 
;33 
}44 
public77 

void77 
	WriteInfo77 
(77 
string77  
type77! %
,77% &
string77' -

complaints77. 8
,778 9
string77: @
	diagnosis77A J
,77J K
string77L R
	treatment77S \
)77\ ]
{88 
Type99 
=99 
type99 
;99 

Complaints:: 
=:: 

complaints:: 
;::  
	Diagnosis;; 
=;; 
	diagnosis;; 
;;; 
	Treatment<< 
=<< 
	treatment<< 
;<< 
}== 
}>> Ó
<D:\git\PolyclinicSystem\PolyclinicSystem\Classes\Feedback.cs
public 
class 
Feedback 
{ 
[ 

PrimaryKey 
, 
AutoIncrement 
] 
public 

int 
ID 
{ 
get 
; 
set 
; 
} 
[		 
NotNull		 
]		 
public

 

int

 
Rating

 
{

 
get

 
;

 
set

  
;

  !
}

" #
[ 
NotNull 
] 
public 

string 
Date 
{ 
get 
; 
set !
;! "
}# $
[ 
NotNull 
] 
public 

string 
Text 
{ 
get 
; 
set !
;! "
}# $
[ 

ForeignKey 
( 
typeof 
( 
Patient 
) 
)  
]  !
public 

int 
	PatientID 
{ 
get 
; 
set  #
;# $
}% &
[ 

ForeignKey 
( 
typeof 
( 
Doctor 
) 
) 
]  
public 

int 
DoctorID 
{ 
get 
; 
set "
;" #
}$ %
[ 
	ManyToOne 
] 
public 

Patient 
Patient 
{ 
get  
;  !
set" %
;% &
}' (
[ 
	ManyToOne 
] 
public 

Doctor 
Doctor 
{ 
get 
; 
set  #
;# $
}% &
} ú
;D:\git\PolyclinicSystem\PolyclinicSystem\Classes\Patient.cs
public 
class 
Patient 
{ 
[ 

PrimaryKey 
, 
AutoIncrement 
] 
public 

int 
	PatientID 
{ 
get 
; 
set  #
;# $
}% &
[

 
NotNull

 
,

 
	MaxLength

 
(

 
$num

 
)

 
]

 
public 

string 
Gender 
{ 
get 
; 
set  #
;# $
}% &
[ 
NotNull 
, 
	MaxLength 
( 
$num 
) 
] 
public 

string 
OMS 
{ 
get 
; 
set  
;  !
}" #
public 

string 
JobPlace 
{ 
get  
;  !
set" %
;% &
}' (
[ 
NotNull 
] 
public 

string 
Address 
{ 
get 
;  
set! $
;$ %
}& '
[ 
NotNull 
] 
public 

string 
	BirthDate 
{ 
get !
;! "
set# &
;& '
}( )
[ 
NotNull 
, 
	MaxLength 
( 
$num 
) 
] 
public 

string 
Phone 
{ 
get 
; 
set "
;" #
}$ %
[ 

ForeignKey 
( 
typeof 
( 
User 
) 
) 
] 
public 

int 
UserID 
{ 
get 
; 
set  
;  !
}" #
[ 
	ManyToOne 
] 
public 

User 
User 
{ 
get 
; 
set 
;  
}! "
[!! 
	OneToMany!! 
(!! 
CascadeOperations!!  
=!!! "
CascadeOperation!!# 3
.!!3 4
All!!4 7
)!!7 8
]!!8 9
public"" 

List"" 
<"" 
PatientCard"" 
>"" 
PatientCards"" )
{""* +
get"", /
;""/ 0
set""1 4
;""4 5
}""6 7
[$$ 
	OneToMany$$ 
($$ 
CascadeOperations$$  
=$$! "
CascadeOperation$$# 3
.$$3 4
All$$4 7
)$$7 8
]$$8 9
public%% 

List%% 
<%% 
Feedback%% 
>%% 
	Feedbacks%% #
{%%$ %
get%%& )
;%%) *
set%%+ .
;%%. /
}%%0 1
public'' 

void'' 
Edit'' 
('' 
string'' 
oms'' 
,''  
string''! '
jobplace''( 0
,''0 1
string''2 8
address''9 @
,''@ A
string''B H
phone''I N
)''N O
{(( 
OMS)) 
=)) 
oms)) 
;)) 
JobPlace** 
=** 
jobplace** 
;** 
Address++ 
=++ 
address++ 
;++ 
Phone,, 
=,, 
phone,, 
;,, 
}-- 
}.. û
?D:\git\PolyclinicSystem\PolyclinicSystem\Classes\PatientCard.cs
public 
class 
PatientCard 
{ 
[ 

PrimaryKey 
, 
AutoIncrement 
] 
public 

int 
CardID 
{ 
get 
; 
set  
;  !
}" #
[

 
Unique

 
,

 
NotNull

 
]

 
public 

string 

CardNumber 
{ 
get "
;" #
set$ '
;' (
}) *
[ 

ForeignKey 
( 
typeof 
( 
Patient 
) 
)  
]  !
public 

int 
	PatientID 
{ 
get 
; 
set  #
;# $
}% &
[ 
	ManyToOne 
] 
public 

Patient 
Patient 
{ 
get  
;  !
set" %
;% &
}' (
[ 
	OneToMany 
( 
CascadeOperations  
=! "
CascadeOperation# 3
.3 4
All4 7
)7 8
]8 9
public 

List 
< 
DoctorVisit 
> 
DoctorVisits )
{* +
get, /
;/ 0
set1 4
;4 5
}6 7
} Ä
=D:\git\PolyclinicSystem\PolyclinicSystem\Classes\Specialty.cs
public 
class 
	Specialty 
{ 
[ 

PrimaryKey 
, 
AutoIncrement 
] 
public 

int 
ID 
{ 
get 
; 
set 
; 
} 
[

 
NotNull

 
,

 
Unique

 
]

 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
[ 
	OneToMany 
( 
CascadeOperations  
=! "
CascadeOperation# 3
.3 4
All4 7
)7 8
]8 9
public 

List 
< 
Doctor 
> 
Doctors 
{  !
get" %
;% &
set' *
;* +
}, -
} ®
8D:\git\PolyclinicSystem\PolyclinicSystem\Classes\User.cs
public 
class 
User 
{ 
[ 

PrimaryKey 
, 
AutoIncrement 
] 
public 

int 
ID 
{ 
get 
; 
set 
; 
} 
[

 
Unique

 
]

 
public 

string 
Login 
{ 
get 
; 
set "
;" #
}$ %
[ 
NotNull 
] 
public 

string 
Name 
{ 
get 
; 
set !
;! "
}# $
[ 
NotNull 
] 
public 

string 
Email 
{ 
get 
; 
set "
;" #
}$ %
[ 
NotNull 
] 
public 

string 
Password 
{ 
get  
;  !
set" %
;% &
}' (
[ 
	OneToMany 
( 
CascadeOperations  
=! "
CascadeOperation# 3
.3 4
All4 7
)7 8
]8 9
public 

List 
< 
Administrator 
> 
Administrators -
{. /
get0 3
;3 4
set5 8
;8 9
}: ;
[ 
	OneToMany 
( 
CascadeOperations  
=! "
CascadeOperation# 3
.3 4
All4 7
)7 8
]8 9
public 

List 
< 
Patient 
> 
Patients !
{" #
get$ '
;' (
set) ,
;, -
}. /
[ 
	OneToMany 
( 
CascadeOperations  
=! "
CascadeOperation# 3
.3 4
All4 7
)7 8
]8 9
public 

List 
< 
Doctor 
> 
Doctors 
{  !
get" %
;% &
set' *
;* +
}, -
public 

void 
Edit 
( 
string 
name  
,  !
string" (
email) .
,. /
string0 6
password7 ?
,? @
stringA G
loginH M
)M N
{   
Name!! 
=!! 
name!! 
;!! 
Email"" 
="" 
email"" 
;"" 
Login## 
=## 
login## 
;## 
Password$$ 
=$$ 
password$$ 
;$$ 
}%% 
public'' 

void'' 
ChangePassword'' 
('' 
string'' %
newPassword''& 1
)''1 2
{(( 
Password)) 
=)) 
newPassword)) 
;)) 
}** 
}++ €
OD:\git\PolyclinicSystem\PolyclinicSystem\Forms\FeedbackForms\AddFeedbackForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
FeedbackForms! .
{ 
public 

partial 
class 
AddFeedbackForm (
:) *
Form+ /
{ 
private 
Doctor 
Doctor 
; 
private		 
Patient		 
Patient		 
;		  
public 
AddFeedbackForm 
( 
Doctor %
doctor& ,
,, -
Patient. 5
patient6 =
)= >
{ 	
InitializeComponent 
(  
)  !
;! "
Doctor 
= 
doctor 
; 
Patient 
= 
patient 
; 
} 	
private 
void 
confirmButton_Click (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{ 	
int 
value 
= 
$num 
; 
if 
( 
radioButton1 
. 
Checked $
)$ %
value 
= 
$num 
; 
else 
if 
( 
radioButton2 !
.! "
Checked" )
)) *
value 
= 
$num 
; 
else 
if 
( 
radioButton3 !
.! "
Checked" )
)) *
value 
= 
$num 
; 
else 
if 
( 
radioButton4 !
.! "
Checked" )
)) *
value 
= 
$num 
; 
else 
if 
( 
radioButton5 !
.! "
Checked" )
)) *
value 
= 
$num 
; 
if!! 
(!! 
value!! 
==!! 
$num!! 
)!! 
ErrorHandler"" 
."" 
	ShowError"" &
(""& '
$str""' :
)"": ;
;""; <
else## 
{$$ 
string%% 
text%% 
=%% 
textBox%% %
.%%% &
Text%%& *
;%%* +
try&& 
{'' 
bool(( 
result(( 
=((  !
FeedbackHandler((" 1
.((1 2
AddFeedback((2 =
(((= >
Doctor((> D
,((D E
Patient((F M
,((M N
value((O T
,((T U
text((V Z
)((Z [
;(([ \
if)) 
()) 
result)) 
))) 
{** 
MessagesHandler++ '
.++' (
ShowMessage++( 3
(++3 4
$str++4 L
)++L M
;++M N
Close,, 
(,, 
),, 
;,,  
}-- 
}.. 
catch// 
(// 
	Exception//  
ex//! #
)//# $
{00 
Logger11 
.11 
WriteLog11 #
(11# $
ex11$ &
)11& '
;11' (
Close22 
(22 
)22 
;22 
}33 
}44 
}55 	
}66 
}77 ∑
LD:\git\PolyclinicSystem\PolyclinicSystem\Forms\FeedbackForms\FeedbackForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
FeedbackForms! .
{ 
public 

partial 
class 
FeedbackForm %
:& '
Form( ,
{ 
private 
Feedback 
Feedback !
;! "
public

 
FeedbackForm

 
(

 
Feedback

 $
feedback

% -
)

- .
{ 	
InitializeComponent 
(  
)  !
;! "
Feedback 
= 
feedback 
;  
} 	
private 
void 
FeedbackForm_Load &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
try 
{ 
ratingLabel 
. 
Text  
=! "
$str# -
+. /
Feedback0 8
.8 9
Rating9 ?
.? @
ToString@ H
(H I
)I J
;J K
infoTextBox 
. 
Text  
=! "
Feedback# +
.+ ,
Text, 0
;0 1
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' R
)R S
;S T
Close 
( 
) 
; 
} 
} 	
} 
} ∆4
PD:\git\PolyclinicSystem\PolyclinicSystem\Forms\FeedbackForms\FeedbackListForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
FeedbackForms! .
{ 
public 

partial 
class 
FeedbackListForm )
:* +
Form, 0
{ 
private		 
	DataTable		 
dt		 
=		 
new		 "
	DataTable		# ,
(		, -
)		- .
;		. /
private 
Doctor 
Doctor 
; 
public 
FeedbackListForm 
(  
Doctor  &
doctor' -
)- .
{ 	
InitializeComponent 
(  
)  !
;! "
Doctor 
= 
doctor 
; 
} 	
private 
void !
FeedbackListForm_Load *
(* +
object+ 1
sender2 8
,8 9
	EventArgs: C
eD E
)E F
{ 	
try 
{ 
dt 
= 
FeedbackHandler $
.$ %
GetDataTable% 1
(1 2
)2 3
;3 4
if 
( 
( 
dt 
!= 
null 
)  
&&! #
($ %
dt% '
.' (
Columns( /
./ 0
Count0 5
>6 7
$num8 9
)9 :
): ;
{ 
feedbackDataGrid $
.$ %

DataSource% /
=0 1
dt2 4
;4 5
feedbackDataGrid $
.$ %
Columns% ,
[, -
$num- .
]. /
./ 0
AutoSizeMode0 <
== >*
DataGridViewAutoSizeColumnMode? ]
.] ^
DisplayedCells^ l
;l m
feedbackDataGrid $
.$ %
Columns% ,
[, -
$num- .
]. /
./ 0
AutoSizeMode0 <
== >*
DataGridViewAutoSizeColumnMode? ]
.] ^
DisplayedCells^ l
;l m
feedbackDataGrid $
.$ %
Columns% ,
[, -
$num- .
]. /
./ 0
AutoSizeMode0 <
== >*
DataGridViewAutoSizeColumnMode? ]
.] ^
DisplayedCells^ l
;l m
feedbackDataGrid   $
.  $ %
Columns  % ,
[  , -
$num  - .
]  . /
.  / 0
AutoSizeMode  0 <
=  = >*
DataGridViewAutoSizeColumnMode  ? ]
.  ] ^
Fill  ^ b
;  b c
feedbackDataGrid"" $
.""$ %
Columns""% ,
["", -
$num""- .
]"". /
.""/ 0
Visible""0 7
=""8 9
false"": ?
;""? @
feedbackDataGrid$$ $
.$$$ %

DataSource$$% /
=$$0 1
FeedbackHandler$$2 A
.$$A B
FillData$$B J
($$J K
Doctor$$K Q
,$$Q R
dt$$S U
)$$U V
;$$V W
}%% 
else&& 
throw'' 
new'' 
	Exception'' '
(''' (
$str''( F
)''F G
;''G H
}(( 
catch)) 
()) 
	Exception)) 
ex)) 
)))  
{** 
Logger++ 
.++ 
WriteLog++ 
(++  
ex++  "
)++" #
;++# $
ErrorHandler,, 
.,, 
	ShowError,, &
(,,& '
ex,,' )
.,,) *
Message,,* 1
),,1 2
;,,2 3
Close-- 
(-- 
)-- 
;-- 
}.. 
}// 	
private22 
void22 
ShowFeedbackForm22 %
(22% &
DataGridViewRow22& 5
row226 9
)229 :
{33 	
if44 
(44 
row44 
.44 
Cells44 
[44 
$num44 
]44 
.44 
Value44 "
!=44# %
null44& *
)44* +
{55 
int66 
ID66 
=66 
Convert66  
.66  !
ToInt3266! (
(66( )
row66) ,
.66, -
Cells66- 2
[662 3
$num663 4
]664 5
.665 6
Value666 ;
.66; <
ToString66< D
(66D E
)66E F
)66F G
;66G H
Feedback99 
feedback99 !
=99" #
DataHandler99$ /
.99/ 0
GetFeedback990 ;
(99; <
ID99< >
)99> ?
;99? @
FeedbackForm<< 
feedbackForm<< )
=<<* +
new<<, /
FeedbackForm<<0 <
(<<< =
feedback<<= E
)<<E F
;<<F G
feedbackForm== 
.== 
Show== !
(==! "
)==" #
;==# $
}>> 
else?? 
MessagesHandler@@ 
.@@  
ShowMessage@@  +
(@@+ ,
$str@@, =
)@@= >
;@@> ?
}AA 	
privateCC 
voidCC $
showFeedbackButton_ClickCC -
(CC- .
objectCC. 4
senderCC5 ;
,CC; <
	EventArgsCC= F
eCCG H
)CCH I
{DD 	
ifEE 
(EE 
feedbackDataGridEE  
.EE  !
SelectedRowsEE! -
.EE- .
CountEE. 3
>EE4 5
$numEE6 7
)EE7 8
{FF 
DataGridViewRowGG 
rowGG  #
=GG$ %
feedbackDataGridGG& 6
.GG6 7
SelectedRowsGG7 C
[GGC D
$numGGD E
]GGE F
;GGF G
ShowFeedbackFormHH  
(HH  !
rowHH! $
)HH$ %
;HH% &
}II 
elseJJ 
ifJJ 
(JJ 
feedbackDataGridJJ %
.JJ% &
SelectedCellsJJ& 3
.JJ3 4
CountJJ4 9
>JJ: ;
$numJJ< =
)JJ= >
{KK 
DataGridViewRowLL 
rowLL  #
=LL$ %
feedbackDataGridLL& 6
.LL6 7
SelectedCellsLL7 D
[LLD E
$numLLE F
]LLF G
.LLG H
	OwningRowLLH Q
;LLQ R
ShowFeedbackFormMM  
(MM  !
rowMM! $
)MM$ %
;MM% &
}NN 
elseOO 
MessagesHandlerPP 
.PP  
ShowMessagePP  +
(PP+ ,
$strPP, =
)PP= >
;PP> ?
}QQ 	
}RR 
}SS Ä"
DD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\AddDoctorForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
AddDoctorForm &
:' (
Form) -
{ 
public		 
AddDoctorForm		 
(		 
)		 
{

 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
AddDoctorForm_Load '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
try 
{ 
List 
< 
	Specialty 
> 
specialties  +
=, -
new. 1
List2 6
<6 7
	Specialty7 @
>@ A
(A B
)B C
;C D
specialties 
= 
DataHandler )
.) *
GetSpecialties* 8
(8 9
)9 :
;: ;
foreach 
( 
	Specialty "
	specialty# ,
in- /
specialties0 ;
); <
specialtyComboBox %
.% &
Items& +
.+ ,
Add, /
(/ 0
	specialty0 9
.9 :
Name: >
)> ?
;? @
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' 9
)9 :
;: ;
Close 
( 
) 
; 
} 
} 	
private!! 
void!! 
confirmButton_Click!! (
(!!( )
object!!) /
sender!!0 6
,!!6 7
	EventArgs!!8 A
e!!B C
)!!C D
{"" 	
if$$ 
($$ 
specialtyComboBox$$ !
.$$! "
SelectedItem$$" .
==$$/ 1
null$$2 6
)$$6 7
ErrorHandler%% 
.%% 
	ShowError%% &
(%%& '
$str%%' A
)%%A B
;%%B C
else&& 
{'' 
string(( 
	specialty((  
=((! "
specialtyComboBox((# 4
.((4 5
SelectedItem((5 A
.((A B
ToString((B J
(((J K
)((K L
;((L M
string)) 
login)) 
=)) 
loginTextBox)) +
.))+ ,
Text)), 0
;))0 1
string** 
password** 
=**  !
passwordTextBox**" 1
.**1 2
Text**2 6
;**6 7
string++ 
name++ 
=++ 
nameTextBox++ )
.++) *
Text++* .
;++. /
string,, 
email,, 
=,, 
emailTextBox,, +
.,,+ ,
Text,,, 0
;,,0 1
try.. 
{// 
bool00 
result00 
=00  !
ProfilesHandler00" 1
.001 2
	AddDoctor002 ;
(00; <
login00< A
,00A B
name00C G
,00G H
email00I N
,00N O
password00P X
,00X Y
	specialty00Z c
)00c d
;00d e
if11 
(11 
result11 
)11 
{22 
MessagesHandler33 '
.33' (
ShowMessage33( 3
(333 4
$str334 I
)33I J
;33J K
Close44 
(44 
)44 
;44  
}55 
}66 
catch77 
(77 
	Exception77 
ex77  "
)77" #
{88 
Logger99 
.99 
WriteLog99 #
(99# $
ex99$ &
)99& '
;99' (
ErrorHandler::  
.::  !
	ShowError::! *
(::* +
$str::+ N
)::N O
;::O P
Close;; 
(;; 
);; 
;;; 
}<< 
}== 
}>> 	
}?? 
}@@ ∆9
FD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\DoctorsListForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
DoctorsListForm (
:) *
Form+ /
{ 
private		 
	DataTable		 
dt		 
=		 
new		 "
	DataTable		# ,
(		, -
)		- .
;		. /
public 
DoctorsListForm 
( 
)  
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void  
DoctorsListForm_Load )
() *
object* 0
sender1 7
,7 8
	EventArgs9 B
eC D
)D E
{ 	
try 
{ 
dt 
= 
DoctorsHandler #
.# $
GetDataTable$ 0
(0 1
)1 2
;2 3
if 
( 
( 
dt 
!= 
null 
)  
&&! #
($ %
dt% '
.' (
Columns( /
./ 0
Count0 5
>6 7
$num8 9
)9 :
): ;
{ 
doctorsDataGrid #
.# $

DataSource$ .
=/ 0
dt1 3
;3 4
doctorsDataGrid #
.# $
Columns$ +
[+ ,
$num, -
]- .
.. /
AutoSizeMode/ ;
=< =*
DataGridViewAutoSizeColumnMode> \
.\ ]
DisplayedCells] k
;k l
doctorsDataGrid #
.# $
Columns$ +
[+ ,
$num, -
]- .
.. /
AutoSizeMode/ ;
=< =*
DataGridViewAutoSizeColumnMode> \
.\ ]
DisplayedCells] k
;k l
doctorsDataGrid #
.# $
Columns$ +
[+ ,
$num, -
]- .
.. /
AutoSizeMode/ ;
=< =*
DataGridViewAutoSizeColumnMode> \
.\ ]
Fill] a
;a b
doctorsDataGrid #
.# $
Columns$ +
[+ ,
$num, -
]- .
.. /
Visible/ 6
=7 8
false9 >
;> ?
doctorsDataGrid!! #
.!!# $

DataSource!!$ .
=!!/ 0
DoctorsHandler!!1 ?
.!!? @
FillData!!@ H
(!!H I
dt!!I K
)!!K L
;!!L M
}"" 
else## 
throw$$ 
new$$ 
	Exception$$ '
($$' (
$str$$( F
)$$F G
;$$G H
}%% 
catch&& 
(&& 
	Exception&& 
ex&& 
)&&  
{'' 
Logger(( 
.(( 
WriteLog(( 
(((  
ex((  "
)((" #
;((# $
ErrorHandler)) 
.)) 
	ShowError)) &
())& '
ex))' )
.))) *
Message))* 1
)))1 2
;))2 3
Close** 
(** 
)** 
;** 
}++ 
},, 	
private// 
void// 
searchButton_Click// '
(//' (
object//( .
sender/// 5
,//5 6
	EventArgs//7 @
e//A B
)//B C
{00 	
string11 
query11 
=11 
searchTextBox11 (
.11( )
Text11) -
;11- .
doctorsDataGrid33 
.33 

DataSource33 &
=33' (
DoctorsHandler33) 7
.337 8
Search338 >
(33> ?
query33? D
,33D E
dt33F H
)33H I
;33I J
}44 	
private77 
void77 
ShowDoctorForm77 #
(77# $
DataGridViewRow77$ 3
row774 7
)777 8
{88 	
if99 
(99 
row99 
.99 
Cells99 
[99 
$num99 
]99 
.99 
Value99 "
!=99# %
null99& *
)99* +
{:: 
int;; 
ID;; 
=;; 
Convert;;  
.;;  !
ToInt32;;! (
(;;( )
row;;) ,
.;;, -
Cells;;- 2
[;;2 3
$num;;3 4
];;4 5
.;;5 6
Value;;6 ;
.;;; <
ToString;;< D
(;;D E
);;E F
);;F G
;;;G H
Doctor>> 
doctor>> 
=>> 
DataHandler>>  +
.>>+ ,
	GetDoctor>>, 5
(>>5 6
ID>>6 8
)>>8 9
;>>9 :
DoctorInfoFormAA 
doctorInfoFormAA -
=AA. /
newAA0 3
DoctorInfoFormAA4 B
(AAB C
doctorAAC I
)AAI J
;AAJ K
doctorInfoFormBB 
.BB 

FormClosedBB )
+=BB* ,%
DoctorInfoForm_FormClosedBB- F
;BBF G
doctorInfoFormCC 
.CC 
ShowCC #
(CC# $
)CC$ %
;CC% &
}DD 
elseEE 
MessagesHandlerFF 
.FF  
ShowMessageFF  +
(FF+ ,
$strFF, <
)FF< =
;FF= >
}GG 	
privateJJ 
voidJJ 
infoButton_ClickJJ %
(JJ% &
objectJJ& ,
senderJJ- 3
,JJ3 4
	EventArgsJJ5 >
eJJ? @
)JJ@ A
{KK 	
ifLL 
(LL 
doctorsDataGridLL 
.LL  
SelectedRowsLL  ,
.LL, -
CountLL- 2
>LL3 4
$numLL5 6
)LL6 7
{MM 
DataGridViewRowOO 
rowOO  #
=OO$ %
doctorsDataGridOO& 5
.OO5 6
SelectedRowsOO6 B
[OOB C
$numOOC D
]OOD E
;OOE F
ShowDoctorFormPP 
(PP 
rowPP "
)PP" #
;PP# $
}QQ 
elseRR 
ifRR 
(RR 
doctorsDataGridRR $
.RR$ %
SelectedCellsRR% 2
.RR2 3
CountRR3 8
>RR9 :
$numRR; <
)RR< =
{SS 
DataGridViewRowTT 
rowTT  #
=TT$ %
doctorsDataGridTT& 5
.TT5 6
SelectedCellsTT6 C
[TTC D
$numTTD E
]TTE F
.TTF G
	OwningRowTTG P
;TTP Q
ShowDoctorFormUU 
(UU 
rowUU "
)UU" #
;UU# $
}VV 
elseWW 
MessagesHandlerXX 
.XX  
ShowMessageXX  +
(XX+ ,
$strXX, D
)XXD E
;XXE F
}YY 	
private\\ 
void\\ %
DoctorInfoForm_FormClosed\\ .
(\\. /
object\\/ 5
sender\\6 <
,\\< =
FormClosedEventArgs\\> Q
e\\R S
)\\S T
{]] 	
doctorsDataGrid^^ 
.^^ 

DataSource^^ &
=^^' (
DoctorsHandler^^) 7
.^^7 8
FillData^^8 @
(^^@ A
dt^^A C
)^^C D
;^^D E
}__ 	
}`` 
}aa Ä
CD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\EditUserForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
EditUserForm %
:& '
Form( ,
{ 
private 
User 
EditUser 
; 
public

 
EditUserForm

 
(

 
User

  
user

! %
)

% &
{ 	
InitializeComponent 
(  
)  !
;! "
EditUser 
= 
user 
; 
} 	
private 
void 
EditUserForm_Load &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
try 
{ 
loginTextBox 
. 
Text !
=" #
EditUser$ ,
., -
Login- 2
;2 3
emailTextBox 
. 
Text !
=" #
EditUser$ ,
., -
Email- 2
;2 3
nameTextBox 
. 
Text  
=! "
EditUser# +
.+ ,
Name, 0
;0 1
passwordTextBox 
.  
Text  $
=% &
EditUser' /
./ 0
Password0 8
;8 9
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' J
)J K
;K L
Close 
( 
) 
; 
} 
} 	
private"" 
void"" 
confirmButton_Click"" (
(""( )
object"") /
sender""0 6
,""6 7
	EventArgs""8 A
e""B C
)""C D
{## 	
string%% 
login%% 
=%% 
loginTextBox%% '
.%%' (
Text%%( ,
;%%, -
string&& 
email&& 
=&& 
emailTextBox&& '
.&&' (
Text&&( ,
;&&, -
string'' 
name'' 
='' 
nameTextBox'' %
.''% &
Text''& *
;''* +
string(( 
password(( 
=(( 
passwordTextBox(( -
.((- .
Text((. 2
;((2 3
try** 
{++ 
bool,, 
result,, 
=,, 
ProfilesHandler,, -
.,,- .
EditUser,,. 6
(,,6 7
EditUser,,7 ?
,,,? @
login,,A F
,,,F G
email,,H M
,,,M N
name,,O S
,,,S T
password,,U ]
),,] ^
;,,^ _
if-- 
(-- 
result-- 
)-- 
{.. 
MessagesHandler// #
.//# $
ShowMessage//$ /
(/// 0
$str//0 M
)//M N
;//N O
Close00 
(00 
)00 
;00 
}11 
}22 
catch33 
(33 
	Exception33 
ex33 
)33  
{44 
Logger55 
.55 
WriteLog55 
(55  
ex55  "
)55" #
;55# $
ErrorHandler66 
.66 
	ShowError66 &
(66& '
$str66' G
)66G H
;66H I
Close77 
(77 
)77 
;77 
}88 
}99 	
}:: 
};; ª3
HD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\DoctorsHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
public 

static 
class 
DoctorsHandler &
{		 
static 
public 
	DataTable 
GetDataTable  ,
(, -
)- .
{ 	
	DataTable 
dt 
= 
new 
	DataTable (
(( )
)) *
;* +
try 
{ 
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 2
,2 3
typeof4 :
(: ;
int; >
)> ?
)? @
)@ A
;A B
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. =
,= >
typeof? E
(E F
stringF L
)L M
)M N
)N O
;O P
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 3
,3 4
typeof5 ;
(; <
string< B
)B C
)C D
)D E
;E F
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
return 
null 
; 
} 
return 
dt 
; 
} 	
static 
public 
	DataTable 
FillData  (
(( )
	DataTable) 2
dt3 5
)5 6
{   	
dt!! 
.!! 
Rows!! 
.!! 
Clear!! 
(!! 
)!! 
;!! 
try## 
{$$ 
List%% 
<%% 
Doctor%% 
>%% 
doctors%% $
=%%% &
new%%' *
List%%+ /
<%%/ 0
Doctor%%0 6
>%%6 7
(%%7 8
)%%8 9
;%%9 :
doctors&& 
=&& 
DataHandler&& %
.&&% &

GetDoctors&&& 0
(&&0 1
)&&1 2
;&&2 3
foreach(( 
((( 
Doctor(( 
doctor(( %
in((& (
doctors(() 0
)((0 1
{)) 
int** 
id** 
=** 
doctor** #
.**# $
DoctorID**$ ,
;**, -
string++ 
name++ 
=++  !
doctor++" (
.++( )
User++) -
.++- .
Name++. 2
;++2 3
string,, 
	specialty,, $
=,,% &
doctor,,' -
.,,- .
	Specialty,,. 7
.,,7 8
Name,,8 <
;,,< =
dt.. 
... 
Rows.. 
... 
Add.. 
(..  
id..  "
,.." #
	specialty..$ -
,..- .
name../ 3
)..3 4
;..4 5
}// 
return11 
dt11 
;11 
}22 
catch33 
(33 
	Exception33 
ex33 
)33  
{44 
Logger55 
.55 
WriteLog55 
(55  
ex55  "
)55" #
;55# $
return66 
null66 
;66 
}77 
}88 	
static;; 
public;; 
	DataTable;; 
Search;;  &
(;;& '
string;;' -
query;;. 3
,;;3 4
	DataTable;;5 >
dt;;? A
);;A B
{<< 	
if>> 
(>> 
(>> 
query>> 
==>> 
$str>> 
)>> 
||>>  
(>>! "
query>>" '
==>>( *
null>>+ /
)>>/ 0
)>>0 1
return?? 
FillData?? 
(??  
dt??  "
)??" #
;??# $
stringBB 
[BB 
]BB 

queryPartsBB 
=BB  !
queryBB" '
.BB' (
SplitBB( -
(BB- .
$charBB. 1
)BB1 2
;BB2 3
foreachDD 
(DD 
stringDD 
qryDD 
inDD  "

queryPartsDD# -
)DD- .
{EE 
ifFF 
(FF 
	ValidatorFF 
.FF 
IsSpecialtyFF )
(FF) *
qryFF* -
)FF- .
)FF. /
dtGG 
=GG 

FilterDataGG #
(GG# $
dtGG$ &
,GG& '
$strGG( 7
,GG7 8
qryGG9 <
)GG< =
;GG= >
elseHH 
dtHH 
=HH 

FilterDataHH $
(HH$ %
dtHH% '
,HH' (
$strHH) .
,HH. /
qryHH0 3
)HH3 4
;HH4 5
}II 
returnKK 
dtKK 
;KK 
}LL 	
staticOO 
privateOO 
	DataTableOO  

FilterDataOO! +
(OO+ ,
	DataTableOO, 5
tableOO6 ;
,OO; <
stringOO= C
fieldOOD I
,OOI J
stringOOK Q
valueOOR W
)OOW X
{PP 	
tryQQ 
{RR 
tableSS 
=SS 
tableSS 
.SS 
AsEnumerableSS *
(SS* +
)SS+ ,
.TT 
WhereTT 
(TT 
rowTT 
=>TT 
rowTT !
.TT! "
FieldTT" '
<TT' (
stringTT( .
>TT. /
(TT/ 0
fieldTT0 5
)TT5 6
==TT7 9
valueTT: ?
)TT? @
.UU 
CopyToDataTableUU  
(UU  !
)UU! "
;UU" #
returnVV 
tableVV 
;VV 
}WW 
catchXX 
(XX 
	ExceptionXX 
exXX 
)XX  
{YY 
LoggerZZ 
.ZZ 
WriteLogZZ 
(ZZ  
exZZ  "
)ZZ" #
;ZZ# $
	DataTable[[ 
dt[[ 
=[[ 
table[[ $
.[[$ %
Clone[[% *
([[* +
)[[+ ,
;[[, -
return\\ 
dt\\ 
;\\ 
}]] 
}^^ 	
}__ 
}`` ¡5
ID:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\FeedbackHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
FeedbackHandler '
{ 
static

 
public

 
	DataTable

 
GetDataTable

  ,
(

, -
)

- .
{ 	
	DataTable 
dt 
= 
new 
	DataTable (
(( )
)) *
;* +
try 
{ 
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 2
,2 3
typeof4 :
(: ;
int; >
)> ?
)? @
)@ A
;A B
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 4
,4 5
typeof6 <
(< =
string= C
)C D
)D E
)E F
;F G
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. <
,< =
typeof> D
(D E
stringE K
)K L
)L M
)M N
;N O
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 9
,9 :
typeof; A
(A B
stringB H
)H I
)I J
)J K
;K L
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
return 
null 
; 
} 
return 
dt 
; 
} 	
static 
public 
	DataTable 
FillData  (
(( )
Doctor) /
doctor0 6
,6 7
	DataTable8 A
dtB D
)D E
{   	
dt!! 
.!! 
Rows!! 
.!! 
Clear!! 
(!! 
)!! 
;!! 
try## 
{$$ 
List%% 
<%% 
Feedback%% 
>%% 
	feedbacks%% (
=%%) *
new%%+ .
List%%/ 3
<%%3 4
Feedback%%4 <
>%%< =
(%%= >
)%%> ?
;%%? @
	feedbacks&& 
=&& 
doctor&& "
.&&" #
	Feedbacks&&# ,
;&&, -
foreach(( 
((( 
Feedback(( !
feedback((" *
in((+ -
	feedbacks((. 7
)((7 8
{)) 
int** 
id** 
=** 
feedback** %
.**% &
ID**& (
;**( )
string++ 
date++ 
=++  !
feedback++" *
.++* +
Date+++ /
;++/ 0
string,, 
docName,, "
=,,# $
DataHandler,,% 0
.,,0 1
	GetDoctor,,1 :
(,,: ;
feedback,,; C
.,,C D
DoctorID,,D L
),,L M
.,,M N
User,,N R
.,,R S
Name,,S W
;,,W X
string-- 
patName-- "
=--# $
DataHandler--% 0
.--0 1

GetPatient--1 ;
(--; <
feedback--< D
.--D E
	PatientID--E N
,--N O
true--P T
)--T U
.--U V
User--V Z
.--Z [
Name--[ _
;--_ `
dt// 
.// 
Rows// 
.// 
Add// 
(//  
id//  "
,//" #
date//$ (
,//( )
patName//* 1
,//1 2
docName//3 :
)//: ;
;//; <
}00 
}11 
catch22 
(22 
	Exception22 
ex22 
)22  
{33 
Logger44 
.44 
WriteLog44 
(44  
ex44  "
)44" #
;44# $
return55 
null55 
;55 
}66 
return88 
dt88 
;88 
}99 	
static;; 
public;; 
bool;; 
AddFeedback;; &
(;;& '
Doctor;;' -
doctor;;. 4
,;;4 5
Patient;;6 =
patient;;> E
,;;E F
int;;G J
value;;K P
,;;P Q
string;;R X
text;;Y ]
);;] ^
{<< 	
bool== 
result== 
=== 
false== 
;==  
if?? 
(?? 
IsEmpty?? 
(?? 
text?? 
)?? 
)?? 
ErrorHandler@@ 
.@@ 
	ShowError@@ &
(@@& '
$str@@' ?
)@@? @
;@@@ A
elseAA 
{BB 
tryCC 
{DD 
stringEE 
dateEE 
=EE  !
DateTimeEE" *
.EE* +
TodayEE+ 0
.EE0 1
ToStringEE1 9
(EE9 :
$strEE: F
)EEF G
;EEG H
DataHandlerFF 
.FF  
AddFeedbackFF  +
(FF+ ,
doctorFF, 2
.FF2 3
UserFF3 7
.FF7 8
LoginFF8 =
,FF= >
patientFF? F
.FFF G
UserFFG K
.FFK L
LoginFFL Q
,FFQ R
valueFFS X
,FFX Y
dateFFZ ^
,FF^ _
textFF` d
)FFd e
;FFe f
}GG 
catchHH 
(HH 
	ExceptionHH  
exHH! #
)HH# $
{II 
LoggerJJ 
.JJ 
WriteLogJJ #
(JJ# $
exJJ$ &
)JJ& '
;JJ' (
ErrorHandlerKK  
.KK  !
	ShowErrorKK! *
(KK* +
$strKK+ G
)KKG H
;KKH I
}LL 
}MM 
returnOO 
resultOO 
;OO 
}PP 	
staticRR 
privateRR 
boolRR 
IsEmptyRR #
(RR# $
stringRR$ *
valueRR+ 0
)RR0 1
{SS 	
ifTT 
(TT 
(TT 
valueTT 
==TT 
nullTT 
)TT 
||TT  "
(TT# $
valueTT$ )
==TT* ,
$strTT- /
)TT/ 0
)TT0 1
returnUU 
trueUU 
;UU 
elseVV 
returnVV 
falseVV 
;VV 
}WW 	
}XX 
}YY ›6
FD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\UsersHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
public 

static 
class 
UsersHandler $
{		 
static 
public 
	DataTable 
GetDataTable  ,
(, -
)- .
{ 	
	DataTable 
dt 
= 
new 
	DataTable (
(( )
)) *
;* +
try 
{ 
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 2
,2 3
typeof4 :
(: ;
int; >
)> ?
)? @
)@ A
;A B
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 3
,3 4
typeof5 ;
(; <
string< B
)B C
)C D
)D E
;E F
dt 
. 
Columns 
. 
Add 
( 
new "

DataColumn# -
(- .
$str. 3
,3 4
typeof5 ;
(; <
string< B
)B C
)C D
)D E
;E F
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
return 
null 
; 
} 
return 
dt 
; 
} 	
static 
public 
	DataTable 
FillData  (
(( )
	DataTable) 2
dt3 5
)5 6
{   	
dt!! 
.!! 
Rows!! 
.!! 
Clear!! 
(!! 
)!! 
;!! 
try## 
{$$ 
List%% 
<%% 
User%% 
>%% 
users%%  
=%%! "
new%%# &
List%%' +
<%%+ ,
User%%, 0
>%%0 1
(%%1 2
)%%2 3
;%%3 4
users&& 
=&& 
DataHandler&& #
.&&# $
GetUsers&&$ ,
(&&, -
)&&- .
;&&. /
foreach(( 
((( 
User(( 
user(( "
in((# %
users((& +
)((+ ,
{)) 
int** 
id** 
=** 
user** !
.**! "
ID**" $
;**$ %
string++ 
name++ 
=++  !
user++" &
.++& '
Name++' +
;+++ ,
string,, 
type,, 
=,,  !
$str,," $
;,,$ %
if-- 
(-- 
user-- 
.-- 
Patients-- %
.--% &
Count--& +
>--, -
$num--. /
)--/ 0
type.. 
=.. 
$str.. (
;..( )
else// 
if// 
(// 
user// !
.//! "
Doctors//" )
.//) *
Count//* /
>//0 1
$num//2 3
)//3 4
type00 
=00 
$str00 '
;00' (
else11 
type11 
=11 
$str11  /
;11/ 0
dt33 
.33 
Rows33 
.33 
Add33 
(33  
id33  "
,33" #
type33$ (
,33( )
name33* .
)33. /
;33/ 0
}44 
return66 
dt66 
;66 
}77 
catch88 
(88 
	Exception88 
ex88 
)88  
{99 
Logger:: 
.:: 
WriteLog:: 
(::  
ex::  "
)::" #
;::# $
return;; 
null;; 
;;; 
}<< 
}== 	
static@@ 
public@@ 
	DataTable@@ 
Search@@  &
(@@& '
string@@' -
query@@. 3
,@@3 4
	DataTable@@5 >
dt@@? A
)@@A B
{AA 	
ifCC 
(CC 
(CC 
queryCC 
==CC 
$strCC 
)CC 
||CC  
(CC! "
queryCC" '
==CC( *
nullCC+ /
)CC/ 0
)CC0 1
returnDD 
FillDataDD 
(DD  
dtDD  "
)DD" #
;DD# $
stringGG 
[GG 
]GG 

queryPartsGG 
=GG  !
queryGG" '
.GG' (
SplitGG( -
(GG- .
$charGG. 1
)GG1 2
;GG2 3
foreachII 
(II 
stringII 
qryII 
inII !

queryPartsII" ,
)II, -
{JJ 
ifKK 
(KK 
	ValidatorKK 
.KK 
IsTypeKK $
(KK$ %
qryKK% (
)KK( )
)KK) *
dtLL 
=LL 

FilterDataLL #
(LL# $
dtLL$ &
,LL& '
$strLL( -
,LL- .
qryLL/ 2
)LL2 3
;LL3 4
elseMM 
dtMM 
=MM 

FilterDataMM $
(MM$ %
dtMM% '
,MM' (
$strMM) .
,MM. /
qryMM0 3
)MM3 4
;MM4 5
}NN 
returnPP 
dtPP 
;PP 
}QQ 	
staticTT 
privateTT 
	DataTableTT  

FilterDataTT! +
(TT+ ,
	DataTableTT, 5
tableTT6 ;
,TT; <
stringTT= C
fieldTTD I
,TTI J
stringTTK Q
valueTTR W
)TTW X
{UU 	
tryVV 
{WW 
tableXX 
=XX 
tableXX 
.XX 
AsEnumerableXX *
(XX* +
)XX+ ,
.YY 
WhereYY 
(YY 
rowYY 
=>YY 
rowYY !
.YY! "
FieldYY" '
<YY' (
stringYY( .
>YY. /
(YY/ 0
fieldYY0 5
)YY5 6
==YY7 9
valueYY: ?
)YY? @
.ZZ 
CopyToDataTableZZ  
(ZZ  !
)ZZ! "
;ZZ" #
return[[ 
table[[ 
;[[ 
}\\ 
catch]] 
(]] 
	Exception]] 
ex]] 
)]]  
{^^ 
Logger__ 
.__ 
WriteLog__ 
(__  
ex__  "
)__" #
;__# $
	DataTable`` 
dt`` 
=`` 
table`` $
.``$ %
Clone``% *
(``* +
)``+ ,
;``, -
returnaa 
dtaa 
;aa 
}bb 
}cc 	
}dd 
}ee ®A
DD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\UsersListForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
UsersListForm &
:' (
Form) -
{ 
private		 
	DataTable		 
dt		 
=		 
new		 "
	DataTable		# ,
(		, -
)		- .
;		. /
public 
UsersListForm 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
UsersListForm_Load '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
try 
{ 
dt 
= 
UsersHandler !
.! "
GetDataTable" .
(. /
)/ 0
;0 1
if 
( 
( 
dt 
!= 
null 
)  
&&! #
($ %
dt% '
.' (
Columns( /
./ 0
Count0 5
>6 7
$num8 9
)9 :
): ;
{ 
usersDataGrid !
.! "

DataSource" ,
=- .
dt/ 1
;1 2
usersDataGrid !
.! "
Columns" )
[) *
$num* +
]+ ,
., -
AutoSizeMode- 9
=: ;*
DataGridViewAutoSizeColumnMode< Z
.Z [
DisplayedCells[ i
;i j
usersDataGrid !
.! "
Columns" )
[) *
$num* +
]+ ,
., -
AutoSizeMode- 9
=: ;*
DataGridViewAutoSizeColumnMode< Z
.Z [
DisplayedCells[ i
;i j
usersDataGrid !
.! "
Columns" )
[) *
$num* +
]+ ,
., -
AutoSizeMode- 9
=: ;*
DataGridViewAutoSizeColumnMode< Z
.Z [
Fill[ _
;_ `
usersDataGrid   !
.  ! "
Columns  " )
[  ) *
$num  * +
]  + ,
.  , -
Visible  - 4
=  5 6
false  7 <
;  < =
usersDataGrid"" !
.""! "

DataSource""" ,
=""- .
UsersHandler""/ ;
.""; <
FillData""< D
(""D E
dt""E G
)""G H
;""H I
}## 
else$$ 
throw%% 
new%% 
	Exception%% '
(%%' (
$str%%( F
)%%F G
;%%G H
}&& 
catch'' 
('' 
	Exception'' 
ex'' 
)''  
{(( 
Logger)) 
.)) 
WriteLog)) 
())  
ex))  "
)))" #
;))# $
ErrorHandler** 
.** 
	ShowError** &
(**& '
ex**' )
.**) *
Message*** 1
)**1 2
;**2 3
Close++ 
(++ 
)++ 
;++ 
},, 
}-- 	
private00 
void00 
searchButton_Click00 '
(00' (
object00( .
sender00/ 5
,005 6
	EventArgs007 @
e00A B
)00B C
{11 	
string22 
query22 
=22 
searchTextBox22 (
.22( )
Text22) -
;22- .
usersDataGrid44 
.44 

DataSource44 $
=44% &
UsersHandler44' 3
.443 4
Search444 :
(44: ;
query44; @
,44@ A
dt44B D
)44D E
;44E F
}55 	
private88 
void88 
ShowUserForm88 !
(88! "
DataGridViewRow88" 1
row882 5
)885 6
{99 	
if:: 
(:: 
row:: 
.:: 
Cells:: 
[:: 
$num:: 
]:: 
.:: 
Value:: "
!=::# %
null::& *
)::* +
{;; 
int<< 
ID<< 
=<< 
Convert<<  
.<<  !
ToInt32<<! (
(<<( )
row<<) ,
.<<, -
Cells<<- 2
[<<2 3
$num<<3 4
]<<4 5
.<<5 6
Value<<6 ;
.<<; <
ToString<<< D
(<<D E
)<<E F
)<<F G
;<<G H
User?? 
user?? 
=?? 
DataHandler?? '
.??' (
GetUser??( /
(??/ 0
ID??0 2
)??2 3
;??3 4
UserInfoFormBB 
userInfoFormBB )
=BB* +
newBB, /
UserInfoFormBB0 <
(BB< =
userBB= A
)BBA B
;BBB C
userInfoFormCC 
.CC 

FormClosedCC '
+=CC( *#
UserInfoForm_FormClosedCC+ B
;CCB C
userInfoFormDD 
.DD 
ShowDD !
(DD! "
)DD" #
;DD# $
}EE 
elseFF 
MessagesHandlerGG 
.GG  
ShowMessageGG  +
(GG+ ,
$strGG, D
)GGD E
;GGE F
}HH 	
privateKK 
voidKK 
infoButton_ClickKK %
(KK% &
objectKK& ,
senderKK- 3
,KK3 4
	EventArgsKK5 >
eKK? @
)KK@ A
{LL 	
ifMM 
(MM 
usersDataGridMM 
.MM 
SelectedRowsMM *
.MM* +
CountMM+ 0
>MM1 2
$numMM3 4
)MM4 5
{NN 
DataGridViewRowPP 
rowPP  #
=PP$ %
usersDataGridPP& 3
.PP3 4
SelectedRowsPP4 @
[PP@ A
$numPPA B
]PPB C
;PPC D
ShowUserFormQQ 
(QQ 
rowQQ  
)QQ  !
;QQ! "
}RR 
elseSS 
ifSS 
(SS 
usersDataGridSS "
.SS" #
SelectedCellsSS# 0
.SS0 1
CountSS1 6
>SS7 8
$numSS9 :
)SS: ;
{TT 
DataGridViewRowUU 
rowUU  #
=UU$ %
usersDataGridUU& 3
.UU3 4
SelectedCellsUU4 A
[UUA B
$numUUB C
]UUC D
.UUD E
	OwningRowUUE N
;UUN O
ShowUserFormVV 
(VV 
rowVV  
)VV  !
;VV! "
}WW 
elseXX 
MessagesHandlerYY 
.YY  
ShowMessageYY  +
(YY+ ,
$strYY, D
)YYD E
;YYE F
}ZZ 	
private]] 
void]] #
UserInfoForm_FormClosed]] ,
(]], -
object]]- 3
sender]]4 :
,]]: ;
FormClosedEventArgs]]< O
e]]P Q
)]]Q R
{^^ 	
usersDataGrid__ 
.__ 

DataSource__ $
=__% &
UsersHandler__' 3
.__3 4
FillData__4 <
(__< =
dt__= ?
)__? @
;__@ A
}`` 	
privatecc 
voidcc 
addUser_Clickcc "
(cc" #
objectcc# )
sendercc* 0
,cc0 1
	EventArgscc2 ;
ecc< =
)cc= >
{dd 	
AddDoctorFormee 
addDoctorFormee '
=ee( )
newee* -
AddDoctorFormee. ;
(ee; <
)ee< =
;ee= >
addDoctorFormff 
.ff 

FormClosedff $
+=ff% '$
AddDoctorForm_FormClosedff( @
;ff@ A
addDoctorFormgg 
.gg 
Showgg 
(gg 
)gg  
;gg  !
}hh 	
privatekk 
voidkk $
AddDoctorForm_FormClosedkk -
(kk- .
objectkk. 4
senderkk5 ;
,kk; <
FormClosedEventArgskk= P
ekkQ R
)kkR S
{ll 	
usersDataGridmm 
.mm 

DataSourcemm $
=mm% &
UsersHandlermm' 3
.mm3 4
FillDatamm4 <
(mm< =
dtmm= ?
)mm? @
;mm@ A
}nn 	
}oo 
}pp ∑-
ED:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\AddVisitForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
AddVisitForm %
:& '
Form( ,
{ 
private 
Doctor 
chosenDoctor #
;# $
private		 
string		 

chosenDate		 !
;		! "
public 
AddVisitForm 
( 
Doctor "
doctor# )
)) *
{ 	
InitializeComponent 
(  
)  !
;! "
chosenDoctor 
= 
doctor !
;! "
} 	
private 
void 
AddVisitForm_Load &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
messagesLabel 
. 
Text 
=  
$str! #
;# $
visitDateTimePicker 
.  
MinDate  '
=( )
DateTime* 2
.2 3
Today3 8
;8 9
visitDateTimePicker 
.  
MaxDate  '
=( )
DateTime* 2
.2 3
Today3 8
.8 9
AddYears9 A
(A B
$numB C
)C D
;D E
addVisitButton 
. 
Enabled "
=# $
false% *
;* +
doctorTextBox 
. 
Text 
=  
chosenDoctor! -
.- .
User. 2
.2 3
Name3 7
;7 8
} 	
private!! 
void!! ,
 visitDateTimePicker_ValueChanged!! 5
(!!5 6
object!!6 <
sender!!= C
,!!C D
	EventArgs!!E N
e!!O P
)!!P Q
{"" 	
messagesLabel## 
.## 
Text## 
=##  
$str##! #
;### $
string&& 
	dayOfWeek&& 
=&& 
visitDateTimePicker&& 2
.&&2 3
Value&&3 8
.&&8 9
	DayOfWeek&&9 B
.&&B C
ToString&&C K
(&&K L
)&&L M
;&&M N
if'' 
('' 
('' 
	dayOfWeek'' 
=='' 
$str'' (
)''( )
||''* ,
(''- .
	dayOfWeek''. 7
==''8 :
$str''; C
)''C D
)''D E
messagesLabel(( 
.(( 
Text(( "
=((# $
$str((% <
;((< =
else)) 
{** 
	dayOfWeek++ 
=++ 
visitDateTimePicker++ /
.++/ 0
Value++0 5
.++5 6
ToString++6 >
(++> ?
$str++? K
)++K L
;++L M
bool.. 
	dayIsFree.. 
=..  
VisitsHandler..! .
.... /
CheckDoctorBusyness../ B
(..B C
chosenDoctor..C O
,..O P
	dayOfWeek..Q Z
)..Z [
;..[ \
if11 
(11 
	dayIsFree11 
)11 
{22 
addVisitButton33 "
.33" #
Enabled33# *
=33+ ,
true33- 1
;331 2

chosenDate44 
=44  
	dayOfWeek44! *
;44* +
}55 
else66 
messagesLabel77 !
.77! "
Text77" &
=77' (
$str77) ?
;77? @
}88 
}99 	
private<< 
void<<  
addVisitButton_Click<< )
(<<) *
object<<* 0
sender<<1 7
,<<7 8
	EventArgs<<9 B
e<<C D
)<<D E
{== 	
try>> 
{?? 
if@@ 
(@@ 
visitTypeComboBox@@ %
.@@% &
SelectedItem@@& 2
==@@3 5
null@@6 :
)@@: ;
{AA 
messagesLabelBB !
.BB! "
TextBB" &
=BB' (
$strBB) ?
;BB? @
}CC 
elseDD 
{EE 
stringGG 
doctorLoginGG &
=GG' (
chosenDoctorGG) 5
.GG5 6
UserGG6 :
.GG: ;
LoginGG; @
;GG@ A
stringHH 

cardNumberHH %
=HH& '
MainFormHH( 0
.HH0 1

CurPatientHH1 ;
.HH; <
PatientCardsHH< H
[HHH I
$numHHI J
]HHJ K
.HHK L

CardNumberHHL V
;HHV W
stringII 
typeII 
=II  !
visitTypeComboBoxII" 3
.II3 4
SelectedItemII4 @
.II@ A
ToStringIIA I
(III J
)IIJ K
;IIK L
DataHandlerJJ 
.JJ  
AddDoctorVisitJJ  .
(JJ. /
doctorLoginJJ/ :
,JJ: ;

cardNumberJJ< F
,JJF G

chosenDateJJH R
,JJR S
typeJJT X
)JJX Y
;JJY Z
MessagesHandlerLL #
.LL# $
ShowMessageLL$ /
(LL/ 0
$strLL0 M
)LLM N
;LLN O
CloseOO 
(OO 
)OO 
;OO 
}PP 
}QQ 
catchRR 
(RR 
	ExceptionRR 
exRR 
)RR 
{SS 
LoggerTT 
.TT 
WriteLogTT 
(TT  
exTT  "
)TT" #
;TT# $
ErrorHandlerUU 
.UU 
	ShowErrorUU &
(UU& '
$strUU' B
)UUB C
;UUC D
CloseVV 
(VV 
)VV 
;VV 
}WW 
}XX 	
}YY 
}ZZ Â
ID:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\AddVisitInfoForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
AddVisitInfoForm )
:* +
Form, 0
{ 
private 
DoctorVisit 
Visit !
;! "
public

 
AddVisitInfoForm

 
(

  
DoctorVisit

  +
visit

, 1
)

1 2
{ 	
InitializeComponent 
(  
)  !
;! "
Visit 
= 
visit 
; 
} 	
private 
void !
AddVisitInfoForm_Load *
(* +
object+ 1
sender2 8
,8 9
	EventArgs: C
eD E
)E F
{ 	
complaintsTextBox 
. 
Text "
=# $
Visit% *
.* +

Complaints+ 5
;5 6
diagnosisTextBox 
. 
Text !
=" #
Visit$ )
.) *
	Diagnosis* 3
;3 4
treatmentTextBox 
. 
Text !
=" #
Visit$ )
.) *
	Treatment* 3
;3 4
} 	
private 
void 
confirmButton_Click (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{ 	
try 
{ 
Visit 
. 

Complaints  
=! "
complaintsTextBox# 4
.4 5
Text5 9
;9 :
Visit 
. 
	Diagnosis 
=  !
diagnosisTextBox" 2
.2 3
Text3 7
;7 8
Visit   
.   
	Treatment   
=    !
treatmentTextBox  " 2
.  2 3
Text  3 7
;  7 8
DataHandler## 
.## 
UpdateInDatabase## ,
(##, -
Visit##- 2
)##2 3
;##3 4
MessagesHandler%% 
.%%  
ShowMessage%%  +
(%%+ ,
$str%%, B
)%%B C
;%%C D
Close&& 
(&& 
)&& 
;&& 
}'' 
catch(( 
((( 
	Exception(( 
ex(( 
)((  
{)) 
Logger** 
.** 
WriteLog** 
(**  
ex**  "
)**" #
;**# $
ErrorHandler++ 
.++ 
	ShowError++ &
(++& '
$str++' P
)++P Q
;++Q R
Close,, 
(,, 
),, 
;,, 
}-- 
}.. 	
}// 
}00 –'
GD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\ChooseDateForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
ChooseDateForm '
:( )
Form* .
{ 
private 
Doctor 
Doctor 
; 
private		 
string		 
Date		 
;		 
private

 
DoctorVisit

 
Visit

 !
;

! "
public 
ChooseDateForm 
( 
Doctor $
doctor% +
,+ ,
DoctorVisit- 8
visit9 >
)> ?
{ 	
InitializeComponent 
(  
)  !
;! "
Doctor 
= 
doctor 
; 
Visit 
= 
visit 
; 
} 	
private 
void  
addVisitButton_Click )
() *
object* 0
sender1 7
,7 8
	EventArgs9 B
eC D
)D E
{ 	
try 
{ 
Visit 
. 
Move 
( 
Date 
)  
;  !
DataHandler 
. 
UpdateInDatabase ,
(, -
Visit- 2
)2 3
;3 4
MessagesHandler 
.  
ShowMessage  +
(+ ,
$str, =
)= >
;> ?
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' C
)C D
;D E
}   
Close!! 
(!! 
)!! 
;!! 
}"" 	
private$$ 
void$$ 
ChooseDateForm_Load$$ (
($$( )
object$$) /
sender$$0 6
,$$6 7
	EventArgs$$8 A
e$$B C
)$$C D
{%% 	
messagesLabel&& 
.&& 
Text&& 
=&&  
$str&&! #
;&&# $
chooseDateButton)) 
.)) 
Enabled)) $
=))% &
false))' ,
;)), -
visitDateTimePicker,, 
.,,  
MinDate,,  '
=,,( )
DateTime,,* 2
.,,2 3
Today,,3 8
;,,8 9
visitDateTimePicker-- 
.--  
MaxDate--  '
=--( )
DateTime--* 2
.--2 3
Today--3 8
.--8 9
AddYears--9 A
(--A B
$num--B C
)--C D
;--D E
}.. 	
private00 
void00 ,
 visitDateTimePicker_ValueChanged00 5
(005 6
object006 <
sender00= C
,00C D
	EventArgs00E N
e00O P
)00P Q
{11 	
messagesLabel22 
.22 
Text22 
=22  
$str22! #
;22# $
string55 
	dayOfWeek55 
=55 
visitDateTimePicker55 2
.552 3
Value553 8
.558 9
	DayOfWeek559 B
.55B C
ToString55C K
(55K L
)55L M
;55M N
if66 
(66 
(66 
	dayOfWeek66 
==66 
$str66 (
)66( )
||66* ,
(66- .
	dayOfWeek66. 7
==668 :
$str66; C
)66C D
)66D E
{77 
messagesLabel88 
.88 
Text88 "
=88# $
$str88% <
;88< =
chooseDateButton99  
.99  !
Enabled99! (
=99) *
false99+ 0
;990 1
}:: 
else;; 
{<< 
	dayOfWeek== 
=== 
visitDateTimePicker== /
.==/ 0
Value==0 5
.==5 6
ToString==6 >
(==> ?
$str==? K
)==K L
;==L M
bool@@ 
	dayIsFree@@ 
=@@  
VisitsHandler@@! .
.@@. /
CheckDoctorBusyness@@/ B
(@@B C
Doctor@@C I
,@@I J
	dayOfWeek@@K T
)@@T U
;@@U V
ifCC 
(CC 
	dayIsFreeCC 
)CC 
{DD 
DateEE 
=EE 
	dayOfWeekEE $
;EE$ %
chooseDateButtonFF $
.FF$ %
EnabledFF% ,
=FF- .
trueFF/ 3
;FF3 4
}GG 
elseHH 
{II 
messagesLabelJJ !
.JJ! "
TextJJ" &
=JJ' (
$strJJ) ?
;JJ? @
chooseDateButtonKK $
.KK$ %
EnabledKK% ,
=KK- .
falseKK/ 4
;KK4 5
}LL 
}MM 
}NN 	
}OO 
}PP „
BD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\VisitForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
	VisitForm "
:# $
Form% )
{		 
private

 
DoctorVisit

 
Visit

 !
;

! "
public 
	VisitForm 
( 
DoctorVisit $
visit% *
)* +
{ 	
InitializeComponent 
(  
)  !
;! "
Visit 
= 
visit 
; 
} 	
private 
void 
VisitForm_Load #
(# $
object$ *
sender+ 1
,1 2
	EventArgs3 <
e= >
)> ?
{ 	
InitializeLabels 
( 
) 
; 
if 
( 
MainForm 
. 
	CurDoctor "
==# %
null& *
)* +
{ 
writeInfoButton 
.  
Visible  '
=( )
false* /
;/ 0
endVisitButton 
. 
Visible &
=' (
false) .
;. /
} 
if 
( 
MainForm 
. 
CurAdmin !
!=" $
null% )
)) *
{ 

moveButton 
. 
Enabled "
=# $
false% *
;* +
cancelButton   
.   
Enabled   $
=  % &
false  ' ,
;  , -
}!! 
if## 
(## 
(## 
Visit## 
.## 
Status## 
==## 
$str##  )
)##) *
||##+ -
(##. /
Visit##/ 4
.##4 5
Status##5 ;
==##< >
$str##? I
)##I J
)##J K
{$$ 
BlockButtons%% 
(%% 
)%% 
;%% 
}&& 
if(( 
((( 
MainForm(( 
.(( 
	CurDoctor(( "
!=((# %
null((& *
)((* +
{)) 
patientLabel** 
.** 
Click** "
+=**# %
PatientLabel_Click**& 8
;**8 9
patientLabel++ 
.++ 
	ForeColor++ &
=++' (
Color++) .
.++. /
Blue++/ 3
;++3 4
},, 
if.. 
(.. 
MainForm.. 
... 

CurPatient.. #
!=..$ &
null..' +
)..+ ,
{// 
doctorLabel00 
.00 
Click00 !
+=00" $
DoctorLabel_Click00% 6
;006 7
doctorLabel11 
.11 
	ForeColor11 %
=11& '
Color11( -
.11- .
Blue11. 2
;112 3
}22 
if44 
(44 
MainForm44 
.44 
CurAdmin44 !
!=44" $
null44% )
)44) *
{55 
patientLabel66 
.66 
Click66 "
+=66# %
PatientLabel_Click66& 8
;668 9
patientLabel77 
.77 
	ForeColor77 &
=77' (
Color77) .
.77. /
Blue77/ 3
;773 4
doctorLabel99 
.99 
Click99 !
+=99" $
DoctorLabel_Click99% 6
;996 7
doctorLabel:: 
.:: 
	ForeColor:: %
=::& '
Color::( -
.::- .
Blue::. 2
;::2 3
};; 
}<< 	
private>> 
void>> 
PatientLabel_Click>> '
(>>' (
object>>( .
sender>>/ 5
,>>5 6
	EventArgs>>7 @
e>>A B
)>>B C
{?? 	
PatientAA 
patientAA 
=AA 
DataHandlerAA )
.AA) *

GetPatientAA* 4
(AA4 5
VisitAA5 :
.AA: ;
PatientCardIDAA; H
)AAH I
;AAI J
PatientInfoFormCC 
patientInfoFormCC +
=CC, -
newCC. 1
PatientInfoFormCC2 A
(CCA B
patientCCB I
)CCI J
;CCJ K
patientInfoFormDD 
.DD 
ShowDD  
(DD  !
)DD! "
;DD" #
}EE 	
privateGG 
voidGG 
DoctorLabel_ClickGG &
(GG& '
objectGG' -
senderGG. 4
,GG4 5
	EventArgsGG6 ?
eGG@ A
)GGA B
{HH 	
DoctorJJ 
doctorJJ 
=JJ 
DataHandlerJJ '
.JJ' (
	GetDoctorJJ( 1
(JJ1 2
VisitJJ2 7
.JJ7 8
DoctorIDJJ8 @
)JJ@ A
;JJA B
DoctorInfoFormLL 
doctorInfoFormLL )
=LL* +
newLL, /
DoctorInfoFormLL0 >
(LL> ?
doctorLL? E
)LLE F
;LLF G
doctorInfoFormMM 
.MM 
ShowMM 
(MM  
)MM  !
;MM! "
}NN 	
privatePP 
voidPP 
InitializeLabelsPP %
(PP% &
)PP& '
{QQ 	
tryRR 
{SS 
VisitTT 
=TT 
DataHandlerTT #
.TT# $
GetDoctorVisitTT$ 2
(TT2 3
VisitTT3 8
.TT8 9
VisitIDTT9 @
)TT@ A
;TTA B
	dateLabelVV 
.VV 
TextVV 
=VV  
$strVV! )
+VV* +
VisitVV, 1
.VV1 2
DateVV2 6
;VV6 7
statusLabelWW 
.WW 
TextWW  
=WW! "
$strWW# -
+WW. /
VisitWW0 5
.WW5 6
StatusWW6 <
;WW< =
	typeLabelXX 
.XX 
TextXX 
=XX  
$strXX! (
+XX) *
VisitXX+ 0
.XX0 1
TypeXX1 5
;XX5 6
DoctorZZ 
doctorZZ 
=ZZ 
DataHandlerZZ  +
.ZZ+ ,
	GetDoctorZZ, 5
(ZZ5 6
VisitZZ6 ;
.ZZ; <
DoctorIDZZ< D
)ZZD E
;ZZE F
doctorLabel[[ 
.[[ 
Text[[  
=[[! "
$str[[# -
+[[. /
doctor[[0 6
.[[6 7
User[[7 ;
.[[; <
Name[[< @
;[[@ A
Patient]] 
patient]] 
=]]  !
DataHandler]]" -
.]]- .

GetPatient]]. 8
(]]8 9
Visit]]9 >
.]]> ?
PatientCardID]]? L
)]]L M
;]]M N
patientLabel^^ 
.^^ 
Text^^ !
=^^" #
$str^^$ /
+^^0 1
patient^^2 9
.^^9 :
User^^: >
.^^> ?
Name^^? C
;^^C D
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 
Loggerbb 
.bb 
WriteLogbb 
(bb  
exbb  "
)bb" #
;bb# $
ErrorHandlercc 
.cc 
	ShowErrorcc &
(cc& '
$strcc' Q
)ccQ R
;ccR S
Closedd 
(dd 
)dd 
;dd 
}ee 
}ff 	
privateii 
voidii !
complaintsLabel_Clickii *
(ii* +
objectii+ 1
senderii2 8
,ii8 9
	EventArgsii: C
eiiD E
)iiE F
{jj 	
ifkk 
(kk 
(kk 
Visitkk 
.kk 

Complaintskk !
!=kk" $
nullkk% )
)kk) *
&&kk+ -
(kk. /
Visitkk/ 4
.kk4 5

Complaintskk5 ?
!=kk@ B
$strkkC E
)kkE F
)kkF G
{ll 
VisitInfoFormmm 
visitInfoFormmm +
=mm, -
newmm. 1
VisitInfoFormmm2 ?
(mm? @
$strmm@ H
,mmH I
VisitmmJ O
.mmO P

ComplaintsmmP Z
)mmZ [
;mm[ \
visitInfoFormnn 
.nn 
Shownn "
(nn" #
)nn# $
;nn$ %
}oo 
elsepp 
MessagesHandlerqq 
.qq  
ShowMessageqq  +
(qq+ ,
$strqq, C
)qqC D
;qqD E
}rr 	
privateuu 
voiduu  
diagnosisLabel_Clickuu )
(uu) *
objectuu* 0
senderuu1 7
,uu7 8
	EventArgsuu9 B
euuC D
)uuD E
{vv 	
ifww 
(ww 
(ww 
Visitww 
.ww 
	Diagnosisww  
!=ww! #
nullww$ (
)ww( )
&&ww* ,
(ww- .
Visitww. 3
.ww3 4
	Diagnosisww4 =
!=ww> @
$strwwA C
)wwC D
)wwD E
{xx 
VisitInfoFormyy 
visitInfoFormyy +
=yy, -
newyy. 1
VisitInfoFormyy2 ?
(yy? @
$stryy@ I
,yyI J
VisityyK P
.yyP Q
	DiagnosisyyQ Z
)yyZ [
;yy[ \
visitInfoFormzz 
.zz 
Showzz "
(zz" #
)zz# $
;zz$ %
}{{ 
else|| 
MessagesHandler}} 
.}}  
ShowMessage}}  +
(}}+ ,
$str}}, C
)}}C D
;}}D E
}~~ 	
private
ÅÅ 
void
ÅÅ "
treatmentLabel_Click
ÅÅ )
(
ÅÅ) *
object
ÅÅ* 0
sender
ÅÅ1 7
,
ÅÅ7 8
	EventArgs
ÅÅ9 B
e
ÅÅC D
)
ÅÅD E
{
ÇÇ 	
if
ÉÉ 
(
ÉÉ 
(
ÉÉ 
Visit
ÉÉ 
.
ÉÉ 
	Treatment
ÉÉ  
!=
ÉÉ! #
null
ÉÉ$ (
)
ÉÉ( )
&&
ÉÉ* ,
(
ÉÉ- .
Visit
ÉÉ. 3
.
ÉÉ3 4
	Treatment
ÉÉ4 =
!=
ÉÉ> @
$str
ÉÉA C
)
ÉÉC D
)
ÉÉD E
{
ÑÑ 
VisitInfoForm
ÖÖ 
visitInfoForm
ÖÖ +
=
ÖÖ, -
new
ÖÖ. 1
VisitInfoForm
ÖÖ2 ?
(
ÖÖ? @
$str
ÖÖ@ I
,
ÖÖI J
Visit
ÖÖK P
.
ÖÖP Q
	Treatment
ÖÖQ Z
)
ÖÖZ [
;
ÖÖ[ \
visitInfoForm
ÜÜ 
.
ÜÜ 
Show
ÜÜ "
(
ÜÜ" #
)
ÜÜ# $
;
ÜÜ$ %
}
áá 
else
àà 
MessagesHandler
ââ 
.
ââ  
ShowMessage
ââ  +
(
ââ+ ,
$str
ââ, C
)
ââC D
;
ââD E
}
ää 	
private
çç 
void
çç 
moveButton_Click
çç %
(
çç% &
object
çç& ,
sender
çç- 3
,
çç3 4
	EventArgs
çç5 >
e
çç? @
)
çç@ A
{
éé 	
Doctor
èè 
doctor
èè 
=
èè 
DataHandler
èè '
.
èè' (
	GetDoctor
èè( 1
(
èè1 2
Visit
èè2 7
.
èè7 8
DoctorID
èè8 @
)
èè@ A
;
èèA B
ChooseDateForm
êê 
chooseDateForm
êê )
=
êê* +
new
êê, /
ChooseDateForm
êê0 >
(
êê> ?
doctor
êê? E
,
êêE F
Visit
êêG L
)
êêL M
;
êêM N
chooseDateForm
ëë 
.
ëë 

FormClosed
ëë %
+=
ëë& ('
ChooseDateForm_FormClosed
ëë) B
;
ëëB C
chooseDateForm
íí 
.
íí 
Show
íí 
(
íí  
)
íí  !
;
íí! "
}
ìì 	
private
ññ 
void
ññ '
ChooseDateForm_FormClosed
ññ .
(
ññ. /
object
ññ/ 5
sender
ññ6 <
,
ññ< =!
FormClosedEventArgs
ññ> Q
e
ññR S
)
ññS T
{
óó 	
InitializeLabels
ôô 
(
ôô 
)
ôô 
;
ôô 
}
öö 	
private
ùù 
void
ùù  
cancelButton_Click
ùù '
(
ùù' (
object
ùù( .
sender
ùù/ 5
,
ùù5 6
	EventArgs
ùù7 @
e
ùùA B
)
ùùB C
{
ûû 	
DialogResult
†† 
result
†† 
=
††  !

MessageBox
††" ,
.
††, -
Show
††- 1
(
††1 2
$str
°° 8
,
°°8 9
$str
¢¢ 
,
¢¢  
MessageBoxButtons
££ !
.
££! "
YesNo
££" '
,
££' (
MessageBoxIcon
§§ 
.
§§ 
Question
§§ '
)
•• 
;
•• 
if
ßß 
(
ßß 
result
ßß 
==
ßß 
DialogResult
ßß &
.
ßß& '
Yes
ßß' *
)
ßß* +
{
®® 
Visit
©© 
.
©© 
Cancel
©© 
(
©© 
)
©© 
;
©© 
DataHandler
™™ 
.
™™ 
UpdateInDatabase
™™ ,
(
™™, -
Visit
™™- 2
)
™™2 3
;
™™3 4
InitializeLabels
´´  
(
´´  !
)
´´! "
;
´´" #
BlockButtons
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
}
≠≠ 
}
ÆÆ 	
private
∞∞ 
void
∞∞ 
BlockButtons
∞∞ !
(
∞∞! "
)
∞∞" #
{
±± 	
writeInfoButton
≤≤ 
.
≤≤ 
Enabled
≤≤ #
=
≤≤$ %
false
≤≤& +
;
≤≤+ ,
endVisitButton
≥≥ 
.
≥≥ 
Enabled
≥≥ "
=
≥≥# $
false
≥≥% *
;
≥≥* +

moveButton
¥¥ 
.
¥¥ 
Enabled
¥¥ 
=
¥¥  
false
¥¥! &
;
¥¥& '
cancelButton
µµ 
.
µµ 
Enabled
µµ  
=
µµ! "
false
µµ# (
;
µµ( )
}
∂∂ 	
private
ππ 
void
ππ "
endVisitButton_Click
ππ )
(
ππ) *
object
ππ* 0
sender
ππ1 7
,
ππ7 8
	EventArgs
ππ9 B
e
ππC D
)
ππD E
{
∫∫ 	
DialogResult
ºº 
result
ºº 
=
ºº  !

MessageBox
ºº" ,
.
ºº, -
Show
ºº- 1
(
ºº1 2
$str
ΩΩ 9
,
ΩΩ9 :
$str
ææ 
,
ææ  
MessageBoxButtons
øø !
.
øø! "
YesNo
øø" '
,
øø' (
MessageBoxIcon
¿¿ 
.
¿¿ 
Question
¿¿ '
)
¡¡ 
;
¡¡ 
if
√√ 
(
√√ 
result
√√ 
==
√√ 
DialogResult
√√ &
.
√√& '
Yes
√√' *
)
√√* +
{
ƒƒ 
Visit
≈≈ 
.
≈≈ 
Complete
≈≈ 
(
≈≈ 
)
≈≈  
;
≈≈  !
DataHandler
∆∆ 
.
∆∆ 
UpdateInDatabase
∆∆ ,
(
∆∆, -
Visit
∆∆- 2
)
∆∆2 3
;
∆∆3 4
InitializeLabels
««  
(
««  !
)
««! "
;
««" #
BlockButtons
»» 
(
»» 
)
»» 
;
»» 
}
…… 
}
   	
private
ÕÕ 
void
ÕÕ #
writeInfoButton_Click
ÕÕ *
(
ÕÕ* +
object
ÕÕ+ 1
sender
ÕÕ2 8
,
ÕÕ8 9
	EventArgs
ÕÕ: C
e
ÕÕD E
)
ÕÕE F
{
ŒŒ 	
AddVisitInfoForm
œœ 
addInfoForm
œœ (
=
œœ) *
new
œœ+ .
AddVisitInfoForm
œœ/ ?
(
œœ? @
Visit
œœ@ E
)
œœE F
;
œœF G
addInfoForm
–– 
.
–– 

FormClosed
–– "
+=
––# %)
AddVisitInfoForm_FormClosed
––& A
;
––A B
addInfoForm
—— 
.
—— 
Show
—— 
(
—— 
)
—— 
;
—— 
}
““ 	
private
‘‘ 
void
‘‘ )
AddVisitInfoForm_FormClosed
‘‘ 0
(
‘‘0 1
object
‘‘1 7
sender
‘‘8 >
,
‘‘> ?!
FormClosedEventArgs
‘‘@ S
e
‘‘T U
)
‘‘U V
{
’’ 	
InitializeLabels
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷ 
}
◊◊ 	
}
ÿÿ 
}ŸŸ ß
FD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\VisitInfoForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
VisitInfoForm &
:' (
Form) -
{ 
private 
string 
Type 
; 
private		 
string		 
Content		 
;		 
public 
VisitInfoForm 
( 
string #
type$ (
,( )
string* 0
content1 8
)8 9
{ 	
InitializeComponent 
(  
)  !
;! "
Type 
= 
type 
; 
Content 
= 
content 
; 
Text 
= 
$str *
++ ,
type- 1
.1 2
ToLower2 9
(9 :
): ;
+< =
$str> A
;A B
} 	
private 
void 
VisitInfoForm_Load '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	

titleLabel 
. 
Text 
= 
Type "
;" #
infoTextBox 
. 
Text 
= 
Content &
;& '
} 	
} 
} Ÿ=
GD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Visits\VisitsListForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
	Functions! *
{ 
public 

partial 
class 
VisitsListForm '
:( )
Form* .
{ 
private		 
	DataTable		 
dt		 
=		 
new		 "
	DataTable		# ,
(		, -
)		- .
;		. /
public 
VisitsListForm 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
VisitsListForm_Load (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{ 	
try 
{ 
dt 
= 
VisitsHandler "
." #
GetDataTable# /
(/ 0
MainForm0 8
.8 9
currentUser9 D
)D E
;E F
if 
( 
( 
dt 
!= 
null 
)  
&&! #
($ %
dt% '
.' (
Columns( /
./ 0
Count0 5
>6 7
$num8 9
)9 :
): ;
{ 
visitsDataGrid "
." #

DataSource# -
=. /
dt0 2
;2 3
for 
( 
int 
i 
=  
$num! "
;" #
i$ %
<& '
visitsDataGrid( 6
.6 7
Columns7 >
.> ?
Count? D
;D E
iF G
++G I
)I J
{ 
if 
( 
i 
!=  
visitsDataGrid! /
./ 0
Columns0 7
.7 8
Count8 =
-> ?
$num@ A
)A B
visitsDataGrid   *
.  * +
Columns  + 2
[  2 3
i  3 4
]  4 5
.  5 6
AutoSizeMode  6 B
=  C D*
DataGridViewAutoSizeColumnMode  E c
.  c d
DisplayedCells  d r
;  r s
else"" 
visitsDataGrid## *
.##* +
Columns##+ 2
[##2 3
i##3 4
]##4 5
.##5 6
AutoSizeMode##6 B
=##C D*
DataGridViewAutoSizeColumnMode##E c
.##c d
Fill##d h
;##h i
}$$ 
visitsDataGrid%% "
.%%" #
Columns%%# *
[%%* +
$num%%+ ,
]%%, -
.%%- .
Visible%%. 5
=%%6 7
false%%8 =
;%%= >
visitsDataGrid(( "
.((" #

DataSource((# -
=((. /
VisitsHandler((0 =
.((= >
FillData((> F
(((F G
MainForm((G O
.((O P
currentUser((P [
,(([ \
dt((] _
)((_ `
;((` a
})) 
else** 
throw++ 
new++ 
	Exception++ '
(++' (
$str++( F
)++F G
;++G H
},, 
catch-- 
(-- 
	Exception-- 
ex-- 
)--  
{.. 
Logger// 
.// 
WriteLog// 
(//  
ex//  "
)//" #
;//# $
ErrorHandler00 
.00 
	ShowError00 &
(00& '
ex00' )
.00) *
Message00* 1
)001 2
;002 3
Close11 
(11 
)11 
;11 
}22 
}33 	
private66 
void66 
searchButton_Click66 '
(66' (
object66( .
sender66/ 5
,665 6
	EventArgs667 @
e66A B
)66B C
{77 	
string88 
query88 
=88 
searchTextBox88 (
.88( )
Text88) -
;88- .
visitsDataGrid:: 
.:: 

DataSource:: %
=::& '
VisitsHandler::( 5
.::5 6
Search::6 <
(::< =
MainForm::= E
.::E F
currentUser::F Q
,::Q R
query::S X
,::X Y
dt::Z \
)::\ ]
;::] ^
};; 	
private>> 
void>> 
ShowVisitForm>> "
(>>" #
DataGridViewRow>># 2
row>>3 6
)>>6 7
{?? 	
if@@ 
(@@ 
row@@ 
.@@ 
Cells@@ 
[@@ 
$num@@ 
]@@ 
.@@ 
Value@@ "
!=@@# %
null@@& *
)@@* +
{AA 
intBB 
IDBB 
=BB 
ConvertBB  
.BB  !
ToInt32BB! (
(BB( )
rowBB) ,
.BB, -
CellsBB- 2
[BB2 3
$numBB3 4
]BB4 5
.BB5 6
ValueBB6 ;
.BB; <
ToStringBB< D
(BBD E
)BBE F
)BBF G
;BBG H
DoctorVisitEE 
visitEE !
=EE" #
DataHandlerEE$ /
.EE/ 0
GetDoctorVisitEE0 >
(EE> ?
IDEE? A
)EEA B
;EEB C
	VisitFormHH 
	visitFormHH #
=HH$ %
newHH& )
	VisitFormHH* 3
(HH3 4
visitHH4 9
)HH9 :
;HH: ;
	visitFormII 
.II 

FormClosedII $
+=II% ' 
VisitForm_FormClosedII( <
;II< =
	visitFormJJ 
.JJ 
ShowJJ 
(JJ 
)JJ  
;JJ  !
}KK 
elseLL 
MessagesHandlerMM 
.MM  
ShowMessageMM  +
(MM+ ,
$strMM, E
)MME F
;MMF G
}NN 	
privateQQ 
voidQQ 
infoButton_ClickQQ %
(QQ% &
objectQQ& ,
senderQQ- 3
,QQ3 4
	EventArgsQQ5 >
eQQ? @
)QQ@ A
{RR 	
ifSS 
(SS 
visitsDataGridSS 
.SS 
SelectedRowsSS +
.SS+ ,
CountSS, 1
>SS2 3
$numSS4 5
)SS5 6
{TT 
DataGridViewRowVV 
rowVV  #
=VV$ %
visitsDataGridVV& 4
.VV4 5
SelectedRowsVV5 A
[VVA B
$numVVB C
]VVC D
;VVD E
ShowVisitFormWW 
(WW 
rowWW !
)WW! "
;WW" #
}XX 
elseYY 
ifYY 
(YY 
visitsDataGridYY "
.YY" #
SelectedCellsYY# 0
.YY0 1
CountYY1 6
>YY7 8
$numYY9 :
)YY: ;
{ZZ 
DataGridViewRow[[ 
row[[  #
=[[$ %
visitsDataGrid[[& 4
.[[4 5
SelectedCells[[5 B
[[[B C
$num[[C D
][[D E
.[[E F
	OwningRow[[F O
;[[O P
ShowVisitForm\\ 
(\\ 
row\\ !
)\\! "
;\\" #
}]] 
else^^ 
MessagesHandler__ 
.__  
ShowMessage__  +
(__+ ,
$str__, E
)__E F
;__F G
}`` 	
privatecc 
voidcc  
VisitForm_FormClosedcc )
(cc) *
objectcc* 0
sendercc1 7
,cc7 8
FormClosedEventArgscc9 L
eccM N
)ccN O
{dd 	
visitsDataGridff 
.ff 

DataSourceff %
=ff& '
VisitsHandlerff( 5
.ff5 6
FillDataff6 >
(ff> ?
MainFormff? G
.ffG H
currentUserffH S
,ffS T
dtffU W
)ffW X
;ffX Y
}gg 	
}hh 
}ii ı%
ED:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\DoctorInfoForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
DoctorInfoForm '
:( )
Form* .
{		 
private

 
Doctor

 

InfoDoctor

 !
;

! "
public 
DoctorInfoForm 
( 
Doctor $
doctor% +
)+ ,
{ 	
InitializeComponent 
(  
)  !
;! "

InfoDoctor 
= 
doctor 
;  
} 	
private 
void 
DoctorInfoForm_Load (
(( )
object) /
sender0 6
,6 7
	EventArgs8 A
eB C
)C D
{ 	
InitializeLabels 
( 
) 
; 
if 
( 
MainForm 
. 
CurAdmin !
!=" $
null% )
)) *
{ 
addVisitButton 
. 
Enabled &
=' (
false) .
;. /
feedbackButton 
. 
Text #
=$ %
$str& 6
;6 7
feedbackButton 
. 
Click $
+=% '
ShowFeedbacks_Click( ;
;; <
} 
else 
if 
( 
MainForm 
. 

CurPatient (
!=) +
null, 0
)0 1
{ 
feedbackButton 
. 
Text #
=$ %
$str& 6
;6 7
feedbackButton 
. 
Click $
+=% '
AddFeedback_Click( 9
;9 :
} 
}!! 	
private$$ 
void$$ 
InitializeLabels$$ %
($$% &
)$$& '
{%% 	
try&& 
{'' 
	nameLabel(( 
.(( 
Text(( 
=((  
$str((! (
+(() *

InfoDoctor((+ 5
.((5 6
User((6 :
.((: ;
Name((; ?
;((? @

emailLabel)) 
.)) 
Text)) 
=))  !
$str))" +
+)), -

InfoDoctor)). 8
.))8 9
User))9 =
.))= >
Name))> B
;))B C
specialtyLabel** 
.** 
Text** #
=**$ %
$str**& 7
+**8 9

InfoDoctor**: D
.**D E
	Specialty**E N
.**N O
Name**O S
;**S T
}++ 
catch,, 
(,, 
	Exception,, 
ex,, 
),,  
{-- 
Logger.. 
... 
WriteLog.. 
(..  
ex..  "
).." #
;..# $
ErrorHandler// 
.// 
	ShowError// &
(//& '
$str//' K
)//K L
;//L M
Close00 
(00 
)00 
;00 
}11 
}22 	
private55 
void55  
addVisitButton_Click55 )
(55) *
object55* 0
sender551 7
,557 8
	EventArgs559 B
e55C D
)55D E
{66 	
AddVisitForm77 
addVisitForm77 %
=77& '
new77( +
AddVisitForm77, 8
(778 9

InfoDoctor779 C
)77C D
;77D E
addVisitForm88 
.88 
Show88 
(88 
)88 
;88  
}99 	
private<< 
void<< 
AddFeedback_Click<< &
(<<& '
object<<' -
sender<<. 4
,<<4 5
	EventArgs<<6 ?
e<<@ A
)<<A B
{== 	
AddFeedbackForm>> 
addFeedbackForm>> +
=>>, -
new>>. 1
AddFeedbackForm>>2 A
(>>A B

InfoDoctor>>B L
,>>L M
MainForm>>N V
.>>V W

CurPatient>>W a
)>>a b
;>>b c
addFeedbackForm?? 
.?? 
Show??  
(??  !
)??! "
;??" #
}@@ 	
privateCC 
voidCC 
ShowFeedbacks_ClickCC (
(CC( )
objectCC) /
senderCC0 6
,CC6 7
	EventArgsCC8 A
eCCB C
)CCC D
{DD 	
FeedbackListFormEE 
feedbackListFormEE -
=EE. /
newEE0 3
FeedbackListFormEE4 D
(EED E

InfoDoctorEEE O
)EEO P
;EEP Q
feedbackListFormFF 
.FF 
ShowFF !
(FF! "
)FF" #
;FF# $
}GG 	
}HH 
}II ´
FD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\PatientInfoForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 
PatientInfoForm (
:) *
Form+ /
{ 
private 
Patient 
InfoPatient #
;# $
public

 
PatientInfoForm

 
(

 
Patient

 &
patient

' .
)

. /
{ 	
InitializeComponent 
(  
)  !
;! "
InfoPatient 
= 
patient !
;! "
} 	
private 
void  
PatientInfoForm_Load )
() *
object* 0
sender1 7
,7 8
	EventArgs9 B
eC D
)D E
{ 	
InitializeLabels 
( 
) 
; 
} 	
private 
void 
InitializeLabels %
(% &
)& '
{ 	
try 
{ 
	nameLabel 
. 
Text 
=  
$str! (
+) *
InfoPatient+ 6
.6 7
User7 ;
.; <
Name< @
;@ A
omsLabel 
. 
Text 
= 
$str  '
+( )
InfoPatient* 5
.5 6
OMS6 9
;9 :

phoneLabel 
. 
Text 
=  !
$str" -
+. /
InfoPatient0 ;
.; <
Phone< A
;A B
jobPlaceLabel 
. 
Text "
=# $
$str% ;
+< =
InfoPatient> I
.I J
JobPlaceJ R
;R S
addressLabel 
. 
Text !
=" #
$str$ .
+/ 0
InfoPatient1 <
.< =
Address= D
;D E
birthdateLabel 
. 
Text #
=$ %
$str& 7
+8 9
InfoPatient: E
.E F
	BirthDateF O
;O P
if   
(   
InfoPatient   
.    
Gender    &
==  ' )
$str  * -
)  - .
genderLabel!! 
.!!  
Text!!  $
=!!% &
$str!!' 5
;!!5 6
else"" 
genderLabel## 
.##  
Text##  $
=##% &
$str##' 5
;##5 6
}$$ 
catch%% 
(%% 
	Exception%% 
ex%% 
)%%  
{&& 
Logger'' 
.'' 
WriteLog'' 
(''  
ex''  "
)''" #
;''# $
ErrorHandler(( 
.(( 
	ShowError(( &
(((& '
$str((' R
)((R S
;((S T
Close)) 
()) 
))) 
;)) 
}** 
}++ 	
},, 
}-- ‘
CD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Info\UserInfoForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
.  !
Info! %
{ 
public 

partial 
class 
UserInfoForm %
:& '
Form( ,
{ 
private 
User 
InfoUser 
; 
public

 
UserInfoForm

 
(

 
User

  
user

! %
)

% &
{ 	
InitializeComponent 
(  
)  !
;! "
InfoUser 
= 
user 
; 
} 	
private 
void 
UserInfoForm_Load &
(& '
object' -
sender. 4
,4 5
	EventArgs6 ?
e@ A
)A B
{ 	
try 
{ 
InitializeLabels  
(  !
)! "
;" #
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' J
)J K
;K L
Close 
( 
) 
; 
} 
} 	
private 
void 
InitializeLabels %
(% &
)& '
{ 	
	nameLabel   
.   
Text   
=   
$str   $
+  % &
InfoUser  ' /
.  / 0
Name  0 4
;  4 5

emailLabel!! 
.!! 
Text!! 
=!! 
$str!! '
+!!( )
InfoUser!!* 2
.!!2 3
Email!!3 8
;!!8 9

loginLabel"" 
."" 
Text"" 
="" 
$str"" '
+""( )
InfoUser""* 2
.""2 3
Login""3 8
;""8 9
if## 
(## 
InfoUser## 
.## 
Doctors##  
.##  !
Count##! &
>##' (
$num##) *
)##* +
	typeLabel$$ 
.$$ 
Text$$ 
=$$  
$str$$! .
;$$. /
else%% 
if%% 
(%% 
InfoUser%% 
.%% 
Patients%% &
.%%& '
Count%%' ,
>%%- .
$num%%/ 0
)%%0 1
	typeLabel&& 
.&& 
Text&& 
=&&  
$str&&! /
;&&/ 0
else'' 
	typeLabel(( 
.(( 
Text(( 
=((  
$str((! 5
;((5 6
})) 	
private,, 
void,, 
editButton_Click,, %
(,,% &
object,,& ,
sender,,- 3
,,,3 4
	EventArgs,,5 >
e,,? @
),,@ A
{-- 	
EditUserForm.. 
editUserForm.. %
=..& '
new..( +
EditUserForm.., 8
(..8 9
InfoUser..9 A
)..A B
;..B C
editUserForm// 
.// 

FormClosed// #
+=//$ &#
EditUserForm_FormClosed//' >
;//> ?
editUserForm00 
.00 
Show00 
(00 
)00 
;00  
}11 	
private33 
void33 #
EditUserForm_FormClosed33 ,
(33, -
object33- 3
sender334 :
,33: ;
FormClosedEventArgs33< O
e33P Q
)33Q R
{44 	
InitializeLabels55 
(55 
)55 
;55 
}66 	
}77 
}88 µ
DD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Profiles\AdminForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 
	AdminForm "
:# $
Form% )
{		 
public

 
	AdminForm

 
(

 
)

 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
InitializeLabels %
(% &
)& '
{ 	
try 
{ 
	nameLabel 
. 
Text 
=  
$str! (
+) *
MainForm+ 3
.3 4
CurAdmin4 <
.< =
User= A
.A B
NameB F
;F G

emailLabel 
. 
Text 
=  !
$str" +
+, -
MainForm. 6
.6 7
CurAdmin7 ?
.? @
User@ D
.D E
EmailE J
;J K
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' E
)E F
;F G
Close 
( 
) 
; 
} 
} 	
private 
void 
visitsButton_Click '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
VisitsListForm   

visitsForm   %
=  & '
new  ( +
VisitsListForm  , :
(  : ;
)  ; <
;  < =

visitsForm!! 
.!! 
Show!! 
(!! 
)!! 
;!! 
}"" 	
private$$ 
void$$ !
usersListButton_Click$$ *
($$* +
object$$+ 1
sender$$2 8
,$$8 9
	EventArgs$$: C
e$$D E
)$$E F
{%% 	
UsersListForm&& 
usersListForm&& '
=&&( )
new&&* -
UsersListForm&&. ;
(&&; <
)&&< =
;&&= >
usersListForm'' 
.'' 
Show'' 
('' 
)''  
;''  !
}(( 	
private** 
void** 
AdminForm_Load** #
(**# $
object**$ *
sender**+ 1
,**1 2
	EventArgs**3 <
e**= >
)**> ?
{++ 	
InitializeLabels,, 
(,, 
),, 
;,, 
}-- 	
}.. 
}// œ
ED:\git\PolyclinicSystem\PolyclinicSystem\Forms\Profiles\DoctorForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 

DoctorForm #
:$ %
Form& *
{ 
public		 

DoctorForm		 
(		 
)		 
{

 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
DoctorForm_Load $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
InitializeLabels 
( 
) 
; 
} 	
private 
void 
InitializeLabels %
(% &
)& '
{ 	
try 
{ 
	nameLabel 
. 
Text 
=  
$str! (
+) *
MainForm+ 3
.3 4
	CurDoctor4 =
.= >
User> B
.B C
NameC G
;G H

emailLabel 
. 
Text 
=  !
$str" +
+, -
MainForm. 6
.6 7
	CurDoctor7 @
.@ A
UserA E
.E F
NameF J
;J K
specialtyLabel 
. 
Text #
=$ %
$str& 7
+8 9
MainForm: B
.B C
	CurDoctorC L
.L M
	SpecialtyM V
.V W
NameW [
;[ \
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' E
)E F
;F G
Close   
(   
)   
;   
}!! 
}"" 	
private%% 
void%% 
visitsButton_Click%% '
(%%' (
object%%( .
sender%%/ 5
,%%5 6
	EventArgs%%7 @
e%%A B
)%%B C
{&& 	
VisitsListForm'' 

visitsForm'' %
=''& '
new''( +
VisitsListForm'', :
('': ;
)''; <
;''< =

visitsForm(( 
.(( 
Show(( 
((( 
)(( 
;(( 
})) 	
}** 
}++ Ñ
JD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Profiles\EditPatientForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 
EditPatientForm (
:) *
Form+ /
{ 
public 
EditPatientForm 
( 
)  
{		 	
InitializeComponent

 
(

  
)

  !
;

! "
} 	
private 
void  
EditPatientForm_Load )
() *
object* 0
sender1 7
,7 8
	EventArgs9 B
eC D
)D E
{ 	
try 
{ 

omsTextBox 
. 
Text 
=  !
MainForm" *
.* +

CurPatient+ 5
.5 6
OMS6 9
;9 :
addressTextBox 
. 
Text #
=$ %
MainForm& .
.. /

CurPatient/ 9
.9 :
Address: A
;A B
jobPlaceTextBox 
.  
Text  $
=% &
MainForm' /
./ 0

CurPatient0 :
.: ;
JobPlace; C
;C D
phoneTextBox 
. 
Text !
=" #
MainForm$ ,
., -

CurPatient- 7
.7 8
Phone8 =
;= >
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
ErrorHandler 
. 
	ShowError &
(& '
$str' Q
)Q R
;R S
Close 
( 
) 
; 
} 
} 	
private   
void   
confirmButton_Click   (
(  ( )
object  ) /
sender  0 6
,  6 7
	EventArgs  8 A
e  B C
)  C D
{!! 	
string## 
oms## 
=## 

omsTextBox## #
.### $
Text##$ (
;##( )
string$$ 
address$$ 
=$$ 
addressTextBox$$ +
.$$+ ,
Text$$, 0
;$$0 1
string%% 
jobPlace%% 
=%% 
jobPlaceTextBox%% -
.%%- .
Text%%. 2
;%%2 3
string&& 
phone&& 
=&& 
phoneTextBox&& '
.&&' (
Text&&( ,
;&&, -
try(( 
{)) 
bool** 
result** 
=** 
ProfilesHandler** -
.**- .
EditPatient**. 9
(**9 :
MainForm**: B
.**B C

CurPatient**C M
,**M N
oms**O R
,**R S
jobPlace**T \
,**\ ]
phone**^ c
,**c d
address**e l
)**l m
;**m n
if++ 
(++ 
result++ 
)++ 
{,, 
MessagesHandler-- #
.--# $
ShowMessage--$ /
(--/ 0
$str--0 E
)--E F
;--F G
Close.. 
(.. 
).. 
;.. 
}// 
}00 
catch11 
(11 
	Exception11 
ex11 
)11  
{22 
Logger33 
.33 
WriteLog33 
(33  
ex33  "
)33" #
;33# $
ErrorHandler44 
.44 
	ShowError44 &
(44& '
$str44' G
)44G H
;44H I
Close55 
(55 
)55 
;55 
}66 
}77 	
}88 
}99 ÿ'
FD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Profiles\PatientForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 
PatientForm $
:% &
Form' +
{		 
public

 
PatientForm

 
(

 
)

 
{ 	
InitializeComponent 
(  
)  !
;! "
} 	
private 
void 
visitsButton_Click '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
VisitsListForm 

visitsForm %
=& '
new( +
VisitsListForm, :
(: ;
); <
;< =

visitsForm 
. 
Show 
( 
) 
; 
} 	
private 
void 
InitializeLabels %
(% &
)& '
{ 	
try 
{ 
	nameLabel 
. 
Text 
=  
$str! (
+) *
MainForm+ 3
.3 4

CurPatient4 >
.> ?
User? C
.C D
NameD H
;H I
omsLabel 
. 
Text 
= 
$str  '
+( )
MainForm* 2
.2 3

CurPatient3 =
.= >
OMS> A
;A B

phoneLabel 
. 
Text 
=  !
$str" -
+. /
MainForm0 8
.8 9

CurPatient9 C
.C D
PhoneD I
;I J
jobPlaceLabel 
. 
Text "
=# $
$str% ;
+< =
MainForm> F
.F G

CurPatientG Q
.Q R
JobPlaceR Z
;Z [
addressLabel 
. 
Text !
=" #
$str$ .
+/ 0
MainForm1 9
.9 :

CurPatient: D
.D E
AddressE L
;L M
birthdateLabel 
. 
Text #
=$ %
$str& 7
+8 9
MainForm: B
.B C

CurPatientC M
.M N
	BirthDateN W
;W X
if   
(   
MainForm   
.   

CurPatient   '
.  ' (
Gender  ( .
==  / 1
$str  2 5
)  5 6
genderLabel!! 
.!!  
Text!!  $
=!!% &
$str!!' 5
;!!5 6
else"" 
genderLabel## 
.##  
Text##  $
=##% &
$str##' 5
;##5 6
}$$ 
catch%% 
(%% 
	Exception%% 
ex%% 
)%%  
{&& 
Logger'' 
.'' 
WriteLog'' 
(''  
ex''  "
)''" #
;''# $
ErrorHandler(( 
.(( 
	ShowError(( &
(((& '
$str((' R
)((R S
;((S T
Close)) 
()) 
))) 
;)) 
}** 
}++ 	
private-- 
void-- 
PatientForm_Load-- %
(--% &
object--& ,
sender--- 3
,--3 4
	EventArgs--5 >
e--? @
)--@ A
{.. 	
InitializeLabels00 
(00 
)00 
;00 
}11 	
private44 
void44 #
editProfileButton_Click44 ,
(44, -
object44- 3
sender444 :
,44: ;
	EventArgs44< E
e44F G
)44G H
{55 	
EditPatientForm66 
editPatientForm66 +
=66, -
new66. 1
EditPatientForm662 A
(66A B
)66B C
;66C D
editPatientForm77 
.77 

FormClosed77 &
+=77' )&
EditPatientForm_FormClosed77* D
;77D E
editPatientForm88 
.88 
Show88  
(88  !
)88! "
;88" #
}99 	
private<< 
void<< &
EditPatientForm_FormClosed<< /
(<</ 0
object<<0 6
sender<<7 =
,<<= >
	EventArgs<<? H
e<<I J
)<<J K
{== 	
InitializeLabels>> 
(>> 
)>> 
;>> 
}?? 	
privateAA 
voidAA 
doctorsButton_ClickAA (
(AA( )
objectAA) /
senderAA0 6
,AA6 7
	EventArgsAA8 A
eAAB C
)AAC D
{BB 	
DoctorsListFormCC 
doctorsListFormCC +
=CC, -
newCC. 1
DoctorsListFormCC2 A
(CCA B
)CCB C
;CCC D
doctorsListFormDD 
.DD 
ShowDD  
(DD  !
)DD! "
;DD" #
}EE 	
}FF 
}GG ¸
JD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Authorization\SignUpForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 

SignUpForm #
:$ %
Form& *
{ 
public 

SignUpForm 
( 
) 
{		 	
InitializeComponent

 
(

  
)

  !
;

! "
} 	
private 
void 
SignUpForm_Load $
($ %
object% +
sender, 2
,2 3
	EventArgs4 =
e> ?
)? @
{ 	
birthdateTimePicker 
.  
MaxDate  '
=( )
DateTime* 2
.2 3
Today3 8
;8 9
} 	
static 
public 
Patient 
registeredPatient /
;/ 0
private 
void 
signUpButton_Click '
(' (
object( .
sender/ 5
,5 6
	EventArgs7 @
eA B
)B C
{ 	
string 
gender 
= 
$str 
; 
if 
( 
maleRadioButton 
.  
Checked  '
)' (
gender 
= 
$str 
; 
else 
if 
( 
femaleRadioButton &
.& '
Checked' .
). /
gender 
= 
$str 
; 
else 
gender   
=   
null   
;   
string## 
	birthdate## 
=## 
birthdateTimePicker## 2
.##2 3
Value##3 8
.##8 9
ToString##9 A
(##A B
$str##B N
)##N O
;##O P
Patient&& 
patient&& 
=&& 
Authorization&& +
.&&+ ,
SignUp&&, 2
(&&2 3
loginTextBox&&3 ?
.&&? @
Text&&@ D
,&&D E
emailTextBox&&F R
.&&R S
Text&&S W
,&&W X

fioTextBox'' 
.'' 
Text'' 
,''  
passwordTextBox''! 0
.''0 1
Text''1 5
,''5 6

omsTextBox''7 A
.''A B
Text''B F
,''F G
phoneTextBox''H T
.''T U
Text''U Y
,''Y Z
addressTextBox(( 
.(( 
Text(( #
,((# $
gender((% +
,((+ ,
	birthdate((- 6
)((6 7
;((7 8
if++ 
(++ 
patient++ 
!=++ 
null++ 
)++  
{,, 
MessagesHandler.. 
...  
ShowMessage..  +
(..+ ,
$str.., H
)..H I
;..I J
Close00 
(00 
)00 
;00 
}11 
}22 	
}44 
}55 °
RD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Authorization\ForgotPasswordForm.cs
	namespace 	
PolyclinicSystem
 
. 
Forms  
{ 
public 

partial 
class 
ForgotPasswordForm +
:, -
Form. 2
{ 
public 
ForgotPasswordForm !
(! "
)" #
{		 	
InitializeComponent

 
(

  
)

  !
;

! "
} 	
private 
void &
changePasswordButton_Click /
(/ 0
object0 6
sender7 =
,= >
	EventArgs? H
eI J
)J K
{ 	
string 
attempt 
= 
Authorization *
.* +
ChangePassword+ 9
(9 :
loginTextBox: F
.F G
TextG K
,K L
emailTextBoxM Y
.Y Z
TextZ ^
,^ _
passwordTextBox` o
.o p
Textp t
,t u
repeatPasswTextBox	v à
.
à â
Text
â ç
)
ç é
;
é è
if 
( 
attempt 
== 
$str +
)+ ,
{ 
MessagesHandler 
.  
ShowMessage  +
(+ ,
$str, D
)D E
;E F
Close 
( 
) 
; 
} 
} 	
} 
} Ú|
GD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\Authorization.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
Authorization %
{ 
static 
public 
User 
SignIn !
(! "
string" (
login) .
,. /
string0 6
password7 ?
)? @
{		 	
try

 
{ 
if 
( 
IsEmpty 
( 
login !
)! "
)" #
ErrorHandler  
.  !
	ShowError! *
(* +
$str+ <
)< =
;= >
else 
if 
( 
IsEmpty  
(  !
password! )
)) *
)* +
ErrorHandler  
.  !
	ShowError! *
(* +
$str+ =
)= >
;> ?
else 
{ 
User 
user 
= 
DataHandler  +
.+ ,
GetUser, 3
(3 4
login4 9
)9 :
;: ;
if 
( 
user 
== 
null  $
)$ %
ErrorHandler $
.$ %
	ShowError% .
(. /
$str/ [
)[ \
;\ ]
else 
if 
( 
password %
!=& (
user) -
.- .
Password. 6
)6 7
ErrorHandler $
.$ %
	ShowError% .
(. /
$str/ G
)G H
;H I
else 
return 
user  $
;$ %
} 
} 
catch 
( 
	Exception 
ex 
)  
{ 
Logger 
. 
WriteLog 
(  
ex  "
)" #
;# $
return   
null   
;   
}!! 
return## 
null## 
;## 
}$$ 	
static'' 
public'' 
string'' 
ChangePassword'' +
(''+ ,
string'', 2
login''3 8
,''8 9
string'': @
email''A F
,''F G
string''H N
password''O W
,''W X
string''Y _
rptPassword''` k
)''k l
{(( 	
try)) 
{** 
if,, 
(,, 
IsEmpty,, 
(,, 
login,, !
),,! "
),," #
ErrorHandler--  
.--  !
	ShowError--! *
(--* +
$str--+ <
)--< =
;--= >
else.. 
if.. 
(.. 
IsEmpty..  
(..  !
email..! &
)..& '
)..' (
ErrorHandler//  
.//  !
	ShowError//! *
(//* +
$str//+ I
)//I J
;//J K
else00 
if00 
(00 
IsEmpty00  
(00  !
password00! )
)00) *
)00* +
ErrorHandler11  
.11  !
	ShowError11! *
(11* +
$str11+ =
)11= >
;11> ?
else22 
if22 
(22 
password22 !
!=22" $
rptPassword22% 0
)220 1
ErrorHandler33  
.33  !
	ShowError33! *
(33* +
$str33+ @
)33@ A
;33A B
else44 
{55 
User77 
user77 
=77 
DataHandler77  +
.77+ ,
GetUser77, 3
(773 4
login774 9
)779 :
;77: ;
if88 
(88 
user88 
==88 
null88  $
)88$ %
ErrorHandler99 $
.99$ %
	ShowError99% .
(99. /
$str99/ [
)99[ \
;99\ ]
else;; 
if;; 
(;; 
email;; "
!=;;# %
user;;& *
.;;* +
Email;;+ 0
);;0 1
ErrorHandler<< $
.<<$ %
	ShowError<<% .
(<<. /
$str<</ R
)<<R S
;<<S T
else>> 
{?? 
userAA 
.AA 
ChangePasswordAA +
(AA+ ,
passwordAA, 4
)AA4 5
;AA5 6
DataHandlerCC #
.CC# $
UpdateInDatabaseCC$ 4
(CC4 5
userCC5 9
)CC9 :
;CC: ;
returnEE 
$strEE /
;EE/ 0
}FF 
}GG 
}HH 
catchII 
(II 
	ExceptionII 
exII 
)II  
{JJ 
LoggerKK 
.KK 
WriteLogKK 
(KK  
exKK  "
)KK" #
;KK# $
returnLL 
$strLL 
;LL  
}MM 
returnOO 
$strOO 
;OO 
}PP 	
staticSS 
publicSS 
PatientSS 
SignUpSS $
(SS$ %
stringSS% +
loginSS, 1
,SS1 2
stringSS3 9
emailSS: ?
,SS? @
stringSSA G
fioSSH K
,SSK L
stringSSM S
passwordSST \
,SS\ ]
stringTT 
omsTT 
,TT 
stringTT 
phoneTT $
,TT$ %
stringTT& ,
addressTT- 4
,TT4 5
stringTT6 <
genderTT= C
,TTC D
stringTTE K
	birthdateTTL U
)TTU V
{UU 	
tryVV 
{WW 
ifYY 
(YY 
IsEmptyYY 
(YY 
loginYY !
)YY! "
)YY" #
ErrorHandlerZZ  
.ZZ  !
	ShowErrorZZ! *
(ZZ* +
$strZZ+ <
)ZZ< =
;ZZ= >
else[[ 
if[[ 
([[ 
IsEmpty[[  
([[  !
password[[! )
)[[) *
)[[* +
ErrorHandler\\  
.\\  !
	ShowError\\! *
(\\* +
$str\\+ =
)\\= >
;\\> ?
else]] 
if]] 
(]] 
IsEmpty]]  
(]]  !
email]]! &
)]]& '
)]]' (
ErrorHandler^^  
.^^  !
	ShowError^^! *
(^^* +
$str^^+ I
)^^I J
;^^J K
else__ 
if__ 
(__ 
IsEmpty__  
(__  !
fio__! $
)__$ %
)__% &
ErrorHandler``  
.``  !
	ShowError``! *
(``* +
$str``+ ;
)``; <
;``< =
elseaa 
ifaa 
(aa 
IsEmptyaa  
(aa  !
omsaa! $
)aa$ %
)aa% &
ErrorHandlerbb  
.bb  !
	ShowErrorbb! *
(bb* +
$strbb+ :
)bb: ;
;bb; <
elsecc 
ifcc 
(cc 
IsEmptycc  
(cc  !
phonecc! &
)cc& '
)cc' (
ErrorHandlerdd  
.dd  !
	ShowErrordd! *
(dd* +
$strdd+ E
)ddE F
;ddF G
elseee 
ifee 
(ee 
IsEmptyee  
(ee  !
addressee! (
)ee( )
)ee) *
ErrorHandlerff  
.ff  !
	ShowErrorff! *
(ff* +
$strff+ <
)ff< =
;ff= >
elsegg 
ifgg 
(gg 
IsEmptygg  
(gg  !
gendergg! '
)gg' (
)gg( )
ErrorHandlerhh  
.hh  !
	ShowErrorhh! *
(hh* +
$strhh+ :
)hh: ;
;hh; <
elseii 
ifii 
(ii 
IsEmptyii  
(ii  !
	birthdateii! *
)ii* +
)ii+ ,
ErrorHandlerjj  
.jj  !
	ShowErrorjj! *
(jj* +
$strjj+ E
)jjE F
;jjF G
elsekk 
{ll 
ifnn 
(nn 
!nn 
	Validatornn "
.nn" #

CheckEmailnn# -
(nn- .
emailnn. 3
)nn3 4
)nn4 5
ErrorHandleroo $
.oo$ %
	ShowErroroo% .
(oo. /
$stroo/ R
)ooR S
;ooS T
elsepp 
ifpp 
(pp 
!pp 
	Validatorpp '
.pp' (
CheckOMSpp( 0
(pp0 1
omspp1 4
)pp4 5
)pp5 6
ErrorHandlerqq $
.qq$ %
	ShowErrorqq% .
(qq. /
$strqq/ D
)qqD E
;qqE F
elserr 
ifrr 
(rr 
!rr 
	Validatorrr '
.rr' (

CheckPhonerr( 2
(rr2 3
phonerr3 8
)rr8 9
)rr9 :
ErrorHandlerss $
.ss$ %
	ShowErrorss% .
(ss. /
$strss/ P
)ssP Q
;ssQ R
elseuu 
{vv 
ifww 
(ww 
DataHandlerww '
.ww' (

GetPatientww( 2
(ww2 3
loginww3 8
)ww8 9
!=ww: <
nullww= A
)wwA B
ErrorHandlerxx (
.xx( )
	ShowErrorxx) 2
(xx2 3
$strxx3 N
)xxN O
;xxO P
elsezz 
{{{ 
DataHandler}} '
.}}' (

AddPatient}}( 2
(}}2 3
login}}3 8
,}}8 9
fio}}: =
,}}= >
email}}? D
,}}D E
password}}F N
,}}N O
gender}}P V
,}}V W
oms}}X [
,}}[ \
null}}] a
,}}a b
	birthdate}}c l
,}}l m
address}}n u
,}}u v
phone}}w |
)}}| }
;}}} ~
string "

cardNumber# -
=. /
GenerateCardNumber0 B
(B C
)C D
;D E
DataHandler
ÄÄ '
.
ÄÄ' (
AddPatientCard
ÄÄ( 6
(
ÄÄ6 7
login
ÄÄ7 <
,
ÄÄ< =

cardNumber
ÄÄ> H
)
ÄÄH I
;
ÄÄI J
return
ÇÇ "
DataHandler
ÇÇ# .
.
ÇÇ. /

GetPatient
ÇÇ/ 9
(
ÇÇ9 :
login
ÇÇ: ?
)
ÇÇ? @
;
ÇÇ@ A
}
ÉÉ 
}
ÑÑ 
}
ÖÖ 
}
áá 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
ââ 
Logger
ää 
.
ää 
WriteLog
ää 
(
ää  
ex
ää  "
)
ää" #
;
ää# $
return
ãã 
null
ãã 
;
ãã 
}
åå 
return
éé 
null
éé 
;
éé 
}
èè 	
static
íí 
private
íí 
string
íí  
GenerateCardNumber
íí 0
(
íí0 1
)
íí1 2
{
ìì 	
Random
îî 
rnd
îî 
=
îî 
new
îî 
Random
îî #
(
îî# $
)
îî$ %
;
îî% &
string
ïï 
number
ïï 
=
ïï 
rnd
ïï 
.
ïï  
Next
ïï  $
(
ïï$ %
$num
ïï% '
)
ïï' (
.
ïï( )
ToString
ïï) 1
(
ïï1 2
)
ïï2 3
+
ïï4 5
rnd
ïï6 9
.
ïï9 :
Next
ïï: >
(
ïï> ?
$num
ïï? A
)
ïïA B
.
ïïB C
ToString
ïïC K
(
ïïK L
)
ïïL M
+
ññ4 5
rnd
ññ6 9
.
ññ9 :
Next
ññ: >
(
ññ> ?
$num
ññ? A
)
ññA B
.
ññB C
ToString
ññC K
(
ññK L
)
ññL M
+
ññN O
rnd
ññP S
.
ññS T
Next
ññT X
(
ññX Y
$num
ññY [
)
ññ[ \
.
ññ\ ]
ToString
ññ] e
(
ññe f
)
ññf g
+
óó4 5
rnd
óó6 9
.
óó9 :
Next
óó: >
(
óó> ?
$num
óó? A
)
óóA B
.
óóB C
ToString
óóC K
(
óóK L
)
óóL M
;
óóM N
return
òò 
number
òò 
;
òò 
}
ôô 	
static
úú 
public
úú 
string
úú 

DefineUser
úú '
(
úú' (
User
úú( ,
user
úú- 1
)
úú1 2
{
ùù 	
if
ûû 
(
ûû 
user
ûû 
.
ûû 
Doctors
ûû 
.
ûû 
Count
ûû "
>
ûû# $
$num
ûû% &
)
ûû& '
return
üü 
$str
üü 
;
üü  
else
†† 
if
†† 
(
†† 
user
†† 
.
†† 
Patients
†† "
.
††" #
Count
††# (
>
††) *
$num
††+ ,
)
††, -
return
°° 
$str
°°  
;
°°  !
else
¢¢ 
return
¢¢ 
$str
¢¢ 
;
¢¢  
}
££ 	
static
¶¶ 
public
¶¶ 
void
¶¶ 
SetUser
¶¶ "
(
¶¶" #
User
¶¶# '
user
¶¶( ,
,
¶¶, -
string
¶¶. 4
usertype
¶¶5 =
)
¶¶= >
{
ßß 	
try
®® 
{
©© 
if
™™ 
(
™™ 
usertype
™™ 
==
™™ 
$str
™™  (
)
™™( )
MainForm
´´ 
.
´´ 
	CurDoctor
´´ &
=
´´' (
DataHandler
´´) 4
.
´´4 5
	GetDoctor
´´5 >
(
´´> ?
user
´´? C
.
´´C D
Login
´´D I
)
´´I J
;
´´J K
else
¨¨ 
if
¨¨ 
(
¨¨ 
usertype
¨¨ !
==
¨¨" $
$str
¨¨% .
)
¨¨. /
MainForm
≠≠ 
.
≠≠ 

CurPatient
≠≠ '
=
≠≠( )
DataHandler
≠≠* 5
.
≠≠5 6

GetPatient
≠≠6 @
(
≠≠@ A
user
≠≠A E
.
≠≠E F
Login
≠≠F K
)
≠≠K L
;
≠≠L M
else
ÆÆ 
MainForm
ØØ 
.
ØØ 
CurAdmin
ØØ %
=
ØØ& '
DataHandler
ØØ( 3
.
ØØ3 4
GetAdmin
ØØ4 <
(
ØØ< =
user
ØØ= A
.
ØØA B
Login
ØØB G
)
ØØG H
;
ØØH I
MainForm
∞∞ 
.
∞∞ 
currentUser
∞∞ $
=
∞∞% &
usertype
∞∞' /
;
∞∞/ 0
}
±± 
catch
≤≤ 
(
≤≤ 
	Exception
≤≤ 
ex
≤≤ 
)
≤≤  
{
≥≥ 
Logger
¥¥ 
.
¥¥ 
WriteLog
¥¥ 
(
¥¥  
ex
¥¥  "
)
¥¥" #
;
¥¥# $
}
µµ 
}
∑∑ 	
static
∫∫ 
public
∫∫ 
void
∫∫ 

LogoutUser
∫∫ %
(
∫∫% &
)
∫∫& '
{
ªª 	
MainForm
ºº 
.
ºº 
currentUser
ºº  
=
ºº! "
$str
ºº# %
;
ºº% &
MainForm
ΩΩ 
.
ΩΩ 
CurAdmin
ΩΩ 
=
ΩΩ 
null
ΩΩ  $
;
ΩΩ$ %
MainForm
ææ 
.
ææ 
	CurDoctor
ææ 
=
ææ  
null
ææ! %
;
ææ% &
MainForm
øø 
.
øø 

CurPatient
øø 
=
øø  !
null
øø" &
;
øø& '
}
¿¿ 	
static
√√ 
private
√√ 
bool
√√ 
IsEmpty
√√ #
(
√√# $
string
√√$ *
value
√√+ 0
)
√√0 1
{
ƒƒ 	
if
≈≈ 
(
≈≈ 
(
≈≈ 
value
≈≈ 
==
≈≈ 
$str
≈≈ 
)
≈≈ 
||
≈≈  
(
≈≈! "
value
≈≈" '
==
≈≈( *
null
≈≈+ /
)
≈≈/ 0
)
≈≈0 1
return
∆∆ 
true
∆∆ 
;
∆∆ 
return
«« 
false
«« 
;
«« 
}
»» 	
}
…… 
}   ™å
ED:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\DataHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
static		 

public		 
class		 
DataHandler		 #
{

 
static 
public 
readonly 
string %
DBFile& ,
=- .
$str/ >
;> ?
static 
public 
bool 
CreateDatabase )
() *
)* +
{ 	
bool 
result 
= 
false 
;  
try 
{ 
using 
( 
SQLiteConnection '
db( *
=+ ,
new- 0
SQLiteConnection1 A
(A B
$strB Q
)Q R
)R S
{ 
db 
. 
CreateTable "
<" #
	Specialty# ,
>, -
(- .
). /
;/ 0
db 
. 
CreateTable "
<" #
User# '
>' (
(( )
)) *
;* +
db 
. 
CreateTable "
<" #
Administrator# 0
>0 1
(1 2
)2 3
;3 4
db 
. 
CreateTable "
<" #
Doctor# )
>) *
(* +
)+ ,
;, -
db 
. 
CreateTable "
<" #
Patient# *
>* +
(+ ,
), -
;- .
db 
. 
CreateTable "
<" #
PatientCard# .
>. /
(/ 0
)0 1
;1 2
db 
. 
CreateTable "
<" #
DoctorVisit# .
>. /
(/ 0
)0 1
;1 2
db 
. 
CreateTable "
<" #
Feedback# +
>+ ,
(, -
)- .
;. /
} 
AddAdministrator  
(  !
$str! (
,( )
$str* C
,C D
$strE T
,T U
$strV ]
,] ^
$str_ l
)l m
;m n
AddSpecialty!! 
(!! 
$str!! )
)!!) *
;!!* +
AddSpecialty"" 
("" 
$str"" %
)""% &
;""& '
AddSpecialty## 
(## 
$str## '
)##' (
;##( )
AddSpecialty$$ 
($$ 
$str$$ &
)$$& '
;$$' (
AddSpecialty%% 
(%% 
$str%% &
)%%& '
;%%' (
AddSpecialty&& 
(&& 
$str&& *
)&&* +
;&&+ ,
AddSpecialty'' 
('' 
$str'' (
)''( )
;'') *
AddSpecialty(( 
((( 
$str(( '
)((' (
;((( )
AddSpecialty)) 
()) 
$str)) '
)))' (
;))( )
result** 
=** 
true** 
;** 
}++ 
catch,, 
(,, 
	Exception,, 
ex,, 
),,  
{-- 
Logger.. 
... 
WriteLog.. 
(..  
ex..  "
).." #
;..# $
ErrorHandler// 
.// 
	ShowError// &
(//& '
$str//' M
)//M N
;//N O
}00 
return22 
result22 
;22 
}33 	
static55 
private55 
void55 
AddToDatabase55 )
(55) *
object55* 0
obj551 4
)554 5
{66 	
try77 
{88 
using99 
(99 
SQLiteConnection99 '
db99( *
=99+ ,
new99- 0
SQLiteConnection991 A
(99A B
DBFile99B H
)99H I
)99I J
{:: 
db;; 
.;; 
Insert;; 
(;; 
obj;; !
);;! "
;;;" #
}<< 
}== 
catch>> 
(>> 
	Exception>> 
ex>> 
)>>  
{?? 
ErrorHandler@@ 
.@@ 
	ShowError@@ &
(@@& '
ex@@' )
)@@) *
;@@* +
}AA 
}BB 	
staticDD 
publicDD 
voidDD 
UpdateInDatabaseDD +
(DD+ ,
objectDD, 2
objDD3 6
)DD6 7
{EE 	
tryFF 
{GG 
usingHH 
(HH 
SQLiteConnectionHH '
dbHH( *
=HH+ ,
newHH- 0
SQLiteConnectionHH1 A
(HHA B
DBFileHHB H
)HHH I
)HHI J
{II 
dbJJ 
.JJ 
UpdateWithChildrenJJ )
(JJ) *
objJJ* -
)JJ- .
;JJ. /
}KK 
}LL 
catchMM 
(MM 
	ExceptionMM 
exMM 
)MM  
{NN 
ErrorHandlerOO 
.OO 
	ShowErrorOO &
(OO& '
exOO' )
)OO) *
;OO* +
}PP 
}QQ 	
staticSS 
publicSS 
voidSS 
AddUserSS "
(SS" #
stringSS# )
loginSS* /
,SS/ 0
stringSS1 7
nameSS8 <
,SS< =
stringSS> D
emailSSE J
,SSJ K
stringSSL R
passwordSSS [
)SS[ \
{TT 	
tryUU 
{VV 
UserWW 
userWW 
=WW 
newWW 
UserWW  $
{XX 
LoginYY 
=YY 
loginYY !
,YY! "
NameZZ 
=ZZ 
nameZZ 
,ZZ  
Email[[ 
=[[ 
email[[ !
,[[! "
Password\\ 
=\\ 
password\\ '
}]] 
;]] 
AddToDatabase__ 
(__ 
user__ "
)__" #
;__# $
}`` 
catchaa 
(aa 
	Exceptionaa 
exaa 
)aa  
{bb 
ErrorHandlercc 
.cc 
	ShowErrorcc &
(cc& '
excc' )
)cc) *
;cc* +
}dd 
}ee 	
staticgg 
publicgg 
voidgg 
AddSpecialtygg '
(gg' (
stringgg( .
namegg/ 3
)gg3 4
{hh 	
tryii 
{jj 
	Specialtykk 
	specialtykk #
=kk$ %
newkk& )
	Specialtykk* 3
{ll 
Namemm 
=mm 
namemm 
}nn 
;nn 
AddToDatabasepp 
(pp 
	specialtypp '
)pp' (
;pp( )
}qq 
catchrr 
(rr 
	Exceptionrr 
exrr 
)rr  
{ss 
ErrorHandlertt 
.tt 
	ShowErrortt &
(tt& '
extt' )
)tt) *
;tt* +
}uu 
}vv 	
staticxx 
publicxx 
voidxx 
AddAdministratorxx +
(xx+ ,
stringxx, 2
loginxx3 8
,xx8 9
stringxx: @
namexxA E
,xxE F
stringxxG M
emailxxN S
,xxS T
stringxxU [
passwordxx\ d
,xxd e
stringxxf l
phonexxm r
)xxr s
{yy 	
tryzz 
{{{ 
User}} 
user}} 
=}} 
new}} 
User}}  $
{~~ 
Login 
= 
login !
,! "
Name
ÄÄ 
=
ÄÄ 
name
ÄÄ 
,
ÄÄ  
Email
ÅÅ 
=
ÅÅ 
email
ÅÅ !
,
ÅÅ! "
Password
ÇÇ 
=
ÇÇ 
password
ÇÇ '
}
ÉÉ 
;
ÉÉ 
AddToDatabase
ÑÑ 
(
ÑÑ 
user
ÑÑ "
)
ÑÑ" #
;
ÑÑ# $
Administrator
áá 
admin
áá #
=
áá$ %
new
áá& )
Administrator
áá* 7
{
àà 
Phone
ââ 
=
ââ 
phone
ââ !
}
ää 
;
ää 
AddToDatabase
ãã 
(
ãã 
admin
ãã #
)
ãã# $
;
ãã$ %
user
çç 
.
çç 
Administrators
çç #
=
çç$ %
new
çç& )
List
çç* .
<
çç. /
Administrator
çç/ <
>
çç< =
{
çç> ?
admin
çç@ E
}
ççF G
;
ççG H
UpdateInDatabase
éé  
(
éé  !
user
éé! %
)
éé% &
;
éé& '
}
èè 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
ErrorHandler
íí 
.
íí 
	ShowError
íí &
(
íí& '
ex
íí' )
)
íí) *
;
íí* +
}
ìì 
}
îî 	
static
ññ 
public
ññ 
void
ññ 

AddPatient
ññ %
(
ññ% &
string
ññ& ,
login
ññ- 2
,
ññ2 3
string
ññ4 :
name
ññ; ?
,
ññ? @
string
ññA G
email
ññH M
,
ññM N
string
ññO U
password
ññV ^
,
ññ^ _
string
óó 
gender
óó 
,
óó 
string
óó !
oms
óó" %
,
óó% &
string
óó' -
jobplace
óó. 6
,
óó6 7
string
óó8 >
	birthdate
óó? H
,
óóH I
string
óóJ P
address
óóQ X
,
óóX Y
string
óóZ `
phone
óóa f
)
óóf g
{
òò 	
try
ôô 
{
öö 
User
úú 
user
úú 
=
úú 
new
úú 
User
úú  $
{
ùù 
Login
ûû 
=
ûû 
login
ûû !
,
ûû! "
Name
üü 
=
üü 
name
üü 
,
üü  
Email
†† 
=
†† 
email
†† !
,
††! "
Password
°° 
=
°° 
password
°° '
}
¢¢ 
;
¢¢ 
AddToDatabase
££ 
(
££ 
user
££ "
)
££" #
;
££# $
Patient
¶¶ 
patient
¶¶ 
=
¶¶  !
new
¶¶" %
Patient
¶¶& -
{
ßß 
Gender
®® 
=
®® 
gender
®® #
,
®®# $
OMS
©© 
=
©© 
oms
©© 
,
©© 
JobPlace
™™ 
=
™™ 
jobplace
™™ '
,
™™' (
	BirthDate
´´ 
=
´´ 
	birthdate
´´  )
,
´´) *
Address
¨¨ 
=
¨¨ 
address
¨¨ %
,
¨¨% &
Phone
≠≠ 
=
≠≠ 
phone
≠≠ !
}
ÆÆ 
;
ÆÆ 
AddToDatabase
ØØ 
(
ØØ 
patient
ØØ %
)
ØØ% &
;
ØØ& '
user
≤≤ 
.
≤≤ 
Patients
≤≤ 
=
≤≤ 
new
≤≤  #
List
≤≤$ (
<
≤≤( )
Patient
≤≤) 0
>
≤≤0 1
{
≤≤2 3
patient
≤≤4 ;
}
≤≤< =
;
≤≤= >
UpdateInDatabase
≥≥  
(
≥≥  !
user
≥≥! %
)
≥≥% &
;
≥≥& '
}
¥¥ 
catch
µµ 
(
µµ 
	Exception
µµ 
ex
µµ 
)
µµ  
{
∂∂ 
ErrorHandler
∑∑ 
.
∑∑ 
	ShowError
∑∑ &
(
∑∑& '
ex
∑∑' )
)
∑∑) *
;
∑∑* +
}
∏∏ 
}
ππ 	
static
ªª 
public
ªª 
void
ªª 
	AddDoctor
ªª $
(
ªª$ %
string
ªª% +
login
ªª, 1
,
ªª1 2
string
ªª3 9
name
ªª: >
,
ªª> ?
string
ªª@ F
email
ªªG L
,
ªªL M
string
ªªN T
password
ªªU ]
,
ªª] ^
string
ªª_ e
	specialty
ªªf o
)
ªªo p
{
ºº 	
try
ΩΩ 
{
ææ 
User
¿¿ 
user
¿¿ 
=
¿¿ 
new
¿¿ 
User
¿¿  $
{
¡¡ 
Login
¬¬ 
=
¬¬ 
login
¬¬ !
,
¬¬! "
Name
√√ 
=
√√ 
name
√√ 
,
√√  
Email
ƒƒ 
=
ƒƒ 
email
ƒƒ !
,
ƒƒ! "
Password
≈≈ 
=
≈≈ 
password
≈≈ '
}
∆∆ 
;
∆∆ 
AddToDatabase
«« 
(
«« 
user
«« "
)
««" #
;
««# $
Doctor
   
doctor
   
=
   
new
    #
Doctor
  $ *
{
  + ,
}
  - .
;
  . /
AddToDatabase
ÀÀ 
(
ÀÀ 
doctor
ÀÀ $
)
ÀÀ$ %
;
ÀÀ% &
user
ŒŒ 
.
ŒŒ 
Doctors
ŒŒ 
=
ŒŒ 
new
ŒŒ "
List
ŒŒ# '
<
ŒŒ' (
Doctor
ŒŒ( .
>
ŒŒ. /
{
ŒŒ0 1
doctor
ŒŒ2 8
}
ŒŒ9 :
;
ŒŒ: ;
UpdateInDatabase
œœ  
(
œœ  !
user
œœ! %
)
œœ% &
;
œœ& '
	Specialty
““ 
spec
““ 
=
““  
GetSpecialty
““! -
(
““- .
	specialty
““. 7
)
““7 8
;
““8 9
if
”” 
(
”” 
spec
”” 
.
”” 
Doctors
””  
.
””  !
Count
””! &
==
””' )
$num
””* +
)
””+ ,
spec
‘‘ 
.
‘‘ 
Doctors
‘‘  
=
‘‘! "
new
‘‘# &
List
‘‘' +
<
‘‘+ ,
Doctor
‘‘, 2
>
‘‘2 3
{
‘‘4 5
doctor
‘‘6 <
}
‘‘= >
;
‘‘> ?
else
’’ 
spec
÷÷ 
.
÷÷ 
Doctors
÷÷  
.
÷÷  !
Add
÷÷! $
(
÷÷$ %
doctor
÷÷% +
)
÷÷+ ,
;
÷÷, -
UpdateInDatabase
◊◊  
(
◊◊  !
spec
◊◊! %
)
◊◊% &
;
◊◊& '
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ 
{
⁄⁄ 
ErrorHandler
€€ 
.
€€ 
	ShowError
€€ &
(
€€& '
ex
€€' )
)
€€) *
;
€€* +
}
‹‹ 
}
›› 	
static
ﬂﬂ 
public
ﬂﬂ 
void
ﬂﬂ 
AddPatientCard
ﬂﬂ )
(
ﬂﬂ) *
string
ﬂﬂ* 0
login
ﬂﬂ1 6
,
ﬂﬂ6 7
string
ﬂﬂ8 >
number
ﬂﬂ? E
)
ﬂﬂE F
{
‡‡ 	
try
·· 
{
‚‚ 
PatientCard
‰‰ 
card
‰‰  
=
‰‰! "
new
‰‰# &
PatientCard
‰‰' 2
{
‰‰3 4

CardNumber
ÂÂ 
=
ÂÂ  
number
ÂÂ! '
}
ÊÊ 
;
ÊÊ 
AddToDatabase
ÁÁ 
(
ÁÁ 
card
ÁÁ "
)
ÁÁ" #
;
ÁÁ# $
Patient
ÍÍ 
patient
ÍÍ 
=
ÍÍ  !

GetPatient
ÍÍ" ,
(
ÍÍ, -
login
ÍÍ- 2
)
ÍÍ2 3
;
ÍÍ3 4
if
ÎÎ 
(
ÎÎ 
patient
ÎÎ 
.
ÎÎ 
PatientCards
ÎÎ (
.
ÎÎ( )
Count
ÎÎ) .
==
ÎÎ/ 1
$num
ÎÎ2 3
)
ÎÎ3 4
patient
ÏÏ 
.
ÏÏ 
PatientCards
ÏÏ (
=
ÏÏ) *
new
ÏÏ+ .
List
ÏÏ/ 3
<
ÏÏ3 4
PatientCard
ÏÏ4 ?
>
ÏÏ? @
{
ÏÏA B
card
ÏÏC G
}
ÏÏH I
;
ÏÏI J
else
ÌÌ 
patient
ÓÓ 
.
ÓÓ 
PatientCards
ÓÓ (
.
ÓÓ( )
Add
ÓÓ) ,
(
ÓÓ, -
card
ÓÓ- 1
)
ÓÓ1 2
;
ÓÓ2 3
UpdateInDatabase
ÔÔ  
(
ÔÔ  !
patient
ÔÔ! (
)
ÔÔ( )
;
ÔÔ) *
}
 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ 
ex
ÒÒ 
)
ÒÒ  
{
ÚÚ 
ErrorHandler
ÛÛ 
.
ÛÛ 
	ShowError
ÛÛ &
(
ÛÛ& '
ex
ÛÛ' )
)
ÛÛ) *
;
ÛÛ* +
}
ÙÙ 
}
ıı 	
static
˜˜ 
public
˜˜ 
void
˜˜ 
AddDoctorVisit
˜˜ )
(
˜˜) *
string
˜˜* 0
doctorLogin
˜˜1 <
,
˜˜< =
string
˜˜> D

cardNumber
˜˜E O
,
˜˜O P
string
˜˜Q W
date
˜˜X \
,
˜˜\ ]
string
˜˜^ d
type
˜˜e i
)
˜˜i j
{
¯¯ 	
try
˘˘ 
{
˙˙ 
DoctorVisit
¸¸ 
visit
¸¸ !
=
¸¸" #
new
¸¸$ '
DoctorVisit
¸¸( 3
{
˝˝ 
Date
˛˛ 
=
˛˛ 
date
˛˛ 
,
˛˛  
Status
ˇˇ 
=
ˇˇ 
$str
ˇˇ '
,
ˇˇ' (
Type
ÄÄ 
=
ÄÄ 
type
ÄÄ 
}
ÅÅ 
;
ÅÅ 
AddToDatabase
ÇÇ 
(
ÇÇ 
visit
ÇÇ #
)
ÇÇ# $
;
ÇÇ$ %
PatientCard
ÖÖ 
card
ÖÖ  
=
ÖÖ! "
GetPatientCard
ÖÖ# 1
(
ÖÖ1 2

cardNumber
ÖÖ2 <
)
ÖÖ< =
;
ÖÖ= >
if
ÜÜ 
(
ÜÜ 
card
ÜÜ 
.
ÜÜ 
DoctorVisits
ÜÜ %
.
ÜÜ% &
Count
ÜÜ& +
==
ÜÜ, .
$num
ÜÜ/ 0
)
ÜÜ0 1
card
áá 
.
áá 
DoctorVisits
áá %
=
áá& '
new
áá( +
List
áá, 0
<
áá0 1
DoctorVisit
áá1 <
>
áá< =
{
áá> ?
visit
áá@ E
}
ááF G
;
ááG H
else
àà 
card
ââ 
.
ââ 
DoctorVisits
ââ %
.
ââ% &
Add
ââ& )
(
ââ) *
visit
ââ* /
)
ââ/ 0
;
ââ0 1
UpdateInDatabase
ää  
(
ää  !
card
ää! %
)
ää% &
;
ää& '
Doctor
çç 
doctor
çç 
=
çç 
	GetDoctor
çç  )
(
çç) *
doctorLogin
çç* 5
)
çç5 6
;
çç6 7
if
éé 
(
éé 
doctor
éé 
.
éé 
DoctorVisits
éé '
.
éé' (
Count
éé( -
==
éé. 0
$num
éé1 2
)
éé2 3
doctor
èè 
.
èè 
DoctorVisits
èè '
=
èè( )
new
èè* -
List
èè. 2
<
èè2 3
DoctorVisit
èè3 >
>
èè> ?
{
èè@ A
visit
èèB G
}
èèH I
;
èèI J
else
êê 
doctor
ëë 
.
ëë 
DoctorVisits
ëë '
.
ëë' (
Add
ëë( +
(
ëë+ ,
visit
ëë, 1
)
ëë1 2
;
ëë2 3
UpdateInDatabase
íí  
(
íí  !
doctor
íí! '
)
íí' (
;
íí( )
}
ìì 
catch
îî 
(
îî 
	Exception
îî 
ex
îî 
)
îî  
{
ïï 
ErrorHandler
ññ 
.
ññ 
	ShowError
ññ &
(
ññ& '
ex
ññ' )
)
ññ) *
;
ññ* +
}
óó 
}
òò 	
static
öö 
public
öö 
void
öö 
AddFeedback
öö &
(
öö& '
string
öö' -
doctorLogin
öö. 9
,
öö9 :
string
öö; A
patientLogin
ööB N
,
ööN O
int
ööP S
rating
ööT Z
,
ööZ [
string
öö\ b
date
ööc g
,
öög h
string
ööi o
text
ööp t
)
ööt u
{
õõ 	
try
úú 
{
ùù 
Feedback
üü 
feedback
üü !
=
üü" #
new
üü$ '
Feedback
üü( 0
{
†† 
Rating
°° 
=
°° 
rating
°° #
,
°°# $
Date
¢¢ 
=
¢¢ 
date
¢¢ 
,
¢¢  
Text
££ 
=
££ 
text
££ 
}
§§ 
;
§§ 
AddToDatabase
•• 
(
•• 
feedback
•• &
)
••& '
;
••' (
Doctor
®® 
doctor
®® 
=
®® 
	GetDoctor
®®  )
(
®®) *
doctorLogin
®®* 5
)
®®5 6
;
®®6 7
if
©© 
(
©© 
doctor
©© 
.
©© 
	Feedbacks
©© $
.
©©$ %
Count
©©% *
==
©©+ -
$num
©©. /
)
©©/ 0
doctor
™™ 
.
™™ 
	Feedbacks
™™ $
=
™™% &
new
™™' *
List
™™+ /
<
™™/ 0
Feedback
™™0 8
>
™™8 9
{
™™: ;
feedback
™™< D
}
™™E F
;
™™F G
else
´´ 
doctor
¨¨ 
.
¨¨ 
	Feedbacks
¨¨ $
.
¨¨$ %
Add
¨¨% (
(
¨¨( )
feedback
¨¨) 1
)
¨¨1 2
;
¨¨2 3
UpdateInDatabase
≠≠  
(
≠≠  !
doctor
≠≠! '
)
≠≠' (
;
≠≠( )
Patient
∞∞ 
patient
∞∞ 
=
∞∞  !

GetPatient
∞∞" ,
(
∞∞, -
patientLogin
∞∞- 9
)
∞∞9 :
;
∞∞: ;
if
±± 
(
±± 
patient
±± 
.
±± 
	Feedbacks
±± %
.
±±% &
Count
±±& +
==
±±, .
$num
±±/ 0
)
±±0 1
patient
≤≤ 
.
≤≤ 
	Feedbacks
≤≤ %
=
≤≤& '
new
≤≤( +
List
≤≤, 0
<
≤≤0 1
Feedback
≤≤1 9
>
≤≤9 :
{
≤≤; <
feedback
≤≤= E
}
≤≤F G
;
≤≤G H
else
≥≥ 
patient
¥¥ 
.
¥¥ 
	Feedbacks
¥¥ %
.
¥¥% &
Add
¥¥& )
(
¥¥) *
feedback
¥¥* 2
)
¥¥2 3
;
¥¥3 4
UpdateInDatabase
µµ  
(
µµ  !
patient
µµ! (
)
µµ( )
;
µµ) *
}
∂∂ 
catch
∑∑ 
(
∑∑ 
	Exception
∑∑ 
ex
∑∑ 
)
∑∑  
{
∏∏ 
ErrorHandler
ππ 
.
ππ 
	ShowError
ππ &
(
ππ& '
ex
ππ' )
)
ππ) *
;
ππ* +
}
∫∫ 
}
ªª 	
static
ΩΩ 
public
ΩΩ 
List
ΩΩ 
<
ΩΩ 
User
ΩΩ 
>
ΩΩ  
GetUsers
ΩΩ! )
(
ΩΩ) *
)
ΩΩ* +
{
ææ 	
try
øø 
{
¿¿ 
List
¡¡ 
<
¡¡ 
User
¡¡ 
>
¡¡ 
users
¡¡  
;
¡¡  !
using
√√ 
(
√√ 
SQLiteConnection
√√ '
db
√√( *
=
√√+ ,
new
√√- 0
SQLiteConnection
√√1 A
(
√√A B
DBFile
√√B H
)
√√H I
)
√√I J
users
ƒƒ 
=
ƒƒ 
db
ƒƒ 
.
ƒƒ  
GetAllWithChildren
ƒƒ 1
<
ƒƒ1 2
User
ƒƒ2 6
>
ƒƒ6 7
(
ƒƒ7 8
)
ƒƒ8 9
;
ƒƒ9 :
return
∆∆ 
users
∆∆ 
;
∆∆ 
}
«« 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
…… 
Logger
   
.
   
WriteLog
   
(
    
ex
    "
)
  " #
;
  # $
return
ÀÀ 
null
ÀÀ 
;
ÀÀ 
}
ÃÃ 
}
ÕÕ 	
static
œœ 
public
œœ 
User
œœ 
GetUser
œœ "
(
œœ" #
string
œœ# )
login
œœ* /
)
œœ/ 0
{
–– 	
try
—— 
{
““ 
using
”” 
(
”” 
SQLiteConnection
”” &
db
””' )
=
””* +
new
””, /
SQLiteConnection
””0 @
(
””@ A
DBFile
””A G
)
””G H
)
””H I
{
‘‘ 
User
’’ 
user
’’ 
=
’’ 
db
’’  "
.
’’" #
Query
’’# (
<
’’( )
User
’’) -
>
’’- .
(
’’. /
$str
’’/ S
,
’’S T
login
’’U Z
)
’’Z [
.
’’[ \
First
’’\ a
(
’’a b
)
’’b c
;
’’c d
return
÷÷ 
db
÷÷ 
.
÷÷ 
GetWithChildren
÷÷ -
<
÷÷- .
User
÷÷. 2
>
÷÷2 3
(
÷÷3 4
user
÷÷4 8
.
÷÷8 9
ID
÷÷9 ;
)
÷÷; <
;
÷÷< =
}
◊◊ 
}
ÿÿ 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
⁄⁄ 
Logger
€€ 
.
€€ 
WriteLog
€€ 
(
€€  
ex
€€  "
)
€€" #
;
€€# $
return
‹‹ 
null
‹‹ 
;
‹‹ 
}
›› 
}
ﬁﬁ 	
static
‡‡ 
public
‡‡ 
User
‡‡ 
GetUser
‡‡ "
(
‡‡" #
int
‡‡# &
ID
‡‡' )
)
‡‡) *
{
·· 	
try
‚‚ 
{
„„ 
using
‰‰ 
(
‰‰ 
SQLiteConnection
‰‰ '
db
‰‰( *
=
‰‰+ ,
new
‰‰- 0
SQLiteConnection
‰‰1 A
(
‰‰A B
DBFile
‰‰B H
)
‰‰H I
)
‰‰I J
{
ÂÂ 
return
ÊÊ 
db
ÊÊ 
.
ÊÊ 
GetWithChildren
ÊÊ -
<
ÊÊ- .
User
ÊÊ. 2
>
ÊÊ2 3
(
ÊÊ3 4
ID
ÊÊ4 6
)
ÊÊ6 7
;
ÊÊ7 8
}
ÁÁ 
}
ËË 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÍÍ 
Logger
ÎÎ 
.
ÎÎ 
WriteLog
ÎÎ 
(
ÎÎ  
ex
ÎÎ  "
)
ÎÎ" #
;
ÎÎ# $
return
ÏÏ 
null
ÏÏ 
;
ÏÏ 
}
ÌÌ 
}
ÓÓ 	
static
 
public
 
	Specialty
 
GetSpecialty
  ,
(
, -
string
- 3
specName
4 <
)
< =
{
ÒÒ 	
try
ÚÚ 
{
ÛÛ 
using
ÙÙ 
(
ÙÙ 
SQLiteConnection
ÙÙ &
db
ÙÙ' )
=
ÙÙ* +
new
ÙÙ, /
SQLiteConnection
ÙÙ0 @
(
ÙÙ@ A
DBFile
ÙÙA G
)
ÙÙG H
)
ÙÙH I
{
ıı 
	Specialty
ˆˆ 
spec
ˆˆ "
=
ˆˆ# $
db
ˆˆ% '
.
ˆˆ' (
Query
ˆˆ( -
<
ˆˆ- .
	Specialty
ˆˆ. 7
>
ˆˆ7 8
(
ˆˆ8 9
$str
ˆˆ9 a
,
ˆˆa b
specName
ˆˆc k
)
ˆˆk l
.
ˆˆl m
First
ˆˆm r
(
ˆˆr s
)
ˆˆs t
;
ˆˆt u
return
˜˜ 
db
˜˜ 
.
˜˜ 
GetWithChildren
˜˜ -
<
˜˜- .
	Specialty
˜˜. 7
>
˜˜7 8
(
˜˜8 9
spec
˜˜9 =
.
˜˜= >
ID
˜˜> @
)
˜˜@ A
;
˜˜A B
}
¯¯ 
}
˘˘ 
catch
˙˙ 
(
˙˙ 
	Exception
˙˙ 
ex
˙˙ 
)
˙˙  
{
˚˚ 
ErrorHandler
¸¸ 
.
¸¸ 
	ShowError
¸¸ &
(
¸¸& '
ex
¸¸' )
)
¸¸) *
;
¸¸* +
return
˝˝ 
null
˝˝ 
;
˝˝ 
}
˛˛ 
}
ˇˇ 	
static
ÅÅ 
public
ÅÅ 
List
ÅÅ 
<
ÅÅ 
	Specialty
ÅÅ $
>
ÅÅ$ %
GetSpecialties
ÅÅ& 4
(
ÅÅ4 5
)
ÅÅ5 6
{
ÇÇ 	
try
ÉÉ 
{
ÑÑ 
List
ÖÖ 
<
ÖÖ 
	Specialty
ÖÖ 
>
ÖÖ 
specialties
ÖÖ  +
;
ÖÖ+ ,
using
áá 
(
áá 
SQLiteConnection
áá '
db
áá( *
=
áá+ ,
new
áá- 0
SQLiteConnection
áá1 A
(
ááA B
DBFile
ááB H
)
ááH I
)
ááI J
specialties
àà 
=
àà  !
db
àà" $
.
àà$ % 
GetAllWithChildren
àà% 7
<
àà7 8
	Specialty
àà8 A
>
ààA B
(
ààB C
)
ààC D
;
ààD E
return
ää 
specialties
ää "
;
ää" #
}
ãã 
catch
åå 
(
åå 
	Exception
åå 
ex
åå 
)
åå  
{
çç 
Logger
éé 
.
éé 
WriteLog
éé 
(
éé  
ex
éé  "
)
éé" #
;
éé# $
return
èè 
null
èè 
;
èè 
}
êê 
}
ëë 	
static
ìì 
public
ìì 
	Specialty
ìì "
GetSpecialtyByDoctor
ìì  4
(
ìì4 5
int
ìì5 8
doctorID
ìì9 A
)
ììA B
{
îî 	
try
ïï 
{
ññ 
using
óó 
(
óó 
SQLiteConnection
óó &
db
óó' )
=
óó* +
new
óó, /
SQLiteConnection
óó0 @
(
óó@ A
DBFile
óóA G
)
óóG H
)
óóH I
{
òò 
Doctor
ôô 
doctor
ôô !
=
ôô" #
db
ôô$ &
.
ôô& '
Query
ôô' ,
<
ôô, -
Doctor
ôô- 3
>
ôô3 4
(
ôô4 5
$str
ôô5 ^
,
ôô^ _
doctorID
ôô` h
)
ôôh i
.
ôôi j
First
ôôj o
(
ôôo p
)
ôôp q
;
ôôq r
	Specialty
öö 
spec
öö "
=
öö# $
db
öö% '
.
öö' (
Query
öö( -
<
öö- .
	Specialty
öö. 7
>
öö7 8
(
öö8 9
$str
öö9 _
,
öö_ `
doctor
ööa g
.
öög h
SpecialtyID
ööh s
)
öös t
.
ööt u
First
ööu z
(
ööz {
)
öö{ |
;
öö| }
return
õõ 
spec
õõ 
;
õõ  
}
úú 
}
ùù 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
ErrorHandler
†† 
.
†† 
	ShowError
†† &
(
††& '
ex
††' )
)
††) *
;
††* +
return
°° 
null
°° 
;
°° 
}
¢¢ 
}
££ 	
static
•• 
public
•• 
Patient
•• 

GetPatient
•• (
(
••( )
string
••) /
login
••0 5
)
••5 6
{
¶¶ 	
try
ßß 
{
®® 
using
©© 
(
©© 
SQLiteConnection
©© &
db
©©' )
=
©©* +
new
©©, /
SQLiteConnection
©©0 @
(
©©@ A
DBFile
©©A G
)
©©G H
)
©©H I
{
™™ 
User
´´ 
user
´´ 
=
´´ 
db
´´  "
.
´´" #
Query
´´# (
<
´´( )
User
´´) -
>
´´- .
(
´´. /
$str
´´/ S
,
´´S T
login
´´U Z
)
´´Z [
.
´´[ \
First
´´\ a
(
´´a b
)
´´b c
;
´´c d
Patient
¨¨ 
patient
¨¨ #
=
¨¨$ %
db
¨¨& (
.
¨¨( )
Query
¨¨) .
<
¨¨. /
Patient
¨¨/ 6
>
¨¨6 7
(
¨¨7 8
$str
¨¨8 `
,
¨¨` a
user
¨¨b f
.
¨¨f g
ID
¨¨g i
)
¨¨i j
.
¨¨j k
First
¨¨k p
(
¨¨p q
)
¨¨q r
;
¨¨r s
return
≠≠ 
db
≠≠ 
.
≠≠ 
GetWithChildren
≠≠ -
<
≠≠- .
Patient
≠≠. 5
>
≠≠5 6
(
≠≠6 7
patient
≠≠7 >
.
≠≠> ?
	PatientID
≠≠? H
)
≠≠H I
;
≠≠I J
}
ÆÆ 
}
ØØ 
catch
∞∞ 
(
∞∞ 
	Exception
∞∞ 
ex
∞∞ 
)
∞∞  
{
±± 
Logger
≤≤ 
.
≤≤ 
WriteLog
≤≤ 
(
≤≤  
ex
≤≤  "
)
≤≤" #
;
≤≤# $
return
≥≥ 
null
≥≥ 
;
≥≥ 
}
¥¥ 
}
µµ 	
static
∑∑ 
public
∑∑ 
Patient
∑∑ 

GetPatient
∑∑ (
(
∑∑( )
int
∑∑) ,
cardID
∑∑- 3
)
∑∑3 4
{
∏∏ 	
try
ππ 
{
∫∫ 
using
ªª 
(
ªª 
SQLiteConnection
ªª '
db
ªª( *
=
ªª+ ,
new
ªª- 0
SQLiteConnection
ªª1 A
(
ªªA B
DBFile
ªªB H
)
ªªH I
)
ªªI J
{
ºº 
PatientCard
ΩΩ 
card
ΩΩ  $
=
ΩΩ% &
db
ΩΩ' )
.
ΩΩ) *
GetWithChildren
ΩΩ* 9
<
ΩΩ9 :
PatientCard
ΩΩ: E
>
ΩΩE F
(
ΩΩF G
cardID
ΩΩG M
)
ΩΩM N
;
ΩΩN O
return
ææ 
db
ææ 
.
ææ 
GetWithChildren
ææ -
<
ææ- .
Patient
ææ. 5
>
ææ5 6
(
ææ6 7
card
ææ7 ;
.
ææ; <
	PatientID
ææ< E
)
ææE F
;
ææF G
}
øø 
}
¿¿ 
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡  
{
¬¬ 
ErrorHandler
√√ 
.
√√ 
	ShowError
√√ &
(
√√& '
ex
√√' )
)
√√) *
;
√√* +
return
ƒƒ 
null
ƒƒ 
;
ƒƒ 
}
≈≈ 
}
∆∆ 	
static
»» 
public
»» 
Patient
»» 

GetPatient
»» (
(
»»( )
int
»») ,
id
»»- /
,
»»/ 0
bool
»»1 5
flag
»»6 :
)
»»: ;
{
…… 	
if
   
(
   
!
   
flag
   
)
   
return
ÀÀ 

GetPatient
ÀÀ !
(
ÀÀ! "
id
ÀÀ" $
)
ÀÀ$ %
;
ÀÀ% &
else
ÃÃ 
{
ÕÕ 
try
ŒŒ 
{
œœ 
using
–– 
(
–– 
SQLiteConnection
–– +
db
––, .
=
––/ 0
new
––1 4
SQLiteConnection
––5 E
(
––E F
DBFile
––F L
)
––L M
)
––M N
return
—— 
db
—— !
.
——! "
GetWithChildren
——" 1
<
——1 2
Patient
——2 9
>
——9 :
(
——: ;
id
——; =
)
——= >
;
——> ?
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
‘‘ 
Logger
’’ 
.
’’ 
WriteLog
’’ #
(
’’# $
ex
’’$ &
)
’’& '
;
’’' (
return
÷÷ 
null
÷÷ 
;
÷÷  
}
◊◊ 
}
ÿÿ 
}
ŸŸ 	
static
€€ 
public
€€ 
PatientCard
€€ !
GetPatientCard
€€" 0
(
€€0 1
string
€€1 7

cardNumber
€€8 B
)
€€B C
{
‹‹ 	
try
›› 
{
ﬁﬁ 
using
ﬂﬂ 
(
ﬂﬂ 
SQLiteConnection
ﬂﬂ &
db
ﬂﬂ' )
=
ﬂﬂ* +
new
ﬂﬂ, /
SQLiteConnection
ﬂﬂ0 @
(
ﬂﬂ@ A
DBFile
ﬂﬂA G
)
ﬂﬂG H
)
ﬂﬂH I
{
‡‡ 
PatientCard
·· 
card
··  $
=
··% &
db
··' )
.
··) *
Query
··* /
<
··/ 0
PatientCard
··0 ;
>
··; <
(
··< =
$str
··= m
,
··m n

cardNumber
··o y
)
··y z
.
··z {
First··{ Ä
(··Ä Å
)··Å Ç
;··Ç É
return
‚‚ 
db
‚‚ 
.
‚‚ 
GetWithChildren
‚‚ -
<
‚‚- .
PatientCard
‚‚. 9
>
‚‚9 :
(
‚‚: ;
card
‚‚; ?
.
‚‚? @
CardID
‚‚@ F
)
‚‚F G
;
‚‚G H
}
„„ 
}
‰‰ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÊÊ 
ErrorHandler
ÁÁ 
.
ÁÁ 
	ShowError
ÁÁ &
(
ÁÁ& '
ex
ÁÁ' )
)
ÁÁ) *
;
ÁÁ* +
return
ËË 
null
ËË 
;
ËË 
}
ÈÈ 
}
ÍÍ 	
static
ÏÏ 
public
ÏÏ 
PatientCard
ÏÏ !%
GetPatientCardByPatient
ÏÏ" 9
(
ÏÏ9 :
int
ÏÏ: =
id
ÏÏ> @
)
ÏÏ@ A
{
ÌÌ 	
try
ÓÓ 
{
ÔÔ 
using
 
(
 
SQLiteConnection
 &
db
' )
=
* +
new
, /
SQLiteConnection
0 @
(
@ A
DBFile
A G
)
G H
)
H I
{
ÒÒ 
PatientCard
ÚÚ 
card
ÚÚ  $
=
ÚÚ% &
db
ÚÚ' )
.
ÚÚ) *
Query
ÚÚ* /
<
ÚÚ/ 0
PatientCard
ÚÚ0 ;
>
ÚÚ; <
(
ÚÚ< =
$str
ÚÚ= l
,
ÚÚl m
id
ÚÚn p
)
ÚÚp q
.
ÚÚq r
First
ÚÚr w
(
ÚÚw x
)
ÚÚx y
;
ÚÚy z
return
ÛÛ 
db
ÛÛ 
.
ÛÛ 
GetWithChildren
ÛÛ -
<
ÛÛ- .
PatientCard
ÛÛ. 9
>
ÛÛ9 :
(
ÛÛ: ;
card
ÛÛ; ?
.
ÛÛ? @
CardID
ÛÛ@ F
)
ÛÛF G
;
ÛÛG H
}
ÙÙ 
}
ıı 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ 
ex
ˆˆ 
)
ˆˆ  
{
˜˜ 
Logger
¯¯ 
.
¯¯ 
WriteLog
¯¯ 
(
¯¯  
ex
¯¯  "
)
¯¯" #
;
¯¯# $
return
˘˘ 
null
˘˘ 
;
˘˘ 
}
˙˙ 
}
˚˚ 	
static
˝˝ 
public
˝˝ 
Doctor
˝˝ 
	GetDoctor
˝˝ &
(
˝˝& '
string
˝˝' -
login
˝˝. 3
)
˝˝3 4
{
˛˛ 	
try
ˇˇ 
{
ÄÄ 
using
ÅÅ 
(
ÅÅ 
SQLiteConnection
ÅÅ &
db
ÅÅ' )
=
ÅÅ* +
new
ÅÅ, /
SQLiteConnection
ÅÅ0 @
(
ÅÅ@ A
DBFile
ÅÅA G
)
ÅÅG H
)
ÅÅH I
{
ÇÇ 
User
ÉÉ 
user
ÉÉ 
=
ÉÉ 
db
ÉÉ  "
.
ÉÉ" #
Query
ÉÉ# (
<
ÉÉ( )
User
ÉÉ) -
>
ÉÉ- .
(
ÉÉ. /
$str
ÉÉ/ S
,
ÉÉS T
login
ÉÉU Z
)
ÉÉZ [
.
ÉÉ[ \
First
ÉÉ\ a
(
ÉÉa b
)
ÉÉb c
;
ÉÉc d
Doctor
ÑÑ 
doctor
ÑÑ !
=
ÑÑ" #
db
ÑÑ$ &
.
ÑÑ& '
Query
ÑÑ' ,
<
ÑÑ, -
Doctor
ÑÑ- 3
>
ÑÑ3 4
(
ÑÑ4 5
$str
ÑÑ5 \
,
ÑÑ\ ]
user
ÑÑ^ b
.
ÑÑb c
ID
ÑÑc e
)
ÑÑe f
.
ÑÑf g
First
ÑÑg l
(
ÑÑl m
)
ÑÑm n
;
ÑÑn o
return
ÖÖ 
db
ÖÖ 
.
ÖÖ 
GetWithChildren
ÖÖ -
<
ÖÖ- .
Doctor
ÖÖ. 4
>
ÖÖ4 5
(
ÖÖ5 6
doctor
ÖÖ6 <
.
ÖÖ< =
DoctorID
ÖÖ= E
)
ÖÖE F
;
ÖÖF G
}
ÜÜ 
}
áá 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
ââ 
ErrorHandler
ää 
.
ää 
	ShowError
ää &
(
ää& '
ex
ää' )
)
ää) *
;
ää* +
return
ãã 
null
ãã 
;
ãã 
}
åå 
}
çç 	
static
èè 
public
èè 
Doctor
èè 
	GetDoctor
èè &
(
èè& '
int
èè' *
ID
èè+ -
)
èè- .
{
êê 	
try
ëë 
{
íí 
using
ìì 
(
ìì 
SQLiteConnection
ìì &
db
ìì' )
=
ìì* +
new
ìì, /
SQLiteConnection
ìì0 @
(
ìì@ A
DBFile
ììA G
)
ììG H
)
ììH I
{
îî 
return
ïï 
db
ïï 
.
ïï 
GetWithChildren
ïï -
<
ïï- .
Doctor
ïï. 4
>
ïï4 5
(
ïï5 6
ID
ïï6 8
)
ïï8 9
;
ïï9 :
}
ññ 
}
óó 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
ôô 
ErrorHandler
öö 
.
öö 
	ShowError
öö &
(
öö& '
ex
öö' )
)
öö) *
;
öö* +
return
õõ 
null
õõ 
;
õõ 
}
úú 
}
ùù 	
static
üü 
public
üü 
DoctorVisit
üü !
GetDoctorVisit
üü" 0
(
üü0 1
int
üü1 4
ID
üü5 7
)
üü7 8
{
†† 	
try
°° 
{
¢¢ 
using
££ 
(
££ 
SQLiteConnection
££ '
db
££( *
=
££+ ,
new
££- 0
SQLiteConnection
££1 A
(
££A B
DBFile
££B H
)
££H I
)
££I J
return
§§ 
db
§§ 
.
§§ 
GetWithChildren
§§ -
<
§§- .
DoctorVisit
§§. 9
>
§§9 :
(
§§: ;
ID
§§; =
)
§§= >
;
§§> ?
}
•• 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
ex
¶¶ 
)
¶¶  
{
ßß 
Logger
®® 
.
®® 
WriteLog
®® 
(
®®  
ex
®®  "
)
®®" #
;
®®# $
return
©© 
null
©© 
;
©© 
}
™™ 
}
´´ 	
static
≠≠ 
public
≠≠ 
List
≠≠ 
<
≠≠ 
DoctorVisit
≠≠ &
>
≠≠& '
	GetVisits
≠≠( 1
(
≠≠1 2
)
≠≠2 3
{
ÆÆ 	
try
ØØ 
{
∞∞ 
List
±± 
<
±± 
DoctorVisit
±±  
>
±±  !
visits
±±" (
;
±±( )
using
≥≥ 
(
≥≥ 
SQLiteConnection
≥≥ '
db
≥≥( *
=
≥≥+ ,
new
≥≥- 0
SQLiteConnection
≥≥1 A
(
≥≥A B
DBFile
≥≥B H
)
≥≥H I
)
≥≥I J
visits
¥¥ 
=
¥¥ 
db
¥¥ 
.
¥¥   
GetAllWithChildren
¥¥  2
<
¥¥2 3
DoctorVisit
¥¥3 >
>
¥¥> ?
(
¥¥? @
)
¥¥@ A
;
¥¥A B
return
∂∂ 
visits
∂∂ 
;
∂∂ 
}
∑∑ 
catch
∏∏ 
(
∏∏ 
	Exception
∏∏ 
ex
∏∏ 
)
∏∏  
{
ππ 
Logger
∫∫ 
.
∫∫ 
WriteLog
∫∫ 
(
∫∫  
ex
∫∫  "
)
∫∫" #
;
∫∫# $
return
ªª 
null
ªª 
;
ªª 
}
ºº 
}
ΩΩ 	
static
øø 
public
øø 
List
øø 
<
øø 
DoctorVisit
øø &
>
øø& ' 
GetVisitsByPatient
øø( :
(
øø: ;
int
øø; >
id
øø? A
)
øøA B
{
¿¿ 	
try
¡¡ 
{
¬¬ 
PatientCard
ƒƒ 
card
ƒƒ  
=
ƒƒ! "%
GetPatientCardByPatient
ƒƒ# :
(
ƒƒ: ;
id
ƒƒ; =
)
ƒƒ= >
;
ƒƒ> ?
List
«« 
<
«« 
DoctorVisit
««  
>
««  !
visits
««" (
;
««( )
using
…… 
(
…… 
SQLiteConnection
…… '
db
……( *
=
……+ ,
new
……- 0
SQLiteConnection
……1 A
(
……A B
DBFile
……B H
)
……H I
)
……I J
{
   
visits
ÀÀ 
=
ÀÀ 
db
ÀÀ 
.
ÀÀ   
GetAllWithChildren
ÀÀ  2
<
ÀÀ2 3
DoctorVisit
ÀÀ3 >
>
ÀÀ> ?
(
ÀÀ? @
)
ÀÀ@ A
;
ÀÀA B
visits
ÃÃ 
=
ÃÃ 
visits
ÃÃ #
.
ÃÃ# $
Where
ÃÃ$ )
(
ÃÃ) *
i
ÃÃ* +
=>
ÃÃ, .
i
ÃÃ/ 0
.
ÃÃ0 1
PatientCardID
ÃÃ1 >
==
ÃÃ? A
card
ÃÃB F
.
ÃÃF G
CardID
ÃÃG M
)
ÃÃM N
.
ÃÃN O
ToList
ÃÃO U
(
ÃÃU V
)
ÃÃV W
;
ÃÃW X
}
ÕÕ 
return
œœ 
visits
œœ 
;
œœ 
}
–– 
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
——  
{
““ 
Logger
”” 
.
”” 
WriteLog
”” 
(
””  
ex
””  "
)
””" #
;
””# $
return
‘‘ 
null
‘‘ 
;
‘‘ 
}
’’ 
}
÷÷ 	
static
ÿÿ 
public
ÿÿ 
List
ÿÿ 
<
ÿÿ 
DoctorVisit
ÿÿ &
>
ÿÿ& '
GetVisitsByDoctor
ÿÿ( 9
(
ÿÿ9 :
int
ÿÿ: =
id
ÿÿ> @
)
ÿÿ@ A
{
ŸŸ 	
try
⁄⁄ 
{
€€ 
List
‹‹ 
<
‹‹ 
DoctorVisit
‹‹  
>
‹‹  !
visits
‹‹" (
;
‹‹( )
using
ﬁﬁ 
(
ﬁﬁ 
SQLiteConnection
ﬁﬁ '
db
ﬁﬁ( *
=
ﬁﬁ+ ,
new
ﬁﬁ- 0
SQLiteConnection
ﬁﬁ1 A
(
ﬁﬁA B
DBFile
ﬁﬁB H
)
ﬁﬁH I
)
ﬁﬁI J
{
ﬂﬂ 
visits
‡‡ 
=
‡‡ 
db
‡‡ 
.
‡‡  
Query
‡‡  %
<
‡‡% &
DoctorVisit
‡‡& 1
>
‡‡1 2
(
‡‡2 3
$str
‡‡3 a
,
‡‡a b
id
‡‡c e
)
‡‡e f
.
‡‡f g
ToList
‡‡g m
(
‡‡m n
)
‡‡n o
;
‡‡o p
}
·· 
return
„„ 
visits
„„ 
;
„„ 
}
‰‰ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÊÊ 
Logger
ÁÁ 
.
ÁÁ 
WriteLog
ÁÁ 
(
ÁÁ  
ex
ÁÁ  "
)
ÁÁ" #
;
ÁÁ# $
return
ËË 
null
ËË 
;
ËË 
}
ÈÈ 
}
ÍÍ 	
static
ÏÏ 
public
ÏÏ 
Administrator
ÏÏ #
GetAdmin
ÏÏ$ ,
(
ÏÏ, -
string
ÏÏ- 3
login
ÏÏ4 9
)
ÏÏ9 :
{
ÌÌ 	
try
ÓÓ 
{
ÔÔ 
using
 
(
 
SQLiteConnection
 '
db
( *
=
+ ,
new
- 0
SQLiteConnection
1 A
(
A B
DBFile
B H
)
H I
)
I J
{
ÒÒ 
User
ÚÚ 
user
ÚÚ 
=
ÚÚ 
db
ÚÚ  "
.
ÚÚ" #
Query
ÚÚ# (
<
ÚÚ( )
User
ÚÚ) -
>
ÚÚ- .
(
ÚÚ. /
$str
ÚÚ/ S
,
ÚÚS T
login
ÚÚU Z
)
ÚÚZ [
.
ÚÚ[ \
First
ÚÚ\ a
(
ÚÚa b
)
ÚÚb c
;
ÚÚc d
Administrator
ÛÛ !
admin
ÛÛ" '
=
ÛÛ( )
db
ÛÛ* ,
.
ÛÛ, -
Query
ÛÛ- 2
<
ÛÛ2 3
Administrator
ÛÛ3 @
>
ÛÛ@ A
(
ÛÛA B
$str
ÛÛB p
,
ÛÛp q
user
ÛÛr v
.
ÛÛv w
ID
ÛÛw y
)
ÛÛy z
.
ÛÛz {
FirstÛÛ{ Ä
(ÛÛÄ Å
)ÛÛÅ Ç
;ÛÛÇ É
return
ÙÙ 
db
ÙÙ 
.
ÙÙ 
GetWithChildren
ÙÙ -
<
ÙÙ- .
Administrator
ÙÙ. ;
>
ÙÙ; <
(
ÙÙ< =
admin
ÙÙ= B
.
ÙÙB C
AdminID
ÙÙC J
)
ÙÙJ K
;
ÙÙK L
}
ıı 
}
ˆˆ 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
¯¯ 
Logger
˘˘ 
.
˘˘ 
WriteLog
˘˘ 
(
˘˘  
ex
˘˘  "
)
˘˘" #
;
˘˘# $
return
˙˙ 
null
˙˙ 
;
˙˙ 
}
˚˚ 
}
¸¸ 	
static
˛˛ 
public
˛˛ 
List
˛˛ 
<
˛˛ 
Doctor
˛˛ !
>
˛˛! "

GetDoctors
˛˛# -
(
˛˛- .
)
˛˛. /
{
ˇˇ 	
try
ÄÄ 
{
ÅÅ 
List
ÇÇ 
<
ÇÇ 
Doctor
ÇÇ 
>
ÇÇ 
doctors
ÇÇ $
;
ÇÇ$ %
using
ÑÑ 
(
ÑÑ 
SQLiteConnection
ÑÑ '
db
ÑÑ( *
=
ÑÑ+ ,
new
ÑÑ- 0
SQLiteConnection
ÑÑ1 A
(
ÑÑA B
DBFile
ÑÑB H
)
ÑÑH I
)
ÑÑI J
{
ÖÖ 
doctors
ÜÜ 
=
ÜÜ 
db
ÜÜ  
.
ÜÜ  ! 
GetAllWithChildren
ÜÜ! 3
<
ÜÜ3 4
Doctor
ÜÜ4 :
>
ÜÜ: ;
(
ÜÜ; <
)
ÜÜ< =
;
ÜÜ= >
}
áá 
return
ââ 
doctors
ââ 
;
ââ 
}
ää 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
åå 
Logger
çç 
.
çç 
WriteLog
çç 
(
çç  
ex
çç  "
)
çç" #
;
çç# $
return
éé 
null
éé 
;
éé 
}
èè 
}
êê 	
static
íí 
public
íí 
Feedback
íí 
GetFeedback
íí *
(
íí* +
int
íí+ .
ID
íí/ 1
)
íí1 2
{
ìì 	
try
îî 
{
ïï 
using
ññ 
(
ññ 
SQLiteConnection
ññ '
db
ññ( *
=
ññ+ ,
new
ññ- 0
SQLiteConnection
ññ1 A
(
ññA B
DBFile
ññB H
)
ññH I
)
ññI J
{
óó 
return
òò 
db
òò 
.
òò 
GetWithChildren
òò -
<
òò- .
Feedback
òò. 6
>
òò6 7
(
òò7 8
ID
òò8 :
)
òò: ;
;
òò; <
}
ôô 
}
öö 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
úú 
Logger
ùù 
.
ùù 
WriteLog
ùù 
(
ùù  
ex
ùù  "
)
ùù" #
;
ùù# $
return
ûû 
null
ûû 
;
ûû 
}
üü 
}
†† 	
}
°° 
}¢¢ ¶

FD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\ErrorHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
ErrorHandler $
{ 
static 
public 
void 
	ShowError $
($ %
string% +
error, 1
)1 2
{		 	

MessageBox

 
.

 
Show

 
(

 
error 
, 
$str "
," #
MessageBoxButtons !
.! "
OK" $
,$ %
MessageBoxIcon 
. 
Error $
) 
; 
} 	
static 
public 
void 
	ShowError $
($ %
	Exception% .
	exception/ 8
)8 9
{ 	

MessageBox 
. 
Show 
( 
	exception 
. 
ToString "
(" #
)# $
,$ %
$str "
," #
MessageBoxButtons !
.! "
OK" $
,$ %
MessageBoxIcon 
. 
Error $
) 
; 
} 	
} 
} ö=
HD:\git\PolyclinicSystem\PolyclinicSystem\Forms\Authorization\MainForm.cs
	namespace 	
PolyclinicSystem
 
{ 
public 

partial 
class 
MainForm !
:" #
Form$ (
{		 
static

 
public

 
Patient

 

CurPatient

 (
;

( )
static 
public 
Doctor 
	CurDoctor &
;& '
static 
public 
Administrator #
CurAdmin$ ,
;, -
static 
public 
string 
currentUser (
=) *
$str+ -
;- .
public 
MainForm 
( 
) 
{ 	
InitializeComponent 
(  
)  !
;! "
Logger 
. 
ActivateLogger !
(! "
)" #
;# $
} 	
private 
void 
MainForm_Load "
(" #
object# )
sender* 0
,0 1
	EventArgs2 ;
e< =
)= >
{ 	
if 
( 
! 
File 
. 
Exists 
( 
$str +
)+ ,
), -
{ 
bool 
result 
= 
DataHandler )
.) *
CreateDatabase* 8
(8 9
)9 :
;: ;
if 
( 
! 
result 
) 
Close 
( 
) 
; 
} 
} 	
private"" 
void"" 
signInButton_Click"" '
(""' (
object""( .
sender""/ 5
,""5 6
	EventArgs""7 @
e""A B
)""B C
{## 	
try$$ 
{%% 
User&& 
user&& 
=&& 
Authorization&& )
.&&) *
SignIn&&* 0
(&&0 1
loginTextBox&&1 =
.&&= >
Text&&> B
,&&B C
passwordTextBox&&D S
.&&S T
Text&&T X
)&&X Y
;&&Y Z
if'' 
('' 
user'' 
!='' 
null''  
)''  !
{(( 
string** 
userType** #
=**$ %
Authorization**& 3
.**3 4

DefineUser**4 >
(**> ?
user**? C
)**C D
;**D E
Authorization,, !
.,,! "
SetUser,," )
(,,) *
user,,* .
,,,. /
userType,,0 8
),,8 9
;,,9 :
if.. 
(.. 
userType..  
==..! #
$str..$ -
)..- .
{// 
PatientForm00 #
patientForm00$ /
=000 1
new002 5
PatientForm006 A
(00A B
)00B C
;00C D
patientForm11 #
.11# $

FormClosed11$ .
+=11/ 1
UserForm_FormClosed112 E
;11E F
patientForm22 #
.22# $
Show22$ (
(22( )
)22) *
;22* +
}33 
else44 
if44 
(44 
userType44 %
==44& (
$str44) 1
)441 2
{55 

DoctorForm66 "

doctorForm66# -
=66. /
new660 3

DoctorForm664 >
(66> ?
)66? @
;66@ A

doctorForm77 "
.77" #

FormClosed77# -
+=77. 0
UserForm_FormClosed771 D
;77D E

doctorForm88 "
.88" #
Show88# '
(88' (
)88( )
;88) *
}99 
else:: 
if:: 
(:: 
userType:: %
==::& (
$str::) 0
)::0 1
{;; 
	AdminForm<< !
	adminForm<<" +
=<<, -
new<<. 1
	AdminForm<<2 ;
(<<; <
)<<< =
;<<= >
	adminForm== !
.==! "

FormClosed==" ,
+===- /
UserForm_FormClosed==0 C
;==C D
	adminForm>> !
.>>! "
Show>>" &
(>>& '
)>>' (
;>>( )
}?? 
Visible@@ 
=@@ 
false@@ #
;@@# $
}AA 
}BB 
catchCC 
(CC 
	ExceptionCC 
exCC 
)CC  
{DD 
LoggerEE 
.EE 
WriteLogEE 
(EE  
exEE  "
)EE" #
;EE# $
}FF 
}GG 	
privateJJ 
voidJJ 
signUpButton_ClickJJ '
(JJ' (
objectJJ( .
senderJJ/ 5
,JJ5 6
	EventArgsJJ7 @
eJJA B
)JJB C
{KK 	
tryLL 
{MM 

SignUpFormNN 

signUpFormNN %
=NN& '
newNN( +

SignUpFormNN, 6
(NN6 7
)NN7 8
;NN8 9

signUpFormOO 
.OO 

FormClosedOO %
+=OO& (!
SignUpForm_FormClosedOO) >
;OO> ?

signUpFormPP 
.PP 
ShowPP 
(PP  
)PP  !
;PP! "
VisibleQQ 
=QQ 
falseQQ 
;QQ  
}RR 
catchSS 
(SS 
	ExceptionSS 
exSS 
)SS  
{TT 
LoggerUU 
.UU 
WriteLogUU 
(UU  
exUU  "
)UU" #
;UU# $
}VV 
}WW 	
privateZZ 
voidZZ %
forgotPasswordLabel_ClickZZ .
(ZZ. /
objectZZ/ 5
senderZZ6 <
,ZZ< =
	EventArgsZZ> G
eZZH I
)ZZI J
{[[ 	
try\\ 
{]] 
ForgotPasswordForm^^ "
form^^# '
=^^( )
new^^* -
ForgotPasswordForm^^. @
(^^@ A
)^^A B
;^^B C
form__ 
.__ 

FormClosed__ 
+=__  ")
ForgotPasswordForm_FormClosed__# @
;__@ A
form`` 
.`` 
Show`` 
(`` 
)`` 
;`` 
Visibleaa 
=aa 
falseaa 
;aa  
}bb 
catchcc 
(cc 
	Exceptioncc 
excc 
)cc  
{dd 
Loggeree 
.ee 
WriteLogee 
(ee  
exee  "
)ee" #
;ee# $
}ff 
}gg 	
privatejj 
voidjj )
ForgotPasswordForm_FormClosedjj 2
(jj2 3
objectjj3 9
senderjj: @
,jj@ A
FormClosedEventArgsjjB U
ejjV W
)jjW X
{kk 	
Visiblell 
=ll 
truell 
;ll 
}mm 	
privatepp 
voidpp !
SignUpForm_FormClosedpp *
(pp* +
objectpp+ 1
senderpp2 8
,pp8 9
FormClosedEventArgspp: M
eppN O
)ppO P
{qq 	
Visiblerr 
=rr 
truerr 
;rr 
}ss 	
privatevv 
voidvv 
UserForm_FormClosedvv (
(vv( )
objectvv) /
sendervv0 6
,vv6 7
FormClosedEventArgsvv8 K
evvL M
)vvM N
{ww 	
Authorizationxx 
.xx 

LogoutUserxx $
(xx$ %
)xx% &
;xx& '
loginTextBoxyy 
.yy 
Textyy 
=yy 
$stryy  "
;yy" #
passwordTextBoxzz 
.zz 
Textzz  
=zz! "
$strzz# %
;zz% &
Visible{{ 
={{ 
true{{ 
;{{ 
}|| 	
}}} 
}~~ º
3D:\git\PolyclinicSystem\PolyclinicSystem\Program.cs
	namespace 	
PolyclinicSystem
 
{ 
static		 

class		 
Program		 
{

 
[ 	
	STAThread	 
] 
static 
void 
Main 
( 
) 
{ 	
Application 
. 
EnableVisualStyles *
(* +
)+ ,
;, -
Application 
. -
!SetCompatibleTextRenderingDefault 9
(9 :
false: ?
)? @
;@ A
Application 
. 
Run 
( 
new 
MainForm  (
(( )
)) *
)* +
;+ ,
} 	
} 
} Ó
CD:\git\PolyclinicSystem\PolyclinicSystem\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str +
)+ ,
], -
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 !
)		! "
]		" #
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str 
) 
] 
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str -
)- .
]. /
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str 0
)0 1
]1 2
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str 
)  
]  !
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *™
@D:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\Logger.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
Logger 
{ 
static 
public 
void 
ActivateLogger )
() *
)* +
{		 	
	Directory

 
.

 
CreateDirectory

 %
(

% &
$str

& ,
)

, -
;

- .
} 	
static 
public 
void 
WriteLog #
(# $
string$ *
message+ 2
)2 3
{ 	
string 
currentDate 
=  
DateTime! )
.) *
Today* /
./ 0
ToString0 8
(8 9
$str9 E
)E F
;F G
using 
( 
StreamWriter 
sw  "
=# $
new% (
StreamWriter) 5
(5 6
$str6 ?
+@ A
currentDateB M
+N O
$strP V
,V W
trueX \
,\ ]
System^ d
.d e
Texte i
.i j
Encodingj r
.r s
UTF8s w
)w x
)x y
{ 
sw 
. 
	WriteLine 
( 
$str ;
); <
;< =
sw 
. 
	WriteLine 
( 
DateTime %
.% &
Now& )
)) *
;* +
sw 
. 
	WriteLine 
( 
message $
)$ %
;% &
} 
} 	
static 
public 
void 
WriteLog #
(# $
	Exception$ -
message. 5
)5 6
{ 	
string 
currentDate 
=  
DateTime! )
.) *
Today* /
./ 0
ToString0 8
(8 9
$str9 E
)E F
;F G
using 
( 
StreamWriter 
sw  "
=# $
new% (
StreamWriter) 5
(5 6
$str6 ?
+@ A
currentDateB M
+N O
$strP V
,V W
trueX \
,\ ]
System^ d
.d e
Texte i
.i j
Encodingj r
.r s
UTF8s w
)w x
)x y
{ 
sw 
. 
	WriteLine 
( 
$str ;
); <
;< =
sw 
. 
	WriteLine 
( 
DateTime %
.% &
Now& )
)) *
;* +
sw 
. 
	WriteLine 
( 
message $
.$ %
ToString% -
(- .
). /
)/ 0
;0 1
}   
}!! 	
}"" 
}## ⁄
ID:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\MessagesHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
class 	
MessagesHandler
 
{ 
static 
public 
void 
ShowMessage &
(& '
string' -
message. 5
)5 6
{ 	

MessageBox		 
.		 
Show		 
(		 
message

 
,

 
$str 
, 
MessageBoxButtons !
.! "
OK" $
,$ %
MessageBoxIcon 
. 
Information *
) 
; 
} 	
} 
} ·E
ID:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\ProfilesHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
ProfilesHandler '
{ 
static 
public 
bool 
EditUser #
(# $
User$ (
user) -
,- .
string/ 5
login6 ;
,; <
string= C
emailD I
,I J
stringK Q
nameR V
,V W
stringX ^
password_ g
)g h
{ 	
bool 
result 
= 
false 
;  
if		 
(		 
IsEmpty		 
(		 
login		 
)		 
)		 
ErrorHandler

 
.

 
	ShowError

 &
(

& '
$str

' 8
)

8 9
;

9 :
else 
if 
( 
IsEmpty 
( 
email "
)" #
)# $
ErrorHandler 
. 
	ShowError &
(& '
$str' E
)E F
;F G
else 
if 
( 
IsEmpty 
( 
name !
)! "
)" #
ErrorHandler 
. 
	ShowError &
(& '
$str' 7
)7 8
;8 9
else 
if 
( 
IsEmpty 
( 
password %
)% &
)& '
ErrorHandler 
. 
	ShowError &
(& '
$str' 9
)9 :
;: ;
else 
if 
( 
! 
	Validator 
.  

CheckEmail  *
(* +
email+ 0
)0 1
)1 2
ErrorHandler 
. 
	ShowError &
(& '
$str' J
)J K
;K L
else 
{ 
if 
( 
DataHandler 
.  

GetPatient  *
(* +
login+ 0
)0 1
!=2 4
null5 9
)9 :
ErrorHandler  
.  !
	ShowError! *
(* +
$str+ F
)F G
;G H
else 
{ 
user 
. 
Edit 
( 
name "
," #
email$ )
,) *
password+ 3
,3 4
login5 :
): ;
;; <
DataHandler 
.  
UpdateInDatabase  0
(0 1
user1 5
)5 6
;6 7
return 
true 
;  
} 
} 
return   
result   
;   
}!! 	
static## 
public## 
bool## 
EditPatient## &
(##& '
Patient##' .
patient##/ 6
,##6 7
string##8 >
oms##? B
,##B C
string##D J
jobplace##K S
,##S T
string##U [
phone##\ a
,##a b
string##c i
address##j q
)##q r
{$$ 	
bool%% 
result%% 
=%% 
false%% 
;%%  
if'' 
('' 
IsEmpty'' 
('' 
oms'' 
)'' 
)'' 
ErrorHandler(( 
.(( 
	ShowError(( &
(((& '
$str((' 6
)((6 7
;((7 8
else)) 
if)) 
()) 
IsEmpty)) 
()) 
phone)) "
)))" #
)))# $
ErrorHandler** 
.** 
	ShowError** &
(**& '
$str**' A
)**A B
;**B C
else++ 
if++ 
(++ 
IsEmpty++ 
(++ 
address++ $
)++$ %
)++% &
ErrorHandler,, 
.,, 
	ShowError,, &
(,,& '
$str,,' 8
),,8 9
;,,9 :
else-- 
if-- 
(-- 
!-- 
	Validator-- 
.--  
CheckOMS--  (
(--( )
oms--) ,
)--, -
)--- .
ErrorHandler.. 
... 
	ShowError.. &
(..& '
$str..' <
)..< =
;..= >
else// 
if// 
(// 
!// 
	Validator// 
.//  

CheckPhone//  *
(//* +
phone//+ 0
)//0 1
)//1 2
ErrorHandler00 
.00 
	ShowError00 &
(00& '
$str00' H
)00H I
;00I J
else11 
{22 
patient33 
.33 
Edit33 
(33 
oms33  
,33  !
jobplace33" *
,33* +
address33, 3
,333 4
phone335 :
)33: ;
;33; <
DataHandler44 
.44 
UpdateInDatabase44 ,
(44, -
patient44- 4
)444 5
;445 6
return55 
true55 
;55 
}66 
return88 
result88 
;88 
}99 	
static;; 
public;; 
bool;; 
	AddDoctor;; $
(;;$ %
string;;% +
login;;, 1
,;;1 2
string;;3 9
name;;: >
,;;> ?
string;;@ F
email;;G L
,;;L M
string;;N T
password;;U ]
,;;] ^
string;;_ e
	specialty;;f o
);;o p
{<< 	
bool== 
result== 
=== 
false== 
;==  
if?? 
(?? 
IsEmpty?? 
(?? 
login?? 
)?? 
)?? 
ErrorHandler@@ 
.@@ 
	ShowError@@ &
(@@& '
$str@@' 8
)@@8 9
;@@9 :
elseAA 
ifAA 
(AA 
IsEmptyAA 
(AA 
nameAA !
)AA! "
)AA" #
ErrorHandlerBB 
.BB 
	ShowErrorBB &
(BB& '
$strBB' 7
)BB7 8
;BB8 9
elseCC 
ifCC 
(CC 
IsEmptyCC 
(CC 
emailCC "
)CC" #
)CC# $
ErrorHandlerDD 
.DD 
	ShowErrorDD &
(DD& '
$strDD' E
)DDE F
;DDF G
elseEE 
ifEE 
(EE 
IsEmptyEE 
(EE 
passwordEE %
)EE% &
)EE& '
ErrorHandlerFF 
.FF 
	ShowErrorFF &
(FF& '
$strFF' 9
)FF9 :
;FF: ;
elseGG 
ifGG 
(GG 
IsEmptyGG 
(GG 
	specialtyGG &
)GG& '
)GG' (
ErrorHandlerHH 
.HH 
	ShowErrorHH &
(HH& '
$strHH' A
)HHA B
;HHB C
elseII 
ifII 
(II 
!II 
	ValidatorII 
.II  

CheckEmailII  *
(II* +
emailII+ 0
)II0 1
)II1 2
ErrorHandlerJJ 
.JJ 
	ShowErrorJJ &
(JJ& '
$strJJ' N
)JJN O
;JJO P
elseKK 
{LL 
ifNN 
(NN 
DataHandlerNN 
.NN  

GetPatientNN  *
(NN* +
loginNN+ 0
)NN0 1
!=NN2 4
nullNN5 9
)NN9 :
ErrorHandlerOO  
.OO  !
	ShowErrorOO! *
(OO* +
$strOO+ F
)OOF G
;OOG H
elsePP 
{QQ 
DataHandlerRR 
.RR  
	AddDoctorRR  )
(RR) *
loginRR* /
,RR/ 0
nameRR1 5
,RR5 6
emailRR7 <
,RR< =
passwordRR> F
,RRF G
	specialtyRRH Q
)RRQ R
;RRR S
MessagesHandlerSS #
.SS# $
ShowMessageSS$ /
(SS/ 0
$strSS0 E
)SSE F
;SSF G
returnTT 
trueTT 
;TT  
}UU 
}VV 
returnXX 
resultXX 
;XX 
}YY 	
static[[ 
private[[ 
bool[[ 
IsEmpty[[ #
([[# $
string[[$ *
value[[+ 0
)[[0 1
{\\ 	
if]] 
(]] 
(]] 
value]] 
==]] 
null]] 
)]] 
||]]  "
(]]# $
value]]$ )
==]]* ,
$str]]- /
)]]/ 0
)]]0 1
return^^ 
true^^ 
;^^ 
else__ 
return__ 
false__ 
;__ 
}`` 	
}aa 
}bb ∆$
CD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\Validator.cs
	namespace 	
PolyclinicSystem
 
{ 
static 

public 
class 
	Validator !
{ 
static 
public 
bool 

CheckEmail %
(% &
string& ,
email- 2
)2 3
{		 	
string

 
pattern

 
=

 
$str

 -
;

- .
return 
Regex 
. 
IsMatch  
(  !
email! &
,& '
pattern( /
)/ 0
;0 1
} 	
static 
public 
bool 
CheckOMS #
(# $
string$ *
oms+ .
). /
{ 	
string 
pattern 
= 
$str (
;( )
return 
Regex 
. 
IsMatch  
(  !
oms! $
,$ %
pattern& -
)- .
;. /
} 	
static 
public 
bool 

CheckPhone %
(% &
string& ,
phone- 2
)2 3
{ 	
string 
pattern1 
= 
$str *
;* +
string 
pattern2 
= 
$str (
;( )
return 
( 
( 
Regex 
. 
IsMatch "
(" #
phone# (
,( )
pattern1* 2
)2 3
)3 4
||5 7
Regex8 =
.= >
IsMatch> E
(E F
phoneF K
,K L
pattern2M U
)U V
)V W
;W X
} 	
static 
public 
bool 
IsDate !
(! "
string" (
date) -
)- .
{ 	
string 
pattern 
= 
$str 5
;5 6
return   
(   
Regex   
.   
IsMatch   !
(  ! "
date  " &
,  & '
pattern  ( /
)  / 0
)  0 1
;  1 2
}!! 	
static## 
public## 
bool## 
IsSpecialty## &
(##& '
string##' -
	specialty##. 7
)##7 8
{$$ 	
bool%% 
result%% 
=%% 
false%% 
;%%  
List'' 
<'' 
	Specialty'' 
>'' 
specialties'' '
=''( )
DataHandler''* 5
.''5 6
GetSpecialties''6 D
(''D E
)''E F
;''F G
foreach)) 
()) 
	Specialty)) 
spec)) #
in))$ &
specialties))' 2
)))2 3
if** 
(** 
spec** 
.** 
Name** 
==**  
	specialty**! *
)*** +
{++ 
result,, 
=,, 
true,, !
;,,! "
break-- 
;-- 
}.. 
return00 
result00 
;00 
}11 	
static33 
public33 
bool33 
IsStatus33 #
(33# $
string33$ *
status33+ 1
)331 2
{44 	
if55 
(55 
(55 
status55 
==55 
$str55 %
)55% &
||55' )
(55* +
status55+ 1
==552 4
$str555 >
)55> ?
||55@ B
(55C D
status55D J
==55K M
$str55N Y
)55Y Z
||55[ ]
(55^ _
status55_ e
==55f h
$str55i s
)55s t
)55t u
return66 
true66 
;66 
else77 
return77 
false77 
;77 
}88 	
static:: 
public:: 
bool:: 
IsType:: !
(::! "
string::" (
type::) -
)::- .
{;; 	
if<< 
(<< 
(<< 
type<< 
==<< 
$str<< !
)<<! "
||<<# %
(<<& '
type<<' +
==<<, .
$str<</ 8
)<<8 9
||<<: <
(<<= >
type<<> B
==<<C E
$str<<F U
)<<U V
)<<V W
return== 
true== 
;== 
else>> 
return>> 
false>> 
;>> 
}?? 	
}@@ 
}AA øß
GD:\git\PolyclinicSystem\PolyclinicSystem\SystemClasses\VisitsHandler.cs
	namespace 	
PolyclinicSystem
 
{ 
public 

static 
class 
VisitsHandler %
{		 
static 
public 
	DataTable 
GetDataTable  ,
(, -
string- 3
usertype4 <
)< =
{ 	
	DataTable 
dt 
= 
new 
	DataTable (
(( )
)) *
;* +
try 
{ 
switch 
( 
usertype  
)  !
{ 
case 
$str "
:" #
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 :
,: ;
typeof< B
(B C
intC F
)F G
)G H
)H I
;I J
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 C
,C D
typeofE K
(K L
stringL R
)R S
)S T
)T U
;U V
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 >
,> ?
typeof@ F
(F G
stringG M
)M N
)N O
)O P
;P Q
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 B
,B C
typeofD J
(J K
stringK Q
)Q R
)R S
)S T
;T U
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 A
,A B
typeofC I
(I J
stringJ P
)P Q
)Q R
)R S
;S T
break 
; 
case 
$str !
:! "
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 :
,: ;
typeof< B
(B C
intC F
)F G
)G H
)H I
;I J
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 C
,C D
typeofE K
(K L
stringL R
)R S
)S T
)T U
;U V
dt 
. 
Columns "
." #
Add# &
(& '
new' *

DataColumn+ 5
(5 6
$str6 >
,> ?
typeof@ F
(F G
stringG M
)M N
)N O
)O P
;P Q
dt   
.   
Columns   "
.  " #
Add  # &
(  & '
new  ' *

DataColumn  + 5
(  5 6
$str  6 D
,  D E
typeof  F L
(  L M
string  M S
)  S T
)  T U
)  U V
;  V W
break!! 
;!! 
case"" 
$str""  
:""  !
dt## 
.## 
Columns## "
.##" #
Add### &
(##& '
new##' *

DataColumn##+ 5
(##5 6
$str##6 :
,##: ;
typeof##< B
(##B C
int##C F
)##F G
)##G H
)##H I
;##I J
dt$$ 
.$$ 
Columns$$ "
.$$" #
Add$$# &
($$& '
new$$' *

DataColumn$$+ 5
($$5 6
$str$$6 C
,$$C D
typeof$$E K
($$K L
string$$L R
)$$R S
)$$S T
)$$T U
;$$U V
dt%% 
.%% 
Columns%% "
.%%" #
Add%%# &
(%%& '
new%%' *

DataColumn%%+ 5
(%%5 6
$str%%6 >
,%%> ?
typeof%%@ F
(%%F G
string%%G M
)%%M N
)%%N O
)%%O P
;%%P Q
dt&& 
.&& 
Columns&& "
.&&" #
Add&&# &
(&&& '
new&&' *

DataColumn&&+ 5
(&&5 6
$str&&6 D
,&&D E
typeof&&F L
(&&L M
string&&M S
)&&S T
)&&T U
)&&U V
;&&V W
dt'' 
.'' 
Columns'' "
.''" #
Add''# &
(''& '
new''' *

DataColumn''+ 5
(''5 6
$str''6 A
,''A B
typeof''C I
(''I J
string''J P
)''P Q
)''Q R
)''R S
;''S T
break(( 
;(( 
})) 
}** 
catch++ 
(++ 
	Exception++ 
ex++ 
)++  
{,, 
Logger-- 
.-- 
WriteLog-- 
(--  
ex--  "
)--" #
;--# $
return.. 
null.. 
;.. 
}// 
return11 
dt11 
;11 
}22 	
static55 
public55 
	DataTable55 
FillData55  (
(55( )
string55) /
usertype550 8
,558 9
	DataTable55: C
dt55D F
)55F G
{66 	
dt77 
.77 
Rows77 
.77 
Clear77 
(77 
)77 
;77 
try99 
{:: 
List;; 
<;; 
DoctorVisit;;  
>;;  !
visits;;" (
;;;( )
switch<< 
(<< 
usertype<< 
)<<  
{== 
case>> 
$str>> "
:>>" #
visits?? 
=??  
DataHandler??! ,
.??, -
GetVisitsByPatient??- ?
(??? @
MainForm??@ H
.??H I

CurPatient??I S
.??S T
	PatientID??T ]
)??] ^
;??^ _
foreach@@ 
(@@  !
DoctorVisit@@! ,
visit@@- 2
in@@3 5
visits@@6 <
)@@< =
{AA 
stringCC "
dateCC# '
=CC( )
visitCC* /
.CC/ 0
DateCC0 4
;CC4 5
stringEE "
	specialtyEE# ,
=EE- .
DataHandlerEE/ :
.EE: ; 
GetSpecialtyByDoctorEE; O
(EEO P
visitEEP U
.EEU V
DoctorIDEEV ^
)EE^ _
.EE_ `
NameEE` d
;EEd e
stringGG "
statusGG# )
=GG* +
visitGG, 1
.GG1 2
StatusGG2 8
;GG8 9
stringII "
nameII# '
=II( )
DataHandlerII* 5
.II5 6
	GetDoctorII6 ?
(II? @
visitII@ E
.IIE F
DoctorIDIIF N
)IIN O
.IIO P
UserIIP T
.IIT U
NameIIU Y
;IIY Z
dtLL 
.LL 
RowsLL #
.LL# $
AddLL$ '
(LL' (
visitLL( -
.LL- .
VisitIDLL. 5
,LL5 6
dateLL7 ;
,LL; <
statusLL= C
,LLC D
	specialtyLLE N
,LLN O
nameLLP T
)LLT U
;LLU V
}MM 
breakNN 
;NN 
caseOO 
$strOO !
:OO! "
visitsPP 
=PP  
DataHandlerPP! ,
.PP, -
GetVisitsByDoctorPP- >
(PP> ?
MainFormPP? G
.PPG H
	CurDoctorPPH Q
.PPQ R
DoctorIDPPR Z
)PPZ [
;PP[ \
foreachQQ 
(QQ  !
DoctorVisitQQ! ,
visitQQ- 2
inQQ3 5
visitsQQ6 <
)QQ< =
{RR 
stringTT "
dateTT# '
=TT( )
visitTT* /
.TT/ 0
DateTT0 4
;TT4 5
stringVV "
statusVV# )
=VV* +
visitVV, 1
.VV1 2
StatusVV2 8
;VV8 9
stringXX "
nameXX# '
=XX( )
DataHandlerXX* 5
.XX5 6

GetPatientXX6 @
(XX@ A
visitXXA F
.XXF G
PatientCardIDXXG T
)XXT U
.XXU V
UserXXV Z
.XXZ [
NameXX[ _
;XX_ `
dt[[ 
.[[ 
Rows[[ #
.[[# $
Add[[$ '
([[' (
visit[[( -
.[[- .
VisitID[[. 5
,[[5 6
date[[7 ;
,[[; <
status[[= C
,[[C D
name[[E I
)[[I J
;[[J K
}\\ 
break]] 
;]] 
case^^ 
$str^^  
:^^  !
visits__ 
=__  
DataHandler__! ,
.__, -
	GetVisits__- 6
(__6 7
)__7 8
;__8 9
foreach`` 
(``  !
DoctorVisit``! ,
visit``- 2
in``3 5
visits``6 <
)``< =
{aa 
stringcc "
datecc# '
=cc( )
visitcc* /
.cc/ 0
Datecc0 4
;cc4 5
stringee "
statusee# )
=ee* +
visitee, 1
.ee1 2
Statusee2 8
;ee8 9
stringgg "
patNamegg# *
=gg+ ,
DataHandlergg- 8
.gg8 9

GetPatientgg9 C
(ggC D
visitggD I
.ggI J
PatientCardIDggJ W
)ggW X
.ggX Y
UserggY ]
.gg] ^
Namegg^ b
;ggb c
stringii "
docNameii# *
=ii+ ,
DataHandlerii- 8
.ii8 9
	GetDoctorii9 B
(iiB C
visitiiC H
.iiH I
DoctorIDiiI Q
)iiQ R
.iiR S
UseriiS W
.iiW X
NameiiX \
;ii\ ]
dtll 
.ll 
Rowsll #
.ll# $
Addll$ '
(ll' (
visitll( -
.ll- .
VisitIDll. 5
,ll5 6
datell7 ;
,ll; <
statusll= C
,llC D
patNamellE L
,llL M
docNamellN U
)llU V
;llV W
}mm 
breaknn 
;nn 
}oo 
returnqq 
dtqq 
;qq 
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
Loggeruu 
.uu 
WriteLoguu 
(uu  
exuu  "
)uu" #
;uu# $
returnvv 
nullvv 
;vv 
}ww 
}xx 	
static{{ 
public{{ 
	DataTable{{ 
Search{{  &
({{& '
string{{' -
usertype{{. 6
,{{6 7
string{{8 >
query{{? D
,{{D E
	DataTable{{F O
dt{{P R
){{R S
{|| 	
if~~ 
(~~ 
(~~ 
query~~ 
==~~ 
$str~~ 
)~~ 
||~~  
(~~! "
query~~" '
==~~( *
null~~+ /
)~~/ 0
)~~0 1
return 
FillData 
(  
usertype  (
,( )
dt* ,
), -
;- .
string
ÇÇ 
[
ÇÇ 
]
ÇÇ 

queryParts
ÇÇ 
=
ÇÇ  !
query
ÇÇ" '
.
ÇÇ' (
Split
ÇÇ( -
(
ÇÇ- .
$char
ÇÇ. 1
)
ÇÇ1 2
;
ÇÇ2 3
switch
ÑÑ 
(
ÑÑ 
usertype
ÑÑ 
)
ÑÑ 
{
ÖÖ 
case
ÜÜ 
$str
ÜÜ 
:
ÜÜ 
foreach
áá 
(
áá 
string
áá "
qry
áá# &
in
áá' )

queryParts
áá* 4
)
áá4 5
{
àà 
if
ââ 
(
ââ 
	Validator
ââ $
.
ââ$ %
IsDate
ââ% +
(
ââ+ ,
qry
ââ, /
)
ââ/ 0
)
ââ0 1
dt
ää 
=
ää  

FilterData
ää! +
(
ää+ ,
dt
ää, .
,
ää. /
$str
ää0 =
,
ää= >
qry
ää? B
)
ääB C
;
ääC D
else
ãã 
if
ãã 
(
ãã  !
	Validator
ãã! *
.
ãã* +
IsSpecialty
ãã+ 6
(
ãã6 7
qry
ãã7 :
)
ãã: ;
)
ãã; <
dt
åå 
=
åå  

FilterData
åå! +
(
åå+ ,
dt
åå, .
,
åå. /
$str
åå0 <
,
åå< =
qry
åå> A
)
ååA B
;
ååB C
else
çç 
if
çç 
(
çç  !
	Validator
çç! *
.
çç* +
IsStatus
çç+ 3
(
çç3 4
qry
çç4 7
)
çç7 8
)
çç8 9
dt
éé 
=
éé  

FilterData
éé! +
(
éé+ ,
dt
éé, .
,
éé. /
$str
éé0 8
,
éé8 9
qry
éé: =
)
éé= >
;
éé> ?
else
èè 
dt
êê 
=
êê  

FilterData
êê! +
(
êê+ ,
dt
êê, .
,
êê. /
$str
êê0 ;
,
êê; <
qry
êê= @
)
êê@ A
;
êêA B
}
ëë 
break
íí 
;
íí 
case
ìì 
$str
ìì 
:
ìì 
foreach
îî 
(
îî 
string
îî #
qry
îî$ '
in
îî( *

queryParts
îî+ 5
)
îî5 6
{
ïï 
if
ññ 
(
ññ 
	Validator
ññ %
.
ññ% &
IsDate
ññ& ,
(
ññ, -
qry
ññ- 0
)
ññ0 1
)
ññ1 2
dt
óó 
=
óó  

FilterData
óó! +
(
óó+ ,
dt
óó, .
,
óó. /
$str
óó0 =
,
óó= >
qry
óó? B
)
óóB C
;
óóC D
else
òò 
if
òò 
(
òò  !
	Validator
òò! *
.
òò* +
IsSpecialty
òò+ 6
(
òò6 7
qry
òò7 :
)
òò: ;
)
òò; <
dt
ôô 
=
ôô  

FilterData
ôô! +
(
ôô+ ,
dt
ôô, .
,
ôô. /
$str
ôô0 <
,
ôô< =
qry
ôô> A
)
ôôA B
;
ôôB C
else
öö 
if
öö 
(
öö  !
	Validator
öö! *
.
öö* +
IsStatus
öö+ 3
(
öö3 4
qry
öö4 7
)
öö7 8
)
öö8 9
dt
õõ 
=
õõ  

FilterData
õõ! +
(
õõ+ ,
dt
õõ, .
,
õõ. /
$str
õõ0 8
,
õõ8 9
qry
õõ: =
)
õõ= >
;
õõ> ?
else
úú 
dt
ùù 
=
ùù  

FilterData
ùù! +
(
ùù+ ,
dt
ùù, .
,
ùù. /
$str
ùù0 >
,
ùù> ?
qry
ùù@ C
)
ùùC D
;
ùùD E
}
ûû 
break
üü 
;
üü 
case
†† 
$str
†† 
:
†† 
foreach
°° 
(
°° 
string
°° #
qry
°°$ '
in
°°( *

queryParts
°°+ 5
)
°°5 6
{
¢¢ 
if
££ 
(
££ 
	Validator
££ %
.
££% &
IsDate
££& ,
(
££, -
qry
££- 0
)
££0 1
)
££1 2
dt
§§ 
=
§§  

FilterData
§§! +
(
§§+ ,
dt
§§, .
,
§§. /
$str
§§0 =
,
§§= >
qry
§§? B
)
§§B C
;
§§C D
else
•• 
if
•• 
(
••  !
	Validator
••! *
.
••* +
IsStatus
••+ 3
(
••3 4
qry
••4 7
)
••7 8
)
••8 9
dt
¶¶ 
=
¶¶  

FilterData
¶¶! +
(
¶¶+ ,
dt
¶¶, .
,
¶¶. /
$str
¶¶0 8
,
¶¶8 9
qry
¶¶: =
)
¶¶= >
;
¶¶> ?
else
ßß 
{
®® 
	DataTable
©© %
dt1
©©& )
=
©©* +

FilterData
©©, 6
(
©©6 7
dt
©©7 9
,
©©9 :
$str
©©; I
,
©©I J
qry
©©K N
)
©©N O
;
©©O P
	DataTable
™™ %
dt2
™™& )
=
™™* +

FilterData
™™, 6
(
™™6 7
dt
™™7 9
,
™™9 :
$str
™™; F
,
™™F G
qry
™™H K
)
™™K L
;
™™L M
if
´´ 
(
´´  
(
´´  !
dt1
´´! $
.
´´$ %
Rows
´´% )
.
´´) *
Count
´´* /
>
´´0 1
$num
´´2 3
)
´´3 4
||
´´5 7
(
´´8 9
dt2
´´9 <
.
´´< =
Rows
´´= A
.
´´A B
Count
´´B G
>
´´H I
$num
´´J K
)
´´K L
)
´´L M
dt
¨¨  "
=
¨¨# $
dt1
¨¨% (
.
¨¨( )
AsEnumerable
¨¨) 5
(
¨¨5 6
)
¨¨6 7
.
≠≠  !
Union
≠≠! &
(
≠≠& '
dt2
≠≠' *
.
≠≠* +
AsEnumerable
≠≠+ 7
(
≠≠7 8
)
≠≠8 9
)
≠≠9 :
.
ÆÆ  !
Distinct
ÆÆ! )
(
ÆÆ) *
)
ÆÆ* +
.
ØØ  !
CopyToDataTable
ØØ! 0
(
ØØ0 1
)
ØØ1 2
;
ØØ2 3
else
∞∞  
dt
±±  "
.
±±" #
Rows
±±# '
.
±±' (
Clear
±±( -
(
±±- .
)
±±. /
;
±±/ 0
}
≤≤ 
}
≥≥ 
break
¥¥ 
;
¥¥ 
}
µµ 
return
∑∑ 
dt
∑∑ 
;
∑∑ 
}
∏∏ 	
static
ªª 
private
ªª 
	DataTable
ªª  

FilterData
ªª! +
(
ªª+ ,
	DataTable
ªª, 5
table
ªª6 ;
,
ªª; <
string
ªª= C
field
ªªD I
,
ªªI J
string
ªªK Q
value
ªªR W
)
ªªW X
{
ºº 	
try
ΩΩ 
{
ææ 
table
øø 
=
øø 
table
øø 
.
øø 
AsEnumerable
øø *
(
øø* +
)
øø+ ,
.
¿¿ 
Where
¿¿ 
(
¿¿ 
row
¿¿ 
=>
¿¿ 
row
¿¿ !
.
¿¿! "
Field
¿¿" '
<
¿¿' (
string
¿¿( .
>
¿¿. /
(
¿¿/ 0
field
¿¿0 5
)
¿¿5 6
==
¿¿7 9
value
¿¿: ?
)
¿¿? @
.
¡¡ 
CopyToDataTable
¡¡  
(
¡¡  !
)
¡¡! "
;
¡¡" #
return
¬¬ 
table
¬¬ 
;
¬¬ 
}
√√ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
≈≈ 
Logger
∆∆ 
.
∆∆ 
WriteLog
∆∆ 
(
∆∆  
ex
∆∆  "
)
∆∆" #
;
∆∆# $
	DataTable
«« 
dt
«« 
=
«« 
table
«« $
.
««$ %
Clone
««% *
(
««* +
)
««+ ,
;
««, -
return
»» 
dt
»» 
;
»» 
}
…… 
}
   	
static
ŒŒ 
public
ŒŒ 
bool
ŒŒ !
CheckDoctorBusyness
ŒŒ .
(
ŒŒ. /
Doctor
ŒŒ/ 5
doctor
ŒŒ6 <
,
ŒŒ< =
string
ŒŒ> D
date
ŒŒE I
)
ŒŒI J
{
œœ 	
if
—— 
(
—— 
doctor
—— 
.
—— 
DoctorVisits
—— #
.
——# $
Count
——$ )
>
——* +
$num
——, -
)
——- .
{
““ 
List
‘‘ 
<
‘‘ 
DoctorVisit
‘‘  
>
‘‘  !
visits
‘‘" (
=
‘‘) *
DataHandler
‘‘+ 6
.
‘‘6 7
GetVisitsByDoctor
‘‘7 H
(
‘‘H I
doctor
‘‘I O
.
‘‘O P
DoctorID
‘‘P X
)
‘‘X Y
;
‘‘Y Z
visits
◊◊ 
=
◊◊ 
visits
◊◊ 
.
◊◊  
Where
◊◊  %
(
◊◊% &
i
◊◊& '
=>
◊◊( *
i
◊◊+ ,
.
◊◊, -
Status
◊◊- 3
!=
◊◊4 6
$str
◊◊7 A
&&
◊◊B D
i
◊◊E F
.
◊◊F G
Status
◊◊G M
!=
◊◊N P
$str
◊◊Q Z
)
◊◊Z [
.
◊◊[ \
ToList
◊◊\ b
(
◊◊b c
)
◊◊c d
;
◊◊d e
visits
⁄⁄ 
=
⁄⁄ 
visits
⁄⁄ 
.
⁄⁄  
Where
⁄⁄  %
(
⁄⁄% &
i
⁄⁄& '
=>
⁄⁄( *
i
⁄⁄+ ,
.
⁄⁄, -
Date
⁄⁄- 1
==
⁄⁄2 4
date
⁄⁄5 9
)
⁄⁄9 :
.
⁄⁄: ;
ToList
⁄⁄; A
(
⁄⁄A B
)
⁄⁄B C
;
⁄⁄C D
if
‹‹ 
(
‹‹ 
visits
‹‹ 
.
‹‹ 
Count
‹‹  
>
‹‹! "
$num
‹‹# $
)
‹‹$ %
return
›› 
false
››  
;
››  !
else
ﬁﬁ 
return
ﬂﬂ 
true
ﬂﬂ 
;
ﬂﬂ  
}
‡‡ 
else
·· 
return
‚‚ 
true
‚‚ 
;
‚‚ 
}
„„ 	
}
‰‰ 
}ÂÂ 